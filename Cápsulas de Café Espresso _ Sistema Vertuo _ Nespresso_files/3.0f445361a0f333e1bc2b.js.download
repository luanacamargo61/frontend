(window.webpackJsonpCrema=window.webpackJsonpCrema||[]).push([[3],{1310:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.expandProductWithDiscoveryOfferAvailable=exports.expandProductWithIsDiscoveryOffer=exports.expandProductWithMaxQuantity=exports.expandProductWithMaxCustomerQuantity=exports.expandProductWithCartQuantity=exports.expandProductWithQuantity=exports.matchProductById=exports.getProductFromCartQuantity=exports.matchProductInCart=void 0;var obj,_assign=__webpack_require__(1),_assign2=(obj=_assign)&&obj.__esModule?obj:{default:obj},_ecapi=__webpack_require__(73),_packagingRulesHelper=__webpack_require__(1409),_constants=__webpack_require__(21);var matchProductInCart=exports.matchProductInCart=function(productToFind){return function(productInCart){return!(!productToFind||!productInCart)&&(productToFind.id===productInCart.id&&void 0===productInCart.nextOrderId&&void 0===productInCart.promotionCode)}},getProductFromCartQuantity=exports.getProductFromCartQuantity=function(cartLines,product){var productInCart=cartLines.find(matchProductInCart(product));return productInCart?productInCart.quantity:null},expandProductWithQuantity=(exports.matchProductById=function(productId){return function(product){return!!product&&(product.id===productId||product.legacyId===productId)}},exports.expandProductWithQuantity=function(productQuantity,product){return null!==productQuantity&&product.quantity!==productQuantity?(0,_assign2.default)({},product,{quantity:productQuantity}):product});exports.expandProductWithCartQuantity=function(state,product){if(!product)return product;var cart=(0,_ecapi.fromEcapiGetter)(state)(_constants.CART_DATA)||[],productQuantity=getProductFromCartQuantity(cart,product);return expandProductWithQuantity(productQuantity,product)},exports.expandProductWithMaxCustomerQuantity=function(state,product){if(!product||!product.id)return product;var customer=(0,_ecapi.fromEcapiGetter)(state)(_constants.CUSTOMER_DATA);if(!customer)return product;var limitedProducts=customer.limitedProducts;if(!limitedProducts)return product;var maxCustomerQuantity=limitedProducts[product.id];if(void 0===maxCustomerQuantity)return product;var numberOfUnits=product.unitQuantity||1,extraProductData={maxCustomerQuantity:Math.floor(maxCustomerQuantity/numberOfUnits),isLimited:!0};return(0,_assign2.default)({},product,extraProductData)},exports.expandProductWithMaxQuantity=function(state,product){if(!product||!product.id||!state)return product;var optionalMaxOrderQuantity=product.maxOrderQuantity||1/0,numberOfUnits=product.unitQuantity||1,productMaxQuantity=product.maxQuantity||1/0,maxQuantityByPackagingRule=(0,_packagingRulesHelper.getProductQuantityFromMaxPackagingRules)(state,product),packagingRuleMaxValue=Math.floor(maxQuantityByPackagingRule/numberOfUnits),maxQuantity=Math.min(packagingRuleMaxValue,optionalMaxOrderQuantity,productMaxQuantity);if(maxQuantity===product.maxQuantity)return product;var isLimited=product.isLimited||maxQuantityByPackagingRule<1/0;return(0,_assign2.default)({},product,{maxQuantity:maxQuantity,isLimited:isLimited})},exports.expandProductWithIsDiscoveryOffer=function(state,product){if(!product||!product.id||!state)return product;var discoveryOfferBundle=(0,_ecapi.fromEcapiGetter)(state)(_constants.MARKET_DATA,"discoveryOfferBundleProducts");return discoveryOfferBundle&&-1!==discoveryOfferBundle.indexOf(product.id)?(0,_assign2.default)({},product,{isDiscoveryOffer:!0}):product},exports.expandProductWithDiscoveryOfferAvailable=function(state,product){if(!(product&&product.id&&state&&product.isDiscoveryOffer))return product;var cart=(0,_ecapi.fromEcapiGetter)(state)(_constants.CART_DATA),discoveryOfferBundle=(0,_ecapi.fromEcapiGetter)(state)(_constants.MARKET_DATA,"discoveryOfferBundleProducts");if(!cart||!discoveryOfferBundle)return(0,_assign2.default)({},product,{available:!0});var discoveryOfferInCart=discoveryOfferBundle.find((function(discoveryOffer){return cart.some((function(item){return item.id===discoveryOffer}))}));return discoveryOfferInCart&&discoveryOfferInCart!==product.id?(0,_assign2.default)({},product,{available:!1}):(0,_assign2.default)({},product,{available:!0})}},1395:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _getPrototypeOf2=_interopRequireDefault(__webpack_require__(13)),_classCallCheck3=_interopRequireDefault(__webpack_require__(15)),_createClass3=_interopRequireDefault(__webpack_require__(16)),_possibleConstructorReturn3=_interopRequireDefault(__webpack_require__(19)),_inherits3=_interopRequireDefault(__webpack_require__(20)),_react2=_interopRequireDefault(__webpack_require__(0)),_reactRedux=__webpack_require__(17),_dynamicProductDataHelper=(_interopRequireDefault(__webpack_require__(2)),__webpack_require__(1310)),_isEqual2=_interopRequireDefault(__webpack_require__(132));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var expandProduct=function(state,product){var withMaxCustomerQuantity=(0,_dynamicProductDataHelper.expandProductWithMaxCustomerQuantity)(state,product);return(0,_dynamicProductDataHelper.expandProductWithMaxQuantity)(state,withMaxCustomerQuantity)},mapStateToProps=function(state,_ref){var product=_ref.product;return{product:expandProduct(state,product)}};exports.default=function(Component){var ProducMaxQuantitiestProvider=function(_React$Component){function ProducMaxQuantitiestProvider(){return(0,_classCallCheck3.default)(this,ProducMaxQuantitiestProvider),(0,_possibleConstructorReturn3.default)(this,(ProducMaxQuantitiestProvider.__proto__||(0,_getPrototypeOf2.default)(ProducMaxQuantitiestProvider)).apply(this,arguments))}return(0,_inherits3.default)(ProducMaxQuantitiestProvider,_React$Component),(0,_createClass3.default)(ProducMaxQuantitiestProvider,[{key:"shouldComponentUpdate",value:function(nextProps){return!(0,_isEqual2.default)(nextProps.product,this.props.product)}},{key:"render",value:function(){return _react2.default.createElement(Component,this.props)}}]),ProducMaxQuantitiestProvider}(_react2.default.Component);return(0,_reactRedux.connect)(mapStateToProps)(ProducMaxQuantitiestProvider)}},1409:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getProductQuantityFromMaxPackagingRules=void 0;var obj,_toConsumableArray2=__webpack_require__(47),_toConsumableArray3=(obj=_toConsumableArray2)&&obj.__esModule?obj:{default:obj},_constants=__webpack_require__(21),_ecapi=__webpack_require__(73);exports.getProductQuantityFromMaxPackagingRules=function(state,product){if(!product||!product.id)return 1/0;var packagingRules=(0,_ecapi.fromEcapiGetter)(state)(_constants.PACKAGING_RULES_DATA);if(!packagingRules||!Array.isArray(packagingRules)||!packagingRules.length)return 1/0;var applicablePackagingRules=packagingRules.filter((function(packagingRule){return"MAX"===packagingRule.type&&packagingRule.applyPerProduct&&packagingRule.products.indexOf(product.id)>-1}));return applicablePackagingRules.length?Math.min.apply(Math,(0,_toConsumableArray3.default)(applicablePackagingRules.map((function(p){return p.value})))):1/0}}}]);
(function(){var Uo=Object.defineProperty,Bo=Object.defineProperties;var zo=Object.getOwnPropertyDescriptors;var xs=Object.getOwnPropertySymbols;var Wo=Object.prototype.hasOwnProperty,jo=Object.prototype.propertyIsEnumerable;var ks=(t,e,n)=>e in t?Uo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ue=(t,e)=>{for(var n in e||(e={}))Wo.call(e,n)&&ks(t,n,e[n]);if(xs)for(var n of xs(e))jo.call(e,n)&&ks(t,n,e[n]);return t},Re=(t,e)=>Bo(t,zo(e));var qe=(t,e,n)=>new Promise((i,s)=>{var r=c=>{try{o(n.next(c))}catch(f){s(f)}},a=c=>{try{o(n.throw(c))}catch(f){s(f)}},o=c=>c.done?i(c.value):Promise.resolve(c.value).then(r,a);o((n=n.apply(t,e)).next())});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();class rt{static convertToRelativeUrl(e){return String(e).replace(/^(?:\/\/|[^\/]+)*/,"")||"/"}static _matchURI(e){return String(e).match(/^((https?):\/\/(([^@]*)@|)(([^:\/?#]*)(?::([0-9]+))?)|)(\/[^?#]*)?(\?([^#]*)|)(#(.*)|)$/)||null}static getSchemeDefaultPort(e){switch(e){case"http":return 80;case"https":return 443;default:return""}}static parseURI(e){const n=rt._matchURI(e);return n&&{scheme:n[2]||"",userinfo:n[4]||"",host:n[6]||"",port:parseInt(n[7],10)||rt.getSchemeDefaultPort(n[2])||"",path:n[8]||(n[6]?"/":""),query:n[10]||"",fragment:n[12]||""}}static parseURIBase(e){const n=rt._matchURI(e);return n&&{host:n[6]||"",path:n[8]||(n[6]?"/":""),query:n[10]||"",fragment:n[12]||""}}static concatUrlItem(e){let n=e.path;return n+=e.query?`?${e.query}}`:"",n}}class fe{static getTime(){const e=new Date;return`${fe.padZero(e.getHours())}:${fe.padZero(e.getMinutes())}`}static formatDateTime(e,n=24){const i=e.getFullYear(),s=("0"+(e.getMonth()+1)).slice(-2);return("0"+e.getDate()).slice(-2)+"."+s+"."+i+" "+fe.formatTime(e,n)}static formatTime(e,n=24){return parseInt(n,10)===12?fe.formatTimeAmPm(e):fe.formatTimeHHMM(e)}static formatTimeHHMM(e){return`${fe.padZero(e.getHours())}:${fe.padZero(e.getMinutes())}`}static formatTimeAmPm(e){let n=e.getHours(),i=e.getMinutes();const s=n>=12?"pm":"am";return n%=12,n=n||12,i=i<10?"0"+i:i,`${n}:${i} ${s}`}static padZero(e){return e=parseInt(e,0),e>-10&&e<0?"-0"+e*-1:e<10&&e>=0?"0"+e:e}static checkWordsInString(e,n){for(let i=0;i<n.length;i++)if(new RegExp("\\b"+fe.escapeStringRegexp(n[i])+"\\b","i").test(e))return!0;return!1}static escapeStringRegexp(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}static getInternetExplorerVersion(e=0){let n=e;return navigator.appName==="Microsoft Internet Explorer"?new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})").exec(navigator.userAgent)!==null&&(n=parseFloat(RegExp.$1)):navigator.appName==="Netscape"&&new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})").exec(navigator.userAgent)!==null&&(n=parseFloat(RegExp.$1)),n}static parseQuery(e){const n={},i=(e[0]==="?"?e.substr(1):e).split("&");for(let s=0;s<i.length;s++){const r=i[s].split("=");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return n}static matchRulePatern(e,n){const i=s=>s.replace(/([.*+?^=!:${}()|\\[\\]\/\\])/g,"\\$1");return new RegExp("^"+n.split("*").map(i).join(".*")+"$").test(e)}static matchOneHostPatern(e,n){const i=e.replace("http://","").replace("https://","").split(/[/?#]/)[0];for(let s=0;s<n.length;s++)if(fe.matchRulePatern(i,n[s]))return!0;return!1}static encodeUnicode64(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(n,i)=>String.fromCharCode(parseInt(i,16))))}static decodeUnicode64(e){return decodeURIComponent(atob(e).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))}static html2text(e){const n=document.createElement("DIV");return n.innerHTML=e,n.textContent||n.innerText||""}}var xt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"||typeof window!="undefined"?window:typeof self!="undefined"?self:{};function Xo(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");if(t=`${t}`,t=t.replace(/[ \t\n\f\r]/g,""),t.length%4===0&&(t=t.replace(/==?$/,"")),t.length%4===1||/[^+/0-9A-Za-z]/.test(t))return null;let e="",n=0,i=0;for(let s=0;s<t.length;s++)n<<=6,n|=Go(t[s]),i+=6,i===24&&(e+=String.fromCharCode((n&16711680)>>16),e+=String.fromCharCode((n&65280)>>8),e+=String.fromCharCode(n&255),n=i=0);return i===12?(n>>=4,e+=String.fromCharCode(n)):i===18&&(n>>=2,e+=String.fromCharCode((n&65280)>>8),e+=String.fromCharCode(n&255)),e}const Qo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Go(t){const e=Qo.indexOf(t);return e<0?void 0:e}var Jo=Xo;function Vo(t){if(arguments.length===0)throw new TypeError("1 argument required, but only 0 present.");let e;for(t=`${t}`,e=0;e<t.length;e++)if(t.charCodeAt(e)>255)return null;let n="";for(e=0;e<t.length;e+=3){const i=[void 0,void 0,void 0,void 0];i[0]=t.charCodeAt(e)>>2,i[1]=(t.charCodeAt(e)&3)<<4,t.length>e+1&&(i[1]|=t.charCodeAt(e+1)>>4,i[2]=(t.charCodeAt(e+1)&15)<<2),t.length>e+2&&(i[2]|=t.charCodeAt(e+2)>>6,i[3]=t.charCodeAt(e+2)&63);for(let s=0;s<i.length;s++)typeof i[s]=="undefined"?n+="=":n+=Ko(i[s])}return n}const Yo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Ko(t){if(t>=0&&t<64)return Yo[t]}var Zo=Vo;const el=Jo,tl=Zo;var gn={atob:el,btoa:tl},kt=typeof window!="undefined"?window:typeof self!="undefined"?self:typeof window!="undefined"?window:{};function nl(){let t=kt.WebSocket;if(typeof t=="undefined")try{t=require("ws")}catch(e){throw new Error('You must install the "ws" package to use Strophe in nodejs.')}return t}const Os=nl();function il(){let t=kt.DOMParser;if(typeof t=="undefined")try{t=require("@xmldom/xmldom").DOMParser}catch(e){throw new Error('You must install the "@xmldom/xmldom" package to use Strophe in nodejs.')}return t}const et=il();function sl(){const t=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.5.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"];for(let e=0;e<t.length;e++)try{return new ActiveXObject(t[e])}catch(n){}}function rl(){if(typeof document=="undefined")try{const t=require("@xmldom/xmldom").DOMImplementation;return new t().createDocument("jabber:client","strophe",null)}catch(t){throw new Error('You must install the "@xmldom/xmldom" package to use Strophe in nodejs.')}if(document.implementation.createDocument===void 0||document.implementation.createDocument&&document.documentMode&&document.documentMode<10){const t=sl();return t.appendChild(t.createElement("strophe")),t}return document.implementation.createDocument("jabber:client","strophe",null)}class je{constructor(e,n,i){this.mechname=e,this.isClientFirst=n,this.priority=i}test(){return!0}onStart(e){this._connection=e}onChallenge(e,n){throw new Error("You should implement challenge handling!")}clientChallenge(e){if(!this.isClientFirst)throw new Error("clientChallenge should not be called if isClientFirst is false!");return this.onChallenge(e)}onFailure(){this._connection=null}onSuccess(){this._connection=null}}class al extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ANONYMOUS",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:20;super(e,n,i)}test(e){return e.authcid===null}}class ol extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"EXTERNAL",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;super(e,n,i)}onChallenge(e){return e.authcid===e.authzid?"":e.authzid}}const pe={utf16to8(t){let e="";const n=t.length;for(let i=0;i<n;i++){const s=t.charCodeAt(i);s>=0&&s<=127?e+=t.charAt(i):s>2047?(e+=String.fromCharCode(224|s>>12&15),e+=String.fromCharCode(128|s>>6&63),e+=String.fromCharCode(128|s>>0&63)):(e+=String.fromCharCode(192|s>>6&31),e+=String.fromCharCode(128|s>>0&63))}return e},xorArrayBuffers(t,e){const n=new Uint8Array(t),i=new Uint8Array(e),s=new Uint8Array(t.byteLength);for(let r=0;r<t.byteLength;r++)s[r]=n[r]^i[r];return s.buffer},arrayBufToBase64(t){let e="";const n=new Uint8Array(t),i=n.byteLength;for(let s=0;s<i;s++)e+=String.fromCharCode(n[s]);return window.btoa(e)},base64ToArrayBuf(t){var e;return(e=Uint8Array.from(atob(t),n=>n.charCodeAt(0)))===null||e===void 0?void 0:e.buffer},stringToArrayBuf(t){return new TextEncoder("utf-8").encode(t).buffer},addCookies(t){t=t||{};for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){let n="",i="",s="";const r=t[e],a=typeof r=="object",o=escape(unescape(a?r.value:r));a&&(n=r.expires?";expires="+r.expires:"",i=r.domain?";domain="+r.domain:"",s=r.path?";path="+r.path:""),document.cookie=e+"="+o+n+i+s}}};class ll extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"OAUTHBEARER",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:40;super(e,n,i)}test(e){return e.pass!==null}onChallenge(e){let n="n,";return e.authcid!==null&&(n=n+"a="+e.authzid),n=n+",",n=n+"",n=n+"auth=Bearer ",n=n+e.pass,n=n+"",n=n+"",pe.utf16to8(n)}}class cl extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"PLAIN",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:50;super(e,n,i)}test(e){return e.authcid!==null}onChallenge(e){const{authcid:n,authzid:i,domain:s,pass:r}=e;if(!s)throw new Error("SASLPlain onChallenge: domain is not defined!");let a=i!==`${n}@${s}`?i:"";return a=a+"\0",a=a+n,a=a+"\0",a=a+r,pe.utf16to8(a)}}function ul(t,e,n){return qe(this,null,function*(){const i=yield window.crypto.subtle.importKey("raw",yield window.crypto.subtle.digest(n,e),{name:"HMAC",hash:n},!1,["sign"]),s=yield window.crypto.subtle.sign("HMAC",i,pe.stringToArrayBuf(t));return pe.xorArrayBuffers(e,s)})}function dl(t){let e,n,i;const s=/([a-z]+)=([^,]+)(,|$)/;for(;t.match(s);){const r=t.match(s);switch(t=t.replace(r[0],""),r[1]){case"r":e=r[2];break;case"s":n=pe.base64ToArrayBuf(r[2]);break;case"i":i=parseInt(r[2],10);break;default:return}}if(isNaN(i)||i<4096){h.warn("Failing SCRAM authentication because server supplied iteration count < 4096.");return}if(!n){h.warn("Failing SCRAM authentication because server supplied incorrect salt.");return}return{nonce:e,salt:n,iter:i}}function hl(t,e,n,i,s){return qe(this,null,function*(){const r=yield window.crypto.subtle.deriveBits({name:"PBKDF2",salt:e,iterations:n,hash:{name:i}},yield window.crypto.subtle.importKey("raw",pe.stringToArrayBuf(t),"PBKDF2",!1,["deriveBits"]),s),a=yield window.crypto.subtle.importKey("raw",r,{name:"HMAC",hash:i},!1,["sign"]);return{ck:yield window.crypto.subtle.sign("HMAC",a,pe.stringToArrayBuf("Client Key")),sk:yield window.crypto.subtle.sign("HMAC",a,pe.stringToArrayBuf("Server Key"))}})}function fl(t,e,n){return qe(this,null,function*(){const i=yield window.crypto.subtle.importKey("raw",e,{name:"HMAC",hash:n},!1,["sign"]);return window.crypto.subtle.sign("HMAC",i,pe.stringToArrayBuf(t))})}function pl(){const t=new Uint8Array(16);return pe.arrayBufToBase64(crypto.getRandomValues(t).buffer)}const ot={scramResponse(t,e,n,i){return qe(this,null,function*(){var s,r,a;const o=t._sasl_data.cnonce,c=dl(e);if(!c&&(c==null?void 0:c.nonce.slice(0,o.length))!==o)return h.warn("Failing SCRAM authentication because server supplied incorrect nonce."),t._sasl_data={},t._sasl_failure_cb();let f,g;if(((s=t.pass)===null||s===void 0?void 0:s.name)===n&&((r=t.pass)===null||r===void 0?void 0:r.salt)===pe.arrayBufToBase64(c.salt)&&((a=t.pass)===null||a===void 0?void 0:a.iter)===c.iter)f=pe.base64ToArrayBuf(t.pass.ck),g=pe.base64ToArrayBuf(t.pass.sk);else if(typeof t.pass=="string"||t.pass instanceof String){const l=yield hl(t.pass,c.salt,c.iter,n,i);f=l.ck,g=l.sk}else return t._sasl_failure_cb();const E=t._sasl_data["client-first-message-bare"],A=e,N=`c=biws,r=${c.nonce}`,$=`${E},${A},${N}`,b=yield ul($,f,n),_=yield fl($,g,n);return t._sasl_data["server-signature"]=pe.arrayBufToBase64(_),t._sasl_data.keys={name:n,iter:c.iter,salt:pe.arrayBufToBase64(c.salt),ck:pe.arrayBufToBase64(f),sk:pe.arrayBufToBase64(g)},`${N},p=${pe.arrayBufToBase64(b)}`})},clientChallenge(t,e){const n=e||pl(),i=`n=${t.authcid},r=${n}`;return t._sasl_data.cnonce=n,t._sasl_data["client-first-message-bare"]=i,`n,,${i}`}};class gl extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"SCRAM-SHA-1",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:60;super(e,n,i)}test(e){return e.authcid!==null}onChallenge(e,n){return qe(this,null,function*(){return ot.scramResponse(e,n,"SHA-1",160)})}clientChallenge(e,n){return ot.clientChallenge(e,n)}}class ml extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"SCRAM-SHA-256",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:70;super(e,n,i)}test(e){return e.authcid!==null}onChallenge(e,n){return qe(this,null,function*(){return ot.scramResponse(e,n,"SHA-256",256)})}clientChallenge(e,n){return ot.clientChallenge(e,n)}}class _l extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"SCRAM-SHA-384",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:71;super(e,n,i)}test(e){return e.authcid!==null}onChallenge(e,n){return qe(this,null,function*(){return ot.scramResponse(e,n,"SHA-384",384)})}clientChallenge(e,n){return ot.clientChallenge(e,n)}}class vl extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"SCRAM-SHA-512",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:72;super(e,n,i)}test(e){return e.authcid!==null}onChallenge(e,n){return qe(this,null,function*(){return ot.scramResponse(e,n,"SHA-512",512)})}clientChallenge(e,n){return ot.clientChallenge(e,n)}}class yl extends je{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"X-OAUTH2",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:30;super(e,n,i)}test(e){return e.pass!==null}onChallenge(e){let n="\0";return e.authcid!==null&&(n=n+e.authzid),n=n+"\0",n=n+e.pass,pe.utf16to8(n)}}function Ct(t,e){return new h.Builder(t,e)}function Pr(t){return new h.Builder("message",t)}function gt(t){return new h.Builder("iq",t)}function $r(t){return new h.Builder("presence",t)}const h={VERSION:"1.6.0",NS:{HTTPBIND:"http://jabber.org/protocol/httpbind",BOSH:"urn:xmpp:xbosh",CLIENT:"jabber:client",AUTH:"jabber:iq:auth",ROSTER:"jabber:iq:roster",PROFILE:"jabber:iq:profile",DISCO_INFO:"http://jabber.org/protocol/disco#info",DISCO_ITEMS:"http://jabber.org/protocol/disco#items",MUC:"http://jabber.org/protocol/muc",SASL:"urn:ietf:params:xml:ns:xmpp-sasl",STREAM:"http://etherx.jabber.org/streams",FRAMING:"urn:ietf:params:xml:ns:xmpp-framing",BIND:"urn:ietf:params:xml:ns:xmpp-bind",SESSION:"urn:ietf:params:xml:ns:xmpp-session",VERSION:"jabber:iq:version",STANZAS:"urn:ietf:params:xml:ns:xmpp-stanzas",XHTML_IM:"http://jabber.org/protocol/xhtml-im",XHTML:"http://www.w3.org/1999/xhtml"},XHTML:{tags:["a","blockquote","br","cite","em","img","li","ol","p","span","strong","ul","body"],attributes:{a:["href"],blockquote:["style"],br:[],cite:["style"],em:[],img:["src","alt","style","height","width"],li:["style"],ol:["style"],p:["style"],span:["style"],strong:[],ul:["style"],body:[]},css:["background-color","color","font-family","font-size","font-style","font-weight","margin-left","margin-right","text-align","text-decoration"],validTag(t){for(let e=0;e<h.XHTML.tags.length;e++)if(t===h.XHTML.tags[e])return!0;return!1},validAttribute(t,e){if(typeof h.XHTML.attributes[t]!="undefined"&&h.XHTML.attributes[t].length>0){for(let n=0;n<h.XHTML.attributes[t].length;n++)if(e===h.XHTML.attributes[t][n])return!0}return!1},validCSS(t){for(let e=0;e<h.XHTML.css.length;e++)if(t===h.XHTML.css[e])return!0;return!1}},Status:{ERROR:0,CONNECTING:1,CONNFAIL:2,AUTHENTICATING:3,AUTHFAIL:4,CONNECTED:5,DISCONNECTED:6,DISCONNECTING:7,ATTACHED:8,REDIRECT:9,CONNTIMEOUT:10,BINDREQUIRED:11,ATTACHFAIL:12},ErrorCondition:{BAD_FORMAT:"bad-format",CONFLICT:"conflict",MISSING_JID_NODE:"x-strophe-bad-non-anon-jid",NO_AUTH_MECH:"no-auth-mech",UNKNOWN_REASON:"unknown"},LogLevel:{DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ElementType:{NORMAL:1,TEXT:3,CDATA:4,FRAGMENT:11},TIMEOUT:1.1,SECONDARY_TIMEOUT:.1,addNamespace(t,e){h.NS[t]=e},forEachChild(t,e,n){for(let i=0;i<t.childNodes.length;i++){const s=t.childNodes[i];s.nodeType===h.ElementType.NORMAL&&(!e||this.isTagEqual(s,e))&&n(s)}},isTagEqual(t,e){return t.tagName===e},_xmlGenerator:null,xmlGenerator(){return h._xmlGenerator||(h._xmlGenerator=rl()),h._xmlGenerator},xmlElement(t){if(!t)return null;const e=h.xmlGenerator().createElement(t);for(let n=1;n<arguments.length;n++){const i=arguments[n];if(!!i){if(typeof i=="string"||typeof i=="number")e.appendChild(h.xmlTextNode(i));else if(typeof i=="object"&&typeof i.sort=="function")for(let s=0;s<i.length;s++){const r=i[s];typeof r=="object"&&typeof r.sort=="function"&&r[1]!==void 0&&r[1]!==null&&e.setAttribute(r[0],r[1])}else if(typeof i=="object")for(const s in i)Object.prototype.hasOwnProperty.call(i,s)&&i[s]!==void 0&&i[s]!==null&&e.setAttribute(s,i[s])}}return e},xmlescape(t){return t=t.replace(/\&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/'/g,"&apos;"),t=t.replace(/"/g,"&quot;"),t},xmlunescape(t){return t=t.replace(/\&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&apos;/g,"'"),t=t.replace(/&quot;/g,'"'),t},xmlTextNode(t){return h.xmlGenerator().createTextNode(t)},xmlHtmlNode(t){let e;return et?e=new et().parseFromString(t,"text/xml"):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)),e},getText(t){if(!t)return null;let e="";t.childNodes.length===0&&t.nodeType===h.ElementType.TEXT&&(e+=t.nodeValue);for(let n=0;n<t.childNodes.length;n++)t.childNodes[n].nodeType===h.ElementType.TEXT&&(e+=t.childNodes[n].nodeValue);return h.xmlescape(e)},copyElement(t){let e;if(t.nodeType===h.ElementType.NORMAL){e=h.xmlElement(t.tagName);for(let n=0;n<t.attributes.length;n++)e.setAttribute(t.attributes[n].nodeName,t.attributes[n].value);for(let n=0;n<t.childNodes.length;n++)e.appendChild(h.copyElement(t.childNodes[n]))}else t.nodeType===h.ElementType.TEXT&&(e=h.xmlGenerator().createTextNode(t.nodeValue));return e},createHtml(t){let e;if(t.nodeType===h.ElementType.NORMAL){const n=t.nodeName.toLowerCase();if(h.XHTML.validTag(n))try{e=h.xmlElement(n);for(let i=0;i<h.XHTML.attributes[n].length;i++){const s=h.XHTML.attributes[n][i];let r=t.getAttribute(s);if(!(typeof r=="undefined"||r===null||r===""||r===!1||r===0))if(s==="style"&&typeof r=="object"&&typeof r.cssText!="undefined"&&(r=r.cssText),s==="style"){const a=[],o=r.split(";");for(let c=0;c<o.length;c++){const f=o[c].split(":"),g=f[0].replace(/^\s*/,"").replace(/\s*$/,"").toLowerCase();if(h.XHTML.validCSS(g)){const E=f[1].replace(/^\s*/,"").replace(/\s*$/,"");a.push(g+": "+E)}}a.length>0&&(r=a.join("; "),e.setAttribute(s,r))}else e.setAttribute(s,r)}for(let i=0;i<t.childNodes.length;i++)e.appendChild(h.createHtml(t.childNodes[i]))}catch(i){e=h.xmlTextNode("")}else{e=h.xmlGenerator().createDocumentFragment();for(let i=0;i<t.childNodes.length;i++)e.appendChild(h.createHtml(t.childNodes[i]))}}else if(t.nodeType===h.ElementType.FRAGMENT){e=h.xmlGenerator().createDocumentFragment();for(let n=0;n<t.childNodes.length;n++)e.appendChild(h.createHtml(t.childNodes[n]))}else t.nodeType===h.ElementType.TEXT&&(e=h.xmlTextNode(t.nodeValue));return e},escapeNode(t){return typeof t!="string"?t:t.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40")},unescapeNode(t){return typeof t!="string"?t:t.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},getNodeFromJid(t){return t.indexOf("@")<0?null:t.split("@")[0]},getDomainFromJid(t){const e=h.getBareJidFromJid(t);if(e.indexOf("@")<0)return e;{const n=e.split("@");return n.splice(0,1),n.join("@")}},getResourceFromJid(t){if(!t)return null;const e=t.split("/");return e.length<2?null:(e.splice(0,1),e.join("/"))},getBareJidFromJid(t){return t?t.split("/")[0]:null},_handleError(t){typeof t.stack!="undefined"&&h.fatal(t.stack),t.sourceURL?h.fatal("error: "+this.handler+" "+t.sourceURL+":"+t.line+" - "+t.name+": "+t.message):t.fileName?h.fatal("error: "+this.handler+" "+t.fileName+":"+t.lineNumber+" - "+t.name+": "+t.message):h.fatal("error: "+t.message)},log(t,e){if(t===this.LogLevel.FATAL){var n;(n=console)===null||n===void 0||n.error(e)}},debug(t){this.log(this.LogLevel.DEBUG,t)},info(t){this.log(this.LogLevel.INFO,t)},warn(t){this.log(this.LogLevel.WARN,t)},error(t){this.log(this.LogLevel.ERROR,t)},fatal(t){this.log(this.LogLevel.FATAL,t)},serialize(t){if(!t)return null;typeof t.tree=="function"&&(t=t.tree());const e=[...Array(t.attributes.length).keys()].map(i=>t.attributes[i].nodeName);e.sort();let n=e.reduce((i,s)=>`${i} ${s}="${h.xmlescape(t.attributes.getNamedItem(s).value)}"`,`<${t.nodeName}`);if(t.childNodes.length>0){n+=">";for(let i=0;i<t.childNodes.length;i++){const s=t.childNodes[i];switch(s.nodeType){case h.ElementType.NORMAL:n+=h.serialize(s);break;case h.ElementType.TEXT:n+=h.xmlescape(s.nodeValue);break;case h.ElementType.CDATA:n+="<![CDATA["+s.nodeValue+"]]>"}}n+="</"+t.nodeName+">"}else n+="/>";return n},_requestId:0,_connectionPlugins:{},addConnectionPlugin(t,e){h._connectionPlugins[t]=e}};h.Builder=class{constructor(e,n){(e==="presence"||e==="message"||e==="iq")&&(n&&!n.xmlns?n.xmlns=h.NS.CLIENT:n||(n={xmlns:h.NS.CLIENT})),this.nodeTree=h.xmlElement(e,n),this.node=this.nodeTree}tree(){return this.nodeTree}toString(){return h.serialize(this.nodeTree)}up(){return this.node=this.node.parentNode,this}root(){return this.node=this.nodeTree,this}attrs(e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]===void 0?this.node.removeAttribute(n):this.node.setAttribute(n,e[n]));return this}c(e,n,i){const s=h.xmlElement(e,n,i);return this.node.appendChild(s),typeof i!="string"&&typeof i!="number"&&(this.node=s),this}cnode(e){let n;const i=h.xmlGenerator();try{n=i.importNode!==void 0}catch(r){n=!1}const s=n?i.importNode(e,!0):h.copyElement(e);return this.node.appendChild(s),this.node=s,this}t(e){const n=h.xmlTextNode(e);return this.node.appendChild(n),this}h(e){const n=h.xmlGenerator().createElement("body");n.innerHTML=e;const i=h.createHtml(n);for(;i.childNodes.length>0;)this.node.appendChild(i.childNodes[0]);return this}};h.Handler=function(t,e,n,i,s,r,a){this.handler=t,this.ns=e,this.name=n,this.type=i,this.id=s,this.options=a||{matchBareFromJid:!1,ignoreNamespaceFragment:!1},this.options.matchBare&&(h.warn('The "matchBare" option is deprecated, use "matchBareFromJid" instead.'),this.options.matchBareFromJid=this.options.matchBare,delete this.options.matchBare),this.options.matchBareFromJid?this.from=r?h.getBareJidFromJid(r):null:this.from=r,this.user=!0};h.Handler.prototype={getNamespace(t){let e=t.getAttribute("xmlns");return e&&this.options.ignoreNamespaceFragment&&(e=e.split("#")[0]),e},namespaceMatch(t){let e=!1;return this.ns?(h.forEachChild(t,null,n=>{this.getNamespace(n)===this.ns&&(e=!0)}),e||this.getNamespace(t)===this.ns):!0},isMatch(t){let e=t.getAttribute("from");this.options.matchBareFromJid&&(e=h.getBareJidFromJid(e));const n=t.getAttribute("type");return!!(this.namespaceMatch(t)&&(!this.name||h.isTagEqual(t,this.name))&&(!this.type||(Array.isArray(this.type)?this.type.indexOf(n)!==-1:n===this.type))&&(!this.id||t.getAttribute("id")===this.id)&&(!this.from||e===this.from))},run(t){let e=null;try{e=this.handler(t)}catch(n){throw h._handleError(n),n}return e},toString(){return"{Handler: "+this.handler+"("+this.name+","+this.id+","+this.ns+")}"}};h.TimedHandler=class{constructor(e,n){this.period=e,this.handler=n,this.lastCalled=new Date().getTime(),this.user=!0}run(){return this.lastCalled=new Date().getTime(),this.handler()}reset(){this.lastCalled=new Date().getTime()}toString(){return"{TimedHandler: "+this.handler+"("+this.period+")}"}};h.Connection=class{constructor(e,n){this.service=e,this.options=n||{},this.setProtocol(),this.jid="",this.domain=null,this.features=null,this._sasl_data={},this.do_bind=!1,this.do_session=!1,this.mechanisms={},this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.protocolErrorHandlers={HTTP:{},websocket:{}},this._idleTimeout=null,this._disconnectTimeout=null,this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.do_authentication=!0,this.paused=!1,this.restored=!1,this._data=[],this._uniqueId=0,this._sasl_success_handler=null,this._sasl_failure_handler=null,this._sasl_challenge_handler=null,this.maxRetries=5,this._idleTimeout=setTimeout(()=>this._onIdle(),100),pe.addCookies(this.options.cookies),this.registerSASLMechanisms(this.options.mechanisms),this.iqFallbackHandler=new h.Handler(i=>this.send(gt({type:"error",id:i.getAttribute("id")}).c("error",{type:"cancel"}).c("service-unavailable",{xmlns:h.NS.STANZAS})),null,"iq",["get","set"]);for(const i in h._connectionPlugins)if(Object.prototype.hasOwnProperty.call(h._connectionPlugins,i)){const s=function(){};s.prototype=h._connectionPlugins[i],this[i]=new s,this[i].init(this)}}setProtocol(){const e=this.options.protocol||"";this.options.worker?this._proto=new h.WorkerWebsocket(this):this.service.indexOf("ws:")===0||this.service.indexOf("wss:")===0||e.indexOf("ws")===0?this._proto=new h.Websocket(this):this._proto=new h.Bosh(this)}reset(){this._proto._reset(),this.do_session=!1,this.do_bind=!1,this.timedHandlers=[],this.handlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this.authenticated=!1,this.connected=!1,this.disconnecting=!1,this.restored=!1,this._data=[],this._requests=[],this._uniqueId=0}pause(){this.paused=!0}resume(){this.paused=!1}getUniqueId(e){const n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const s=Math.random()*16|0;return(i==="x"?s:s&3|8).toString(16)});return typeof e=="string"||typeof e=="number"?n+":"+e:n+""}addProtocolErrorHandler(e,n,i){this.protocolErrorHandlers[e][n]=i}connect(e,n,i,s,r,a,o){let c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:3e3;this.jid=e,this.authzid=h.getBareJidFromJid(this.jid),this.authcid=o||h.getNodeFromJid(this.jid),this.pass=n,this.scram_keys=null,this.connect_callback=i,this.disconnecting=!1,this.connected=!1,this.authenticated=!1,this.restored=!1,this.disconnection_timeout=c,this.domain=h.getDomainFromJid(this.jid),this._changeConnectStatus(h.Status.CONNECTING,null),this._proto._connect(s,r,a)}attach(e,n,i,s,r,a,o){if(this._proto._attach)return this._proto._attach(e,n,i,s,r,a,o);{const c=new Error('The "attach" method is not available for your connection protocol');throw c.name="StropheSessionError",c}}restore(e,n,i,s,r){if(this._sessionCachingSupported())this._proto._restore(e,n,i,s,r);else{const a=new Error('The "restore" method can only be used with a BOSH connection.');throw a.name="StropheSessionError",a}}_sessionCachingSupported(){if(this._proto instanceof h.Bosh){if(!JSON)return!1;try{sessionStorage.setItem("_strophe_","_strophe_"),sessionStorage.removeItem("_strophe_")}catch(e){return!1}return!0}return!1}xmlInput(e){}xmlOutput(e){}rawInput(e){}rawOutput(e){}nextValidRid(e){}send(e){if(e!==null){if(typeof e.sort=="function")for(let n=0;n<e.length;n++)this._queueData(e[n]);else typeof e.tree=="function"?this._queueData(e.tree()):this._queueData(e);this._proto._send()}}flush(){clearTimeout(this._idleTimeout),this._onIdle()}sendPresence(e,n,i,s){let r=null;typeof e.tree=="function"&&(e=e.tree());let a=e.getAttribute("id");if(a||(a=this.getUniqueId("sendPresence"),e.setAttribute("id",a)),typeof n=="function"||typeof i=="function"){const o=this.addHandler(c=>{r&&this.deleteTimedHandler(r),c.getAttribute("type")==="error"?i&&i(c):n&&n(c)},null,"presence",null,a);s&&(r=this.addTimedHandler(s,()=>(this.deleteHandler(o),i&&i(null),!1)))}return this.send(e),a}sendIQ(e,n,i,s){let r=null;typeof e.tree=="function"&&(e=e.tree());let a=e.getAttribute("id");if(a||(a=this.getUniqueId("sendIQ"),e.setAttribute("id",a)),typeof n=="function"||typeof i=="function"){const o=this.addHandler(c=>{r&&this.deleteTimedHandler(r);const f=c.getAttribute("type");if(f==="result")n&&n(c);else if(f==="error")i&&i(c);else{const g=new Error(`Got bad IQ type of ${f}`);throw g.name="StropheError",g}},null,"iq",["error","result"],a);s&&(r=this.addTimedHandler(s,()=>(this.deleteHandler(o),i&&i(null),!1)))}return this.send(e),a}_queueData(e){if(e===null||!e.tagName||!e.childNodes){const n=new Error("Cannot queue non-DOMElement.");throw n.name="StropheError",n}this._data.push(e)}_sendRestart(){this._data.push("restart"),this._proto._sendRestart(),this._idleTimeout=setTimeout(()=>this._onIdle(),100)}addTimedHandler(e,n){const i=new h.TimedHandler(e,n);return this.addTimeds.push(i),i}deleteTimedHandler(e){this.removeTimeds.push(e)}addHandler(e,n,i,s,r,a,o){const c=new h.Handler(e,n,i,s,r,a,o);return this.addHandlers.push(c),c}deleteHandler(e){this.removeHandlers.push(e);const n=this.addHandlers.indexOf(e);n>=0&&this.addHandlers.splice(n,1)}registerSASLMechanisms(e){this.mechanisms={},e=e||[h.SASLAnonymous,h.SASLExternal,h.SASLOAuthBearer,h.SASLXOAuth2,h.SASLPlain,h.SASLSHA1,h.SASLSHA256,h.SASLSHA384,h.SASLSHA512],e.forEach(n=>this.registerSASLMechanism(n))}registerSASLMechanism(e){const n=new e;this.mechanisms[n.mechname]=n}disconnect(e){if(this._changeConnectStatus(h.Status.DISCONNECTING,e),e?h.warn("Disconnect was called because: "+e):h.info("Disconnect was called"),this.connected){let n=!1;this.disconnecting=!0,this.authenticated&&(n=$r({xmlns:h.NS.CLIENT,type:"unavailable"})),this._disconnectTimeout=this._addSysTimedHandler(this.disconnection_timeout,this._onDisconnectTimeout.bind(this)),this._proto._disconnect(n)}else h.warn("Disconnect was called before Strophe connected to the server"),this._proto._abortAllRequests(),this._doDisconnect()}_changeConnectStatus(e,n,i){for(const s in h._connectionPlugins)if(Object.prototype.hasOwnProperty.call(h._connectionPlugins,s)){const r=this[s];if(r.statusChanged)try{r.statusChanged(e,n)}catch(a){h.error(`${s} plugin caused an exception changing status: ${a}`)}}if(this.connect_callback)try{this.connect_callback(e,n,i)}catch(s){h._handleError(s),h.error(`User connection callback caused an exception: ${s}`)}}_doDisconnect(e){typeof this._idleTimeout=="number"&&clearTimeout(this._idleTimeout),this._disconnectTimeout!==null&&(this.deleteTimedHandler(this._disconnectTimeout),this._disconnectTimeout=null),h.debug("_doDisconnect was called"),this._proto._doDisconnect(),this.authenticated=!1,this.disconnecting=!1,this.restored=!1,this.handlers=[],this.timedHandlers=[],this.removeTimeds=[],this.removeHandlers=[],this.addTimeds=[],this.addHandlers=[],this._changeConnectStatus(h.Status.DISCONNECTED,e),this.connected=!1}_dataRecv(e,n){const i=this._proto._reqToData(e);if(i===null)return;for(this.xmlInput!==h.Connection.prototype.xmlInput&&(i.nodeName===this._proto.strip&&i.childNodes.length?this.xmlInput(i.childNodes[0]):this.xmlInput(i)),this.rawInput!==h.Connection.prototype.rawInput&&(n?this.rawInput(n):this.rawInput(h.serialize(i)));this.removeHandlers.length>0;){const r=this.removeHandlers.pop(),a=this.handlers.indexOf(r);a>=0&&this.handlers.splice(a,1)}for(;this.addHandlers.length>0;)this.handlers.push(this.addHandlers.pop());if(this.disconnecting&&this._proto._emptyQueue()){this._doDisconnect();return}const s=i.getAttribute("type");if(s!==null&&s==="terminate"){if(this.disconnecting)return;let r=i.getAttribute("condition");const a=i.getElementsByTagName("conflict");r!==null?(r==="remote-stream-error"&&a.length>0&&(r="conflict"),this._changeConnectStatus(h.Status.CONNFAIL,r)):this._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.UNKOWN_REASON),this._doDisconnect(r);return}h.forEachChild(i,null,r=>{const a=[];this.handlers=this.handlers.reduce((o,c)=>{try{c.isMatch(r)&&(this.authenticated||!c.user)?(c.run(r)&&o.push(c),a.push(c)):o.push(c)}catch(f){h.warn("Removing Strophe handlers due to uncaught exception: "+f.message)}return o},[]),!a.length&&this.iqFallbackHandler.isMatch(r)&&this.iqFallbackHandler.run(r)})}_connect_cb(e,n,i){h.debug("_connect_cb was called"),this.connected=!0;let s;try{s=this._proto._reqToData(e)}catch(c){if(c.name!==h.ErrorCondition.BAD_FORMAT)throw c;this._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.BAD_FORMAT),this._doDisconnect(h.ErrorCondition.BAD_FORMAT)}if(!s||(this.xmlInput!==h.Connection.prototype.xmlInput&&(s.nodeName===this._proto.strip&&s.childNodes.length?this.xmlInput(s.childNodes[0]):this.xmlInput(s)),this.rawInput!==h.Connection.prototype.rawInput&&(i?this.rawInput(i):this.rawInput(h.serialize(s))),this._proto._connect_cb(s)===h.Status.CONNFAIL))return;let a;if(s.getElementsByTagNameNS?a=s.getElementsByTagNameNS(h.NS.STREAM,"features").length>0:a=s.getElementsByTagName("stream:features").length>0||s.getElementsByTagName("features").length>0,!a){this._proto._no_auth_received(n);return}const o=Array.from(s.getElementsByTagName("mechanism")).map(c=>this.mechanisms[c.textContent]).filter(c=>c);if(o.length===0&&s.getElementsByTagName("auth").length===0){this._proto._no_auth_received(n);return}this.do_authentication!==!1&&this.authenticate(o)}sortMechanismsByPriority(e){for(let n=0;n<e.length-1;++n){let i=n;for(let s=n+1;s<e.length;++s)e[s].priority>e[i].priority&&(i=s);if(i!==n){const s=e[n];e[n]=e[i],e[i]=s}}return e}authenticate(e){this._attemptSASLAuth(e)||this._attemptLegacyAuth()}_attemptSASLAuth(e){e=this.sortMechanismsByPriority(e||[]);let n=!1;for(let i=0;i<e.length;++i){if(!e[i].test(this))continue;this._sasl_success_handler=this._addSysHandler(this._sasl_success_cb.bind(this),null,"success",null,null),this._sasl_failure_handler=this._addSysHandler(this._sasl_failure_cb.bind(this),null,"failure",null,null),this._sasl_challenge_handler=this._addSysHandler(this._sasl_challenge_cb.bind(this),null,"challenge",null,null),this._sasl_mechanism=e[i],this._sasl_mechanism.onStart(this);const s=Ct("auth",{xmlns:h.NS.SASL,mechanism:this._sasl_mechanism.mechname});if(this._sasl_mechanism.isClientFirst){const r=this._sasl_mechanism.clientChallenge(this);s.t(gn.btoa(r))}this.send(s.tree()),n=!0;break}return n}_sasl_challenge_cb(e){return qe(this,null,function*(){const n=gn.atob(h.getText(e)),i=yield this._sasl_mechanism.onChallenge(this,n),s=Ct("response",{xmlns:h.NS.SASL});return i!==""&&s.t(gn.btoa(i)),this.send(s.tree()),!0})}_attemptLegacyAuth(){h.getNodeFromJid(this.jid)===null?(this._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.MISSING_JID_NODE),this.disconnect(h.ErrorCondition.MISSING_JID_NODE)):(this._changeConnectStatus(h.Status.AUTHENTICATING,null),this._addSysHandler(this._onLegacyAuthIQResult.bind(this),null,null,null,"_auth_1"),this.send(gt({type:"get",to:this.domain,id:"_auth_1"}).c("query",{xmlns:h.NS.AUTH}).c("username",{}).t(h.getNodeFromJid(this.jid)).tree()))}_onLegacyAuthIQResult(e){const n=gt({type:"set",id:"_auth_2"}).c("query",{xmlns:h.NS.AUTH}).c("username",{}).t(h.getNodeFromJid(this.jid)).up().c("password").t(this.pass);return h.getResourceFromJid(this.jid)||(this.jid=h.getBareJidFromJid(this.jid)+"/strophe"),n.up().c("resource",{}).t(h.getResourceFromJid(this.jid)),this._addSysHandler(this._auth2_cb.bind(this),null,null,null,"_auth_2"),this.send(n.tree()),!1}_sasl_success_cb(e){if(this._sasl_data["server-signature"]){let s;const r=gn.atob(h.getText(e)),a=/([a-z]+)=([^,]+)(,|$)/,o=r.match(a);if(o[1]==="v"&&(s=o[2]),s!==this._sasl_data["server-signature"])return this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_data={},this._sasl_failure_cb(null)}h.info("SASL authentication succeeded."),this._sasl_data.keys&&(this.scram_keys=this._sasl_data.keys),this._sasl_mechanism&&this._sasl_mechanism.onSuccess(),this.deleteHandler(this._sasl_failure_handler),this._sasl_failure_handler=null,this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null);const n=[],i=(s,r)=>{for(;s.length;)this.deleteHandler(s.pop());return this._onStreamFeaturesAfterSASL(r),!1};return n.push(this._addSysHandler(s=>i(n,s),null,"stream:features",null,null)),n.push(this._addSysHandler(s=>i(n,s),h.NS.STREAM,"features",null,null)),this._sendRestart(),!1}_onStreamFeaturesAfterSASL(e){this.features=e;for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];i.nodeName==="bind"&&(this.do_bind=!0),i.nodeName==="session"&&(this.do_session=!0)}if(this.do_bind)this.options.explicitResourceBinding?this._changeConnectStatus(h.Status.BINDREQUIRED,null):this.bind();else return this._changeConnectStatus(h.Status.AUTHFAIL,null),!1;return!1}bind(){if(!this.do_bind){h.log(h.LogLevel.INFO,'Strophe.Connection.prototype.bind called but "do_bind" is false');return}this._addSysHandler(this._onResourceBindResultIQ.bind(this),null,null,null,"_bind_auth_2");const e=h.getResourceFromJid(this.jid);e?this.send(gt({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:h.NS.BIND}).c("resource",{}).t(e).tree()):this.send(gt({type:"set",id:"_bind_auth_2"}).c("bind",{xmlns:h.NS.BIND}).tree())}_onResourceBindResultIQ(e){if(e.getAttribute("type")==="error"){h.warn("Resource binding failed.");const i=e.getElementsByTagName("conflict");let s;return i.length>0&&(s=h.ErrorCondition.CONFLICT),this._changeConnectStatus(h.Status.AUTHFAIL,s,e),!1}const n=e.getElementsByTagName("bind");if(n.length>0){const i=n[0].getElementsByTagName("jid");i.length>0&&(this.authenticated=!0,this.jid=h.getText(i[0]),this.do_session?this._establishSession():this._changeConnectStatus(h.Status.CONNECTED,null))}else return h.warn("Resource binding failed."),this._changeConnectStatus(h.Status.AUTHFAIL,null,e),!1}_establishSession(){if(!this.do_session)throw new Error(`Strophe.Connection.prototype._establishSession called but apparently ${h.NS.SESSION} wasn't advertised by the server`);this._addSysHandler(this._onSessionResultIQ.bind(this),null,null,null,"_session_auth_2"),this.send(gt({type:"set",id:"_session_auth_2"}).c("session",{xmlns:h.NS.SESSION}).tree())}_onSessionResultIQ(e){if(e.getAttribute("type")==="result")this.authenticated=!0,this._changeConnectStatus(h.Status.CONNECTED,null);else if(e.getAttribute("type")==="error")return this.authenticated=!1,h.warn("Session creation failed."),this._changeConnectStatus(h.Status.AUTHFAIL,null,e),!1;return!1}_sasl_failure_cb(e){return this._sasl_success_handler&&(this.deleteHandler(this._sasl_success_handler),this._sasl_success_handler=null),this._sasl_challenge_handler&&(this.deleteHandler(this._sasl_challenge_handler),this._sasl_challenge_handler=null),this._sasl_mechanism&&this._sasl_mechanism.onFailure(),this._changeConnectStatus(h.Status.AUTHFAIL,null,e),!1}_auth2_cb(e){return e.getAttribute("type")==="result"?(this.authenticated=!0,this._changeConnectStatus(h.Status.CONNECTED,null)):e.getAttribute("type")==="error"&&(this._changeConnectStatus(h.Status.AUTHFAIL,null,e),this.disconnect("authentication failed")),!1}_addSysTimedHandler(e,n){const i=new h.TimedHandler(e,n);return i.user=!1,this.addTimeds.push(i),i}_addSysHandler(e,n,i,s,r){const a=new h.Handler(e,n,i,s,r);return a.user=!1,this.addHandlers.push(a),a}_onDisconnectTimeout(){return h.debug("_onDisconnectTimeout was called"),this._changeConnectStatus(h.Status.CONNTIMEOUT,null),this._proto._onDisconnectTimeout(),this._doDisconnect(),!1}_onIdle(){for(;this.addTimeds.length>0;)this.timedHandlers.push(this.addTimeds.pop());for(;this.removeTimeds.length>0;){const i=this.removeTimeds.pop(),s=this.timedHandlers.indexOf(i);s>=0&&this.timedHandlers.splice(s,1)}const e=new Date().getTime(),n=[];for(let i=0;i<this.timedHandlers.length;i++){const s=this.timedHandlers[i];(this.authenticated||!s.user)&&(s.lastCalled+s.period-e<=0?s.run()&&n.push(s):n.push(s))}this.timedHandlers=n,clearTimeout(this._idleTimeout),this._proto._onIdle(),this.connected&&(this._idleTimeout=setTimeout(()=>this._onIdle(),100))}};h.SASLMechanism=je;h.SASLAnonymous=al;h.SASLPlain=cl;h.SASLSHA1=gl;h.SASLSHA256=ml;h.SASLSHA384=_l;h.SASLSHA512=vl;h.SASLOAuthBearer=ll;h.SASLExternal=ol;h.SASLXOAuth2=yl;var un={Strophe:h,$build:Ct,$iq:gt,$msg:Pr,$pres:$r};h.Request=class{constructor(e,n,i,s){this.id=++h._requestId,this.xmlData=e,this.data=h.serialize(e),this.origFunc=n,this.func=n,this.rid=i,this.date=NaN,this.sends=s||0,this.abort=!1,this.dead=null,this.age=function(){return this.date?(new Date-this.date)/1e3:0},this.timeDead=function(){return this.dead?(new Date-this.dead)/1e3:0},this.xhr=this._newXHR()}getResponse(){let e=null;if(this.xhr.responseXML&&this.xhr.responseXML.documentElement){if(e=this.xhr.responseXML.documentElement,e.tagName==="parsererror")throw h.error("invalid response received"),h.error("responseText: "+this.xhr.responseText),h.error("responseXML: "+h.serialize(this.xhr.responseXML)),new Error("parsererror")}else if(this.xhr.responseText)if(h.debug("Got responseText but no responseXML; attempting to parse it with DOMParser..."),e=new et().parseFromString(this.xhr.responseText,"application/xml").documentElement,e){if(e.querySelector("parsererror")){h.error("invalid response received: "+e.querySelector("parsererror").textContent),h.error("responseText: "+this.xhr.responseText);const n=new Error;throw n.name=h.ErrorCondition.BAD_FORMAT,n}}else throw new Error("Parsing produced null node");return e}_newXHR(){let e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8")):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}};h.Bosh=class An{constructor(e){this._conn=e,this.rid=Math.floor(Math.random()*4294967295),this.sid=null,this.hold=1,this.wait=60,this.window=5,this.errors=0,this.inactivity=null,this.lastResponseHeaders=null,this._requests=[]}_buildBody(){const e=Ct("body",{rid:this.rid++,xmlns:h.NS.HTTPBIND});return this.sid!==null&&e.attrs({sid:this.sid}),this._conn.options.keepalive&&this._conn._sessionCachingSupported()&&this._cacheSession(),e}_reset(){this.rid=Math.floor(Math.random()*4294967295),this.sid=null,this.errors=0,this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_connect(e,n,i){this.wait=e||this.wait,this.hold=n||this.hold,this.errors=0;const s=this._buildBody().attrs({to:this._conn.domain,"xml:lang":"en",wait:this.wait,hold:this.hold,content:"text/xml; charset=utf-8",ver:"1.6","xmpp:version":"1.0","xmlns:xmpp":h.NS.BOSH});i&&s.attrs({route:i});const r=this._conn._connect_cb;this._requests.push(new h.Request(s.tree(),this._onRequestStateChange.bind(this,r.bind(this._conn)),s.tree().getAttribute("rid"))),this._throttledRequestHandler()}_attach(e,n,i,s,r,a,o){this._conn.jid=e,this.sid=n,this.rid=i,this._conn.connect_callback=s,this._conn.domain=h.getDomainFromJid(this._conn.jid),this._conn.authenticated=!0,this._conn.connected=!0,this.wait=r||this.wait,this.hold=a||this.hold,this.window=o||this.window,this._conn._changeConnectStatus(h.Status.ATTACHED,null)}_restore(e,n,i,s,r){const a=JSON.parse(window.sessionStorage.getItem("strophe-bosh-session"));if(typeof a!="undefined"&&a!==null&&a.rid&&a.sid&&a.jid&&(typeof e=="undefined"||e===null||h.getBareJidFromJid(a.jid)===h.getBareJidFromJid(e)||h.getNodeFromJid(e)===null&&h.getDomainFromJid(a.jid)===e))this._conn.restored=!0,this._attach(a.jid,a.sid,a.rid,n,i,s,r);else{const o=new Error("_restore: no restoreable session.");throw o.name="StropheSessionError",o}}_cacheSession(){this._conn.authenticated?this._conn.jid&&this.rid&&this.sid&&window.sessionStorage.setItem("strophe-bosh-session",JSON.stringify({jid:this._conn.jid,rid:this.rid,sid:this.sid})):window.sessionStorage.removeItem("strophe-bosh-session")}_connect_cb(e){const n=e.getAttribute("type");if(n!==null&&n==="terminate"){let o=e.getAttribute("condition");h.error("BOSH-Connection failed: "+o);const c=e.getElementsByTagName("conflict");return o!==null?(o==="remote-stream-error"&&c.length>0&&(o="conflict"),this._conn._changeConnectStatus(h.Status.CONNFAIL,o)):this._conn._changeConnectStatus(h.Status.CONNFAIL,"unknown"),this._conn._doDisconnect(o),h.Status.CONNFAIL}this.sid||(this.sid=e.getAttribute("sid"));const i=e.getAttribute("requests");i&&(this.window=parseInt(i,10));const s=e.getAttribute("hold");s&&(this.hold=parseInt(s,10));const r=e.getAttribute("wait");r&&(this.wait=parseInt(r,10));const a=e.getAttribute("inactivity");a&&(this.inactivity=parseInt(a,10))}_disconnect(e){this._sendTerminate(e)}_doDisconnect(){this.sid=null,this.rid=Math.floor(Math.random()*4294967295),this._conn._sessionCachingSupported()&&window.sessionStorage.removeItem("strophe-bosh-session"),this._conn.nextValidRid(this.rid)}_emptyQueue(){return this._requests.length===0}_callProtocolErrorHandlers(e){const n=An._getRequestStatus(e),i=this._conn.protocolErrorHandlers.HTTP[n];i&&i.call(this,n)}_hitError(e){this.errors++,h.warn("request errored, status: "+e+", number of errors: "+this.errors),this.errors>4&&this._conn._onDisconnectTimeout()}_no_auth_received(e){h.warn("Server did not yet offer a supported authentication mechanism. Sending a blank poll request."),e?e=e.bind(this._conn):e=this._conn._connect_cb.bind(this._conn);const n=this._buildBody();this._requests.push(new h.Request(n.tree(),this._onRequestStateChange.bind(this,e),n.tree().getAttribute("rid"))),this._throttledRequestHandler()}_onDisconnectTimeout(){this._abortAllRequests()}_abortAllRequests(){for(;this._requests.length>0;){const e=this._requests.pop();e.abort=!0,e.xhr.abort(),e.xhr.onreadystatechange=function(){}}}_onIdle(){const e=this._conn._data;if(this._conn.authenticated&&this._requests.length===0&&e.length===0&&!this._conn.disconnecting&&(h.debug("no requests during idle cycle, sending blank request"),e.push(null)),!this._conn.paused){if(this._requests.length<2&&e.length>0){const n=this._buildBody();for(let i=0;i<e.length;i++)e[i]!==null&&(e[i]==="restart"?n.attrs({to:this._conn.domain,"xml:lang":"en","xmpp:restart":"true","xmlns:xmpp":h.NS.BOSH}):n.cnode(e[i]).up());delete this._conn._data,this._conn._data=[],this._requests.push(new h.Request(n.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),n.tree().getAttribute("rid"))),this._throttledRequestHandler()}if(this._requests.length>0){const n=this._requests[0].age();this._requests[0].dead!==null&&this._requests[0].timeDead()>Math.floor(h.SECONDARY_TIMEOUT*this.wait)&&this._throttledRequestHandler(),n>Math.floor(h.TIMEOUT*this.wait)&&(h.warn("Request "+this._requests[0].id+" timed out, over "+Math.floor(h.TIMEOUT*this.wait)+" seconds since last activity"),this._throttledRequestHandler())}}}static _getRequestStatus(e,n){let i;if(e.xhr.readyState===4)try{i=e.xhr.status}catch(s){h.error("Caught an error while retrieving a request's status, reqStatus: "+i)}return typeof i=="undefined"&&(i=typeof n=="number"?n:0),i}_onRequestStateChange(e,n){if(h.debug("request id "+n.id+"."+n.sends+" state changed to "+n.xhr.readyState),n.abort){n.abort=!1;return}if(n.xhr.readyState!==4)return;const i=An._getRequestStatus(n);if(this.lastResponseHeaders=n.xhr.getAllResponseHeaders(),this._conn.disconnecting&&i>=400){this._hitError(i),this._callProtocolErrorHandlers(n);return}const s=this._requests[0]===n,r=this._requests[1]===n,a=i>0&&i<500,o=n.sends>this._conn.maxRetries;(a||o)&&(this._removeRequest(n),h.debug("request id "+n.id+" should now be removed")),i===200?((r||s&&this._requests.length>0&&this._requests[0].age()>Math.floor(h.SECONDARY_TIMEOUT*this.wait))&&this._restartRequest(0),this._conn.nextValidRid(Number(n.rid)+1),h.debug("request id "+n.id+"."+n.sends+" got 200"),e(n),this.errors=0):i===0||i>=400&&i<600||i>=12e3?(h.error("request id "+n.id+"."+n.sends+" error "+i+" happened"),this._hitError(i),this._callProtocolErrorHandlers(n),i>=400&&i<500&&(this._conn._changeConnectStatus(h.Status.DISCONNECTING,null),this._conn._doDisconnect())):h.error("request id "+n.id+"."+n.sends+" error "+i+" happened"),!a&&!o?this._throttledRequestHandler():o&&!this._conn.connected&&this._conn._changeConnectStatus(h.Status.CONNFAIL,"giving-up")}_processRequest(e){let n=this._requests[e];const i=An._getRequestStatus(n,-1);if(n.sends>this._conn.maxRetries){this._conn._onDisconnectTimeout();return}const s=n.age(),r=!isNaN(s)&&s>Math.floor(h.TIMEOUT*this.wait),a=n.dead!==null&&n.timeDead()>Math.floor(h.SECONDARY_TIMEOUT*this.wait),o=n.xhr.readyState===4&&(i<1||i>=500);if((r||a||o)&&(a&&h.error(`Request ${this._requests[e].id} timed out (secondary), restarting`),n.abort=!0,n.xhr.abort(),n.xhr.onreadystatechange=function(){},this._requests[e]=new h.Request(n.xmlData,n.origFunc,n.rid,n.sends),n=this._requests[e]),n.xhr.readyState===0){h.debug("request id "+n.id+"."+n.sends+" posting");try{const f=this._conn.options.contentType||"text/xml; charset=utf-8";n.xhr.open("POST",this._conn.service,!this._conn.options.sync),typeof n.xhr.setRequestHeader!="undefined"&&n.xhr.setRequestHeader("Content-Type",f),this._conn.options.withCredentials&&(n.xhr.withCredentials=!0)}catch(f){h.error("XHR open failed: "+f.toString()),this._conn.connected||this._conn._changeConnectStatus(h.Status.CONNFAIL,"bad-service"),this._conn.disconnect();return}const c=()=>{if(n.date=new Date,this._conn.options.customHeaders){const f=this._conn.options.customHeaders;for(const g in f)Object.prototype.hasOwnProperty.call(f,g)&&n.xhr.setRequestHeader(g,f[g])}n.xhr.send(n.data)};if(n.sends>1){const f=Math.min(Math.floor(h.TIMEOUT*this.wait),Math.pow(n.sends,3))*1e3;setTimeout(function(){c()},f)}else c();n.sends++,this._conn.xmlOutput!==h.Connection.prototype.xmlOutput&&(n.xmlData.nodeName===this.strip&&n.xmlData.childNodes.length?this._conn.xmlOutput(n.xmlData.childNodes[0]):this._conn.xmlOutput(n.xmlData)),this._conn.rawOutput!==h.Connection.prototype.rawOutput&&this._conn.rawOutput(n.data)}else h.debug("_processRequest: "+(e===0?"first":"second")+" request has readyState of "+n.xhr.readyState)}_removeRequest(e){h.debug("removing request");for(let n=this._requests.length-1;n>=0;n--)e===this._requests[n]&&this._requests.splice(n,1);e.xhr.onreadystatechange=function(){},this._throttledRequestHandler()}_restartRequest(e){const n=this._requests[e];n.dead===null&&(n.dead=new Date),this._processRequest(e)}_reqToData(e){try{return e.getResponse()}catch(n){if(n.message!=="parsererror")throw n;this._conn.disconnect("strophe-parsererror")}}_sendTerminate(e){h.debug("_sendTerminate was called");const n=this._buildBody().attrs({type:"terminate"});e&&n.cnode(e.tree());const i=new h.Request(n.tree(),this._onRequestStateChange.bind(this,this._conn._dataRecv.bind(this._conn)),n.tree().getAttribute("rid"));this._requests.push(i),this._throttledRequestHandler()}_send(){clearTimeout(this._conn._idleTimeout),this._throttledRequestHandler(),this._conn._idleTimeout=setTimeout(()=>this._conn._onIdle(),100)}_sendRestart(){this._throttledRequestHandler(),clearTimeout(this._conn._idleTimeout)}_throttledRequestHandler(){this._requests?h.debug("_throttledRequestHandler called with "+this._requests.length+" requests"):h.debug("_throttledRequestHandler called with undefined requests"),!(!this._requests||this._requests.length===0)&&(this._requests.length>0&&this._processRequest(0),this._requests.length>1&&Math.abs(this._requests[0].rid-this._requests[1].rid)<this.window&&this._processRequest(1))}};h.Bosh.prototype.strip=null;h.Websocket=class{constructor(e){this._conn=e,this.strip="wrapper";const n=e.service;if(n.indexOf("ws:")!==0&&n.indexOf("wss:")!==0){let i="";e.options.protocol==="ws"&&window.location.protocol!=="https:"?i+="ws":i+="wss",i+="://"+window.location.host,n.indexOf("/")!==0?i+=window.location.pathname+n:i+=n,e.service=i}}_buildStream(){return Ct("open",{xmlns:h.NS.FRAMING,to:this._conn.domain,version:"1.0"})}_checkStreamError(e,n){let i;if(e.getElementsByTagNameNS?i=e.getElementsByTagNameNS(h.NS.STREAM,"error"):i=e.getElementsByTagName("stream:error"),i.length===0)return!1;const s=i[0];let r="",a="";const o="urn:ietf:params:xml:ns:xmpp-streams";for(let f=0;f<s.childNodes.length;f++){const g=s.childNodes[f];if(g.getAttribute("xmlns")!==o)break;g.nodeName==="text"?a=g.textContent:r=g.nodeName}let c="WebSocket stream error: ";return r?c+=r:c+="unknown",a&&(c+=" - "+a),h.error(c),this._conn._changeConnectStatus(n,r),this._conn._doDisconnect(),!0}_reset(){}_connect(){this._closeSocket(),this.socket=new Os(this._conn.service,"xmpp"),this.socket.onopen=()=>this._onOpen(),this.socket.onerror=e=>this._onError(e),this.socket.onclose=e=>this._onClose(e),this.socket.onmessage=e=>this._onInitialMessage(e)}_connect_cb(e){if(this._checkStreamError(e,h.Status.CONNFAIL))return h.Status.CONNFAIL}_handleStreamStart(e){let n=!1;const i=e.getAttribute("xmlns");typeof i!="string"?n="Missing xmlns in <open />":i!==h.NS.FRAMING&&(n="Wrong xmlns in <open />: "+i);const s=e.getAttribute("version");return typeof s!="string"?n="Missing version in <open />":s!=="1.0"&&(n="Wrong version in <open />: "+s),n?(this._conn._changeConnectStatus(h.Status.CONNFAIL,n),this._conn._doDisconnect(),!1):!0}_onInitialMessage(e){if(e.data.indexOf("<open ")===0||e.data.indexOf("<?xml")===0){const n=e.data.replace(/^(<\?.*?\?>\s*)*/,"");if(n==="")return;const i=new et().parseFromString(n,"text/xml").documentElement;this._conn.xmlInput(i),this._conn.rawInput(e.data),this._handleStreamStart(i)&&this._connect_cb(i)}else if(e.data.indexOf("<close ")===0){const n=new et().parseFromString(e.data,"text/xml").documentElement;this._conn.xmlInput(n),this._conn.rawInput(e.data);const i=n.getAttribute("see-other-uri");if(i){const s=this._conn.service;(s.indexOf("wss:")>=0&&i.indexOf("wss:")>=0||s.indexOf("ws:")>=0)&&(this._conn._changeConnectStatus(h.Status.REDIRECT,"Received see-other-uri, resetting connection"),this._conn.reset(),this._conn.service=i,this._connect())}else this._conn._changeConnectStatus(h.Status.CONNFAIL,"Received closing stream"),this._conn._doDisconnect()}else{this._replaceMessageHandler();const n=this._streamWrap(e.data),i=new et().parseFromString(n,"text/xml").documentElement;this._conn._connect_cb(i,null,e.data)}}_replaceMessageHandler(){this.socket.onmessage=e=>this._onMessage(e)}_disconnect(e){if(this.socket&&this.socket.readyState!==Os.CLOSED){e&&this._conn.send(e);const n=Ct("close",{xmlns:h.NS.FRAMING});this._conn.xmlOutput(n.tree());const i=h.serialize(n);this._conn.rawOutput(i);try{this.socket.send(i)}catch(s){h.warn("Couldn't send <close /> tag.")}}setTimeout(()=>this._conn._doDisconnect,0)}_doDisconnect(){h.debug("WebSockets _doDisconnect was called"),this._closeSocket()}_streamWrap(e){return"<wrapper>"+e+"</wrapper>"}_closeSocket(){if(this.socket)try{this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null,this.socket.close()}catch(e){h.debug(e.message)}this.socket=null}_emptyQueue(){return!0}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(h.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&e.code===1006&&!this._conn.connected&&this.socket?(h.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(h.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):h.debug("Websocket closed")}_no_auth_received(e){h.error("Server did not offer a supported authentication mechanism"),this._conn._changeConnectStatus(h.Status.CONNFAIL,h.ErrorCondition.NO_AUTH_MECH),e&&e.call(this._conn),this._conn._doDisconnect()}_onDisconnectTimeout(){}_abortAllRequests(){}_onError(e){h.error("Websocket error "+JSON.stringify(e)),this._conn._changeConnectStatus(h.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._disconnect()}_onIdle(){const e=this._conn._data;if(e.length>0&&!this._conn.paused){for(let n=0;n<e.length;n++)if(e[n]!==null){let i;e[n]==="restart"?i=this._buildStream().tree():i=e[n];const s=h.serialize(i);this._conn.xmlOutput(i),this._conn.rawOutput(s),this.socket.send(s)}this._conn._data=[]}}_onMessage(e){let n;const i='<close xmlns="urn:ietf:params:xml:ns:xmpp-framing" />';if(e.data===i){this._conn.rawInput(i),this._conn.xmlInput(e),this._conn.disconnecting||this._conn._doDisconnect();return}else if(e.data.search("<open ")===0){if(n=new et().parseFromString(e.data,"text/xml").documentElement,!this._handleStreamStart(n))return}else{const s=this._streamWrap(e.data);n=new et().parseFromString(s,"text/xml").documentElement}if(!this._checkStreamError(n,h.Status.ERROR)){if(this._conn.disconnecting&&n.firstChild.nodeName==="presence"&&n.firstChild.getAttribute("type")==="unavailable"){this._conn.xmlInput(n),this._conn.rawInput(h.serialize(n));return}this._conn._dataRecv(n,e.data)}}_onOpen(){h.debug("Websocket open");const e=this._buildStream();this._conn.xmlOutput(e.tree());const n=h.serialize(e);this._conn.rawOutput(n),this.socket.send(n)}_reqToData(e){return e}_send(){this._conn.flush()}_sendRestart(){clearTimeout(this._conn._idleTimeout),this._conn._onIdle.bind(this._conn)()}};const Dt={};Dt.debug=h.LogLevel.DEBUG;Dt.info=h.LogLevel.INFO;Dt.warn=h.LogLevel.WARN;Dt.error=h.LogLevel.ERROR;Dt.fatal=h.LogLevel.FATAL;h.WorkerWebsocket=class extends h.Websocket{constructor(e){super(e),this._conn=e,this.worker=new SharedWorker(this._conn.options.worker,"Strophe XMPP Connection"),this.worker.onerror=n=>{var i;(i=console)===null||i===void 0||i.error(n),h.log(h.LogLevel.ERROR,`Shared Worker Error: ${n}`)}}get socket(){return{send:e=>this.worker.port.postMessage(["send",e])}}_connect(){this._messageHandler=e=>this._onInitialMessage(e),this.worker.port.start(),this.worker.port.onmessage=e=>this._onWorkerMessage(e),this.worker.port.postMessage(["_connect",this._conn.service,this._conn.jid])}_attach(e){this._messageHandler=n=>this._onMessage(n),this._conn.connect_callback=e,this.worker.port.start(),this.worker.port.onmessage=n=>this._onWorkerMessage(n),this.worker.port.postMessage(["_attach",this._conn.service])}_attachCallback(e,n){e===h.Status.ATTACHED?(this._conn.jid=n,this._conn.authenticated=!0,this._conn.connected=!0,this._conn.restored=!0,this._conn._changeConnectStatus(h.Status.ATTACHED)):e===h.Status.ATTACHFAIL&&(this._conn.authenticated=!1,this._conn.connected=!1,this._conn.restored=!1,this._conn._changeConnectStatus(h.Status.ATTACHFAIL))}_disconnect(e,n){n&&this._conn.send(n);const i=Ct("close",{xmlns:h.NS.FRAMING});this._conn.xmlOutput(i.tree());const s=h.serialize(i);this._conn.rawOutput(s),this.worker.port.postMessage(["send",s]),this._conn._doDisconnect()}_onClose(e){this._conn.connected&&!this._conn.disconnecting?(h.error("Websocket closed unexpectedly"),this._conn._doDisconnect()):e&&e.code===1006&&!this._conn.connected?(h.error("Websocket closed unexcectedly"),this._conn._changeConnectStatus(h.Status.CONNFAIL,"The WebSocket connection could not be established or was disconnected."),this._conn._doDisconnect()):h.debug("Websocket closed")}_closeSocket(){this.worker.port.postMessage(["_closeSocket"])}_replaceMessageHandler(){this._messageHandler=e=>this._onMessage(e)}_onWorkerMessage(e){const{data:n}=e,i=n[0];if(i==="_onMessage")this._messageHandler(n[1]);else if(i in this)try{this[i].apply(this,e.data.slice(1))}catch(s){h.log(h.LogLevel.ERROR,s)}else if(i==="log"){const s=n[1],r=n[2];h.log(Dt[s],r)}else h.log(h.LogLevel.ERROR,`Found unhandled service worker message: ${n}`)}};kt.$build=un.$build;kt.$iq=un.$iq;kt.$msg=un.$msg;kt.$pres=un.$pres;kt.Strophe=un.Strophe;function bl(){const t=new XDomainRequest;this.xhr=t,this.open=(...e)=>{try{this.readyState=1,t.open(...e)}catch(n){throw n}},this.send=(...e)=>{this.readyState=2,t.send(...e)},this.abort=(...e)=>{this.readyState=4,t.abort(...e)},this.onreadystatechange=()=>{},this.setRequestHeader=()=>{},this.readyState=0,t.onerror=()=>{this.readyState=4,this.status=500,this.onreadystatechange()},t.onload=()=>{const e=new DOMParser;this.readyState=4,this.responseText=t.responseText,this.timeout=t.timeout,this.contentType=t.contentType,this.constructor=t.constructor;try{this.responseXML=e.parseFromString(t.responseText,"application/xml"),this.status=200}catch(n){this.status=406}this.onreadystatechange()},t.ontimeout=()=>{this.readyState=4,this.status=408,this.onreadystatechange()},t.onprogress=()=>{this.readyState=3},this.getAllResponseHeaders=()=>t.getAllResponseHeaders?t.getAllResponseHeaders():""}function Cl(t){t.addConnectionPlugin("xdomain",{init(){t.Request.prototype._newXHR=function(){let e=null;return window.XMLHttpRequest?(e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/xml; charset=utf-8"),!("withCredentials"in e)&&window.XDomainRequest&&(e=new bl)):window.ActiveXObject&&(e=new ActiveXObject("Microsoft.XMLHTTP")),e.onreadystatechange=this.func.bind(null,this),e}}})}/*!
 * Vue.js v2.7.14
 * (c) 2014-2022 Evan You
 * Released under the MIT License.
 */var ke=Object.freeze({}),Y=Array.isArray;function X(t){return t==null}function k(t){return t!=null}function oe(t){return t===!0}function wl(t){return t===!1}function dn(t){return typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="boolean"}function ae(t){return typeof t=="function"}function ve(t){return t!==null&&typeof t=="object"}var Xi=Object.prototype.toString;function Oe(t){return Xi.call(t)==="[object Object]"}function Sl(t){return Xi.call(t)==="[object RegExp]"}function Fr(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function vi(t){return k(t)&&typeof t.then=="function"&&typeof t.catch=="function"}function Tl(t){return t==null?"":Array.isArray(t)||Oe(t)&&t.toString===Xi?JSON.stringify(t,null,2):String(t)}function en(t){var e=parseFloat(t);return isNaN(e)?t:e}function He(t,e){for(var n=Object.create(null),i=t.split(","),s=0;s<i.length;s++)n[i[s]]=!0;return e?function(r){return n[r.toLowerCase()]}:function(r){return n[r]}}He("slot,component",!0);var El=He("key,ref,slot,slot-scope,is");function ht(t,e){var n=t.length;if(n){if(e===t[n-1]){t.length=n-1;return}var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}var Al=Object.prototype.hasOwnProperty;function Ce(t,e){return Al.call(t,e)}function Ot(t){var e=Object.create(null);return function(i){var s=e[i];return s||(e[i]=t(i))}}var xl=/-(\w)/g,wt=Ot(function(t){return t.replace(xl,function(e,n){return n?n.toUpperCase():""})}),kl=Ot(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}),Ol=/\B([A-Z])/g,hn=Ot(function(t){return t.replace(Ol,"-$1").toLowerCase()});function Il(t,e){function n(i){var s=arguments.length;return s?s>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return n._length=t.length,n}function Ml(t,e){return t.bind(e)}var Dr=Function.prototype.bind?Ml:Il;function yi(t,e){e=e||0;for(var n=t.length-e,i=new Array(n);n--;)i[n]=t[n+e];return i}function re(t,e){for(var n in e)t[n]=e[n];return t}function Hr(t){for(var e={},n=0;n<t.length;n++)t[n]&&re(e,t[n]);return e}function me(t,e,n){}var mn=function(t,e,n){return!1},qr=function(t){return t};function St(t,e){if(t===e)return!0;var n=ve(t),i=ve(e);if(n&&i)try{var s=Array.isArray(t),r=Array.isArray(e);if(s&&r)return t.length===e.length&&t.every(function(c,f){return St(c,e[f])});if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(!s&&!r){var a=Object.keys(t),o=Object.keys(e);return a.length===o.length&&a.every(function(c){return St(t[c],e[c])})}else return!1}catch(c){return!1}else return!n&&!i?String(t)===String(e):!1}function Ur(t,e){for(var n=0;n<t.length;n++)if(St(t[n],e))return n;return-1}function Nn(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}function Rl(t,e){return t===e?t===0&&1/t!==1/e:t===t||e===e}var Is="data-server-rendered",Jn=["component","directive","filter"],Br=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],Ne={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:mn,isReservedAttr:mn,isUnknownElement:mn,getTagNamespace:me,parsePlatformTagName:qr,mustUseProp:mn,async:!0,_lifecycleHooks:Br},Nl=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function zr(t){var e=(t+"").charCodeAt(0);return e===36||e===95}function at(t,e,n,i){Object.defineProperty(t,e,{value:n,enumerable:!!i,writable:!0,configurable:!0})}var Ll=new RegExp("[^".concat(Nl.source,".$_\\d]"));function Pl(t){if(!Ll.test(t)){var e=t.split(".");return function(n){for(var i=0;i<e.length;i++){if(!n)return;n=n[e[i]]}return n}}}var $l="__proto__"in{},Me=typeof window!="undefined",ye=Me&&window.navigator.userAgent.toLowerCase(),Ht=ye&&/msie|trident/.test(ye),qt=ye&&ye.indexOf("msie 9.0")>0,Qi=ye&&ye.indexOf("edge/")>0;ye&&ye.indexOf("android")>0;var Fl=ye&&/iphone|ipad|ipod|ios/.test(ye);ye&&/chrome\/\d+/.test(ye);ye&&/phantomjs/.test(ye);var Ms=ye&&ye.match(/firefox\/(\d+)/),bi={}.watch,Wr=!1;if(Me)try{var Rs={};Object.defineProperty(Rs,"passive",{get:function(){Wr=!0}}),window.addEventListener("test-passive",null,Rs)}catch(t){}var _n,fn=function(){return _n===void 0&&(!Me&&typeof window!="undefined"?_n=window.process&&window.process.env.VUE_ENV==="server":_n=!1),_n},Ln=Me&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function Pt(t){return typeof t=="function"&&/native code/.test(t.toString())}var pn=typeof Symbol!="undefined"&&Pt(Symbol)&&typeof Reflect!="undefined"&&Pt(Reflect.ownKeys),tn;typeof Set!="undefined"&&Pt(Set)?tn=Set:tn=function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(e){return this.set[e]===!0},t.prototype.add=function(e){this.set[e]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var Yt=null;function lt(t){t===void 0&&(t=null),t||Yt&&Yt._scope.off(),Yt=t,t&&t._scope.on()}var Ie=function(){function t(e,n,i,s,r,a,o,c){this.tag=e,this.data=n,this.children=i,this.text=s,this.elm=r,this.ns=void 0,this.context=a,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=n&&n.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=c,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(t.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),t}(),mt=function(t){t===void 0&&(t="");var e=new Ie;return e.text=t,e.isComment=!0,e};function Mt(t){return new Ie(void 0,void 0,void 0,String(t))}function Ci(t){var e=new Ie(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var Dl=0,xn=[],Hl=function(){for(var t=0;t<xn.length;t++){var e=xn[t];e.subs=e.subs.filter(function(n){return n}),e._pending=!1}xn.length=0},ct=function(){function t(){this._pending=!1,this.id=Dl++,this.subs=[]}return t.prototype.addSub=function(e){this.subs.push(e)},t.prototype.removeSub=function(e){this.subs[this.subs.indexOf(e)]=null,this._pending||(this._pending=!0,xn.push(this))},t.prototype.depend=function(e){t.target&&t.target.addDep(this)},t.prototype.notify=function(e){for(var n=this.subs.filter(function(a){return a}),i=0,s=n.length;i<s;i++){var r=n[i];r.update()}},t}();ct.target=null;var kn=[];function Ut(t){kn.push(t),ct.target=t}function Bt(){kn.pop(),ct.target=kn[kn.length-1]}var jr=Array.prototype,Pn=Object.create(jr),ql=["push","pop","shift","unshift","splice","sort","reverse"];ql.forEach(function(t){var e=jr[t];at(Pn,t,function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];var r=e.apply(this,i),a=this.__ob__,o;switch(t){case"push":case"unshift":o=i;break;case"splice":o=i.slice(2);break}return o&&a.observeArray(o),a.dep.notify(),r})});var Ns=Object.getOwnPropertyNames(Pn),Xr={},Gi=!0;function ut(t){Gi=t}var Ul={notify:me,depend:me,addSub:me,removeSub:me},Ls=function(){function t(e,n,i){if(n===void 0&&(n=!1),i===void 0&&(i=!1),this.value=e,this.shallow=n,this.mock=i,this.dep=i?Ul:new ct,this.vmCount=0,at(e,"__ob__",this),Y(e)){if(!i)if($l)e.__proto__=Pn;else for(var s=0,r=Ns.length;s<r;s++){var a=Ns[s];at(e,a,Pn[a])}n||this.observeArray(e)}else for(var o=Object.keys(e),s=0;s<o.length;s++){var a=o[s];Tt(e,a,Xr,void 0,n,i)}}return t.prototype.observeArray=function(e){for(var n=0,i=e.length;n<i;n++)Je(e[n],!1,this.mock)},t}();function Je(t,e,n){if(t&&Ce(t,"__ob__")&&t.__ob__ instanceof Ls)return t.__ob__;if(Gi&&(n||!fn())&&(Y(t)||Oe(t))&&Object.isExtensible(t)&&!t.__v_skip&&!ze(t)&&!(t instanceof Ie))return new Ls(t,e,n)}function Tt(t,e,n,i,s,r){var a=new ct,o=Object.getOwnPropertyDescriptor(t,e);if(!(o&&o.configurable===!1)){var c=o&&o.get,f=o&&o.set;(!c||f)&&(n===Xr||arguments.length===2)&&(n=t[e]);var g=!s&&Je(n,!1,r);return Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var A=c?c.call(t):n;return ct.target&&(a.depend(),g&&(g.dep.depend(),Y(A)&&Gr(A))),ze(A)&&!s?A.value:A},set:function(A){var N=c?c.call(t):n;if(!!Rl(N,A)){if(f)f.call(t,A);else{if(c)return;if(!s&&ze(N)&&!ze(A)){N.value=A;return}else n=A}g=!s&&Je(A,!1,r),a.notify()}}}),a}}function Ji(t,e,n){if(!Vi(t)){var i=t.__ob__;return Y(t)&&Fr(e)?(t.length=Math.max(t.length,e),t.splice(e,1,n),i&&!i.shallow&&i.mock&&Je(n,!1,!0),n):e in t&&!(e in Object.prototype)?(t[e]=n,n):t._isVue||i&&i.vmCount?n:i?(Tt(i.value,e,n,void 0,i.shallow,i.mock),i.dep.notify(),n):(t[e]=n,n)}}function Qr(t,e){if(Y(t)&&Fr(e)){t.splice(e,1);return}var n=t.__ob__;t._isVue||n&&n.vmCount||Vi(t)||!Ce(t,e)||(delete t[e],n&&n.dep.notify())}function Gr(t){for(var e=void 0,n=0,i=t.length;n<i;n++)e=t[n],e&&e.__ob__&&e.__ob__.dep.depend(),Y(e)&&Gr(e)}function Jr(t){return Bl(t,!0),at(t,"__v_isShallow",!0),t}function Bl(t,e){Vi(t)||Je(t,e,fn())}function Vi(t){return!!(t&&t.__v_isReadonly)}function ze(t){return!!(t&&t.__v_isRef===!0)}function wi(t,e,n){Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:function(){var i=e[n];if(ze(i))return i.value;var s=i&&i.__ob__;return s&&s.dep.depend(),i},set:function(i){var s=e[n];ze(s)&&!ze(i)?s.value=i:e[n]=i}})}var Ae,zl=function(){function t(e){e===void 0&&(e=!1),this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Ae,!e&&Ae&&(this.index=(Ae.scopes||(Ae.scopes=[])).push(this)-1)}return t.prototype.run=function(e){if(this.active){var n=Ae;try{return Ae=this,e()}finally{Ae=n}}},t.prototype.on=function(){Ae=this},t.prototype.off=function(){Ae=this.parent},t.prototype.stop=function(e){if(this.active){var n=void 0,i=void 0;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].teardown();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){var s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this.active=!1}},t}();function Wl(t,e){e===void 0&&(e=Ae),e&&e.active&&e.effects.push(t)}function jl(t){var e=t._provided,n=t.$parent&&t.$parent._provided;return n===e?t._provided=Object.create(n):e}var Ps=Ot(function(t){var e=t.charAt(0)==="&";t=e?t.slice(1):t;var n=t.charAt(0)==="~";t=n?t.slice(1):t;var i=t.charAt(0)==="!";return t=i?t.slice(1):t,{name:t,once:n,capture:i,passive:e}});function Si(t,e){function n(){var i=n.fns;if(Y(i))for(var s=i.slice(),r=0;r<s.length;r++)dt(s[r],null,arguments,e,"v-on handler");else return dt(i,null,arguments,e,"v-on handler")}return n.fns=t,n}function Vr(t,e,n,i,s,r){var a,o,c,f;for(a in t)o=t[a],c=e[a],f=Ps(a),X(o)||(X(c)?(X(o.fns)&&(o=t[a]=Si(o,r)),oe(f.once)&&(o=t[a]=s(f.name,o,f.capture)),n(f.name,o,f.capture,f.passive,f.params)):o!==c&&(c.fns=o,t[a]=c));for(a in e)X(t[a])&&(f=Ps(a),i(f.name,e[a],f.capture))}function nt(t,e,n){t instanceof Ie&&(t=t.data.hook||(t.data.hook={}));var i,s=t[e];function r(){n.apply(this,arguments),ht(i.fns,r)}X(s)?i=Si([r]):k(s.fns)&&oe(s.merged)?(i=s,i.fns.push(r)):i=Si([s,r]),i.merged=!0,t[e]=i}function Xl(t,e,n){var i=e.options.props;if(!X(i)){var s={},r=t.attrs,a=t.props;if(k(r)||k(a))for(var o in i){var c=hn(o);$s(s,a,o,c,!0)||$s(s,r,o,c,!1)}return s}}function $s(t,e,n,i,s){if(k(e)){if(Ce(e,n))return t[n]=e[n],s||delete e[n],!0;if(Ce(e,i))return t[n]=e[i],s||delete e[i],!0}return!1}function Ql(t){for(var e=0;e<t.length;e++)if(Y(t[e]))return Array.prototype.concat.apply([],t);return t}function Yi(t){return dn(t)?[Mt(t)]:Y(t)?Yr(t):void 0}function Wt(t){return k(t)&&k(t.text)&&wl(t.isComment)}function Yr(t,e){var n=[],i,s,r,a;for(i=0;i<t.length;i++)s=t[i],!(X(s)||typeof s=="boolean")&&(r=n.length-1,a=n[r],Y(s)?s.length>0&&(s=Yr(s,"".concat(e||"","_").concat(i)),Wt(s[0])&&Wt(a)&&(n[r]=Mt(a.text+s[0].text),s.shift()),n.push.apply(n,s)):dn(s)?Wt(a)?n[r]=Mt(a.text+s):s!==""&&n.push(Mt(s)):Wt(s)&&Wt(a)?n[r]=Mt(a.text+s.text):(oe(t._isVList)&&k(s.tag)&&X(s.key)&&k(e)&&(s.key="__vlist".concat(e,"_").concat(i,"__")),n.push(s)));return n}function Gl(t,e){var n=null,i,s,r,a;if(Y(t)||typeof t=="string")for(n=new Array(t.length),i=0,s=t.length;i<s;i++)n[i]=e(t[i],i);else if(typeof t=="number")for(n=new Array(t),i=0;i<t;i++)n[i]=e(i+1,i);else if(ve(t))if(pn&&t[Symbol.iterator]){n=[];for(var o=t[Symbol.iterator](),c=o.next();!c.done;)n.push(e(c.value,n.length)),c=o.next()}else for(r=Object.keys(t),n=new Array(r.length),i=0,s=r.length;i<s;i++)a=r[i],n[i]=e(t[a],a,i);return k(n)||(n=[]),n._isVList=!0,n}function Jl(t,e,n,i){var s=this.$scopedSlots[t],r;s?(n=n||{},i&&(n=re(re({},i),n)),r=s(n)||(ae(e)?e():e)):r=this.$slots[t]||(ae(e)?e():e);var a=n&&n.slot;return a?this.$createElement("template",{slot:a},r):r}function Vl(t){return Un(this.$options,"filters",t)||qr}function Fs(t,e){return Y(t)?t.indexOf(e)===-1:t!==e}function Yl(t,e,n,i,s){var r=Ne.keyCodes[e]||n;return s&&i&&!Ne.keyCodes[e]?Fs(s,i):r?Fs(r,t):i?hn(i)!==e:t===void 0}function Kl(t,e,n,i,s){if(n&&ve(n)){Y(n)&&(n=Hr(n));var r=void 0,a=function(c){if(c==="class"||c==="style"||El(c))r=t;else{var f=t.attrs&&t.attrs.type;r=i||Ne.mustUseProp(e,f,c)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var g=wt(c),E=hn(c);if(!(g in r)&&!(E in r)&&(r[c]=n[c],s)){var A=t.on||(t.on={});A["update:".concat(c)]=function(N){n[c]=N}}};for(var o in n)a(o)}return t}function Zl(t,e){var n=this._staticTrees||(this._staticTrees=[]),i=n[t];return i&&!e||(i=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,this._c,this),Kr(i,"__static__".concat(t),!1)),i}function ec(t,e,n){return Kr(t,"__once__".concat(e).concat(n?"_".concat(n):""),!0),t}function Kr(t,e,n){if(Y(t))for(var i=0;i<t.length;i++)t[i]&&typeof t[i]!="string"&&Ds(t[i],"".concat(e,"_").concat(i),n);else Ds(t,e,n)}function Ds(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function tc(t,e){if(e&&Oe(e)){var n=t.on=t.on?re({},t.on):{};for(var i in e){var s=n[i],r=e[i];n[i]=s?[].concat(s,r):r}}return t}function Zr(t,e,n,i){e=e||{$stable:!n};for(var s=0;s<t.length;s++){var r=t[s];Y(r)?Zr(r,e,n):r&&(r.proxy&&(r.fn.proxy=!0),e[r.key]=r.fn)}return i&&(e.$key=i),e}function nc(t,e){for(var n=0;n<e.length;n+=2){var i=e[n];typeof i=="string"&&i&&(t[e[n]]=e[n+1])}return t}function ic(t,e){return typeof t=="string"?e+t:t}function ea(t){t._o=ec,t._n=en,t._s=Tl,t._l=Gl,t._t=Jl,t._q=St,t._i=Ur,t._m=Zl,t._f=Vl,t._k=Yl,t._b=Kl,t._v=Mt,t._e=mt,t._u=Zr,t._g=tc,t._d=nc,t._p=ic}function Ki(t,e){if(!t||!t.length)return{};for(var n={},i=0,s=t.length;i<s;i++){var r=t[i],a=r.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,(r.context===e||r.fnContext===e)&&a&&a.slot!=null){var o=a.slot,c=n[o]||(n[o]=[]);r.tag==="template"?c.push.apply(c,r.children||[]):c.push(r)}else(n.default||(n.default=[])).push(r)}for(var f in n)n[f].every(sc)&&delete n[f];return n}function sc(t){return t.isComment&&!t.asyncFactory||t.text===" "}function nn(t){return t.isComment&&t.asyncFactory}function Kt(t,e,n,i){var s,r=Object.keys(n).length>0,a=e?!!e.$stable:!r,o=e&&e.$key;if(!e)s={};else{if(e._normalized)return e._normalized;if(a&&i&&i!==ke&&o===i.$key&&!r&&!i.$hasNormal)return i;s={};for(var c in e)e[c]&&c[0]!=="$"&&(s[c]=rc(t,n,c,e[c]))}for(var f in n)f in s||(s[f]=ac(n,f));return e&&Object.isExtensible(e)&&(e._normalized=s),at(s,"$stable",a),at(s,"$key",o),at(s,"$hasNormal",r),s}function rc(t,e,n,i){var s=function(){var r=Yt;lt(t);var a=arguments.length?i.apply(null,arguments):i({});a=a&&typeof a=="object"&&!Y(a)?[a]:Yi(a);var o=a&&a[0];return lt(r),a&&(!o||a.length===1&&o.isComment&&!nn(o))?void 0:a};return i.proxy&&Object.defineProperty(e,n,{get:s,enumerable:!0,configurable:!0}),s}function ac(t,e){return function(){return t[e]}}function oc(t){var e=t.$options,n=e.setup;if(n){var i=t._setupContext=lc(t);lt(t),Ut();var s=dt(n,null,[t._props||Jr({}),i],t,"setup");if(Bt(),lt(),ae(s))e.render=s;else if(ve(s))if(t._setupState=s,s.__sfc){var a=t._setupProxy={};for(var r in s)r!=="__sfc"&&wi(a,s,r)}else for(var r in s)zr(r)||wi(t,s,r)}}function lc(t){return{get attrs(){if(!t._attrsProxy){var e=t._attrsProxy={};at(e,"_v_attr_proxy",!0),$n(e,t.$attrs,ke,t,"$attrs")}return t._attrsProxy},get listeners(){if(!t._listenersProxy){var e=t._listenersProxy={};$n(e,t.$listeners,ke,t,"$listeners")}return t._listenersProxy},get slots(){return uc(t)},emit:Dr(t.$emit,t),expose:function(e){e&&Object.keys(e).forEach(function(n){return wi(t,e,n)})}}}function $n(t,e,n,i,s){var r=!1;for(var a in e)a in t?e[a]!==n[a]&&(r=!0):(r=!0,cc(t,a,i,s));for(var a in t)a in e||(r=!0,delete t[a]);return r}function cc(t,e,n,i){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){return n[i][e]}})}function uc(t){return t._slotsProxy||ta(t._slotsProxy={},t.$scopedSlots),t._slotsProxy}function ta(t,e){for(var n in e)t[n]=e[n];for(var n in t)n in e||delete t[n]}function dc(t){t._vnode=null,t._staticTrees=null;var e=t.$options,n=t.$vnode=e._parentVnode,i=n&&n.context;t.$slots=Ki(e._renderChildren,i),t.$scopedSlots=n?Kt(t.$parent,n.data.scopedSlots,t.$slots):ke,t._c=function(r,a,o,c){return Fn(t,r,a,o,c,!1)},t.$createElement=function(r,a,o,c){return Fn(t,r,a,o,c,!0)};var s=n&&n.data;Tt(t,"$attrs",s&&s.attrs||ke,null,!0),Tt(t,"$listeners",e._parentListeners||ke,null,!0)}var Ti=null;function hc(t){ea(t.prototype),t.prototype.$nextTick=function(e){return Zi(e,this)},t.prototype._render=function(){var e=this,n=e.$options,i=n.render,s=n._parentVnode;s&&e._isMounted&&(e.$scopedSlots=Kt(e.$parent,s.data.scopedSlots,e.$slots,e.$scopedSlots),e._slotsProxy&&ta(e._slotsProxy,e.$scopedSlots)),e.$vnode=s;var r;try{lt(e),Ti=e,r=i.call(e._renderProxy,e.$createElement)}catch(a){Et(a,e,"render"),r=e._vnode}finally{Ti=null,lt()}return Y(r)&&r.length===1&&(r=r[0]),r instanceof Ie||(r=mt()),r.parent=s,r}}function ai(t,e){return(t.__esModule||pn&&t[Symbol.toStringTag]==="Module")&&(t=t.default),ve(t)?e.extend(t):t}function fc(t,e,n,i,s){var r=mt();return r.asyncFactory=t,r.asyncMeta={data:e,context:n,children:i,tag:s},r}function pc(t,e){if(oe(t.error)&&k(t.errorComp))return t.errorComp;if(k(t.resolved))return t.resolved;var n=Ti;if(n&&k(t.owners)&&t.owners.indexOf(n)===-1&&t.owners.push(n),oe(t.loading)&&k(t.loadingComp))return t.loadingComp;if(n&&!k(t.owners)){var i=t.owners=[n],s=!0,r=null,a=null;n.$on("hook:destroyed",function(){return ht(i,n)});var o=function(E){for(var A=0,N=i.length;A<N;A++)i[A].$forceUpdate();E&&(i.length=0,r!==null&&(clearTimeout(r),r=null),a!==null&&(clearTimeout(a),a=null))},c=Nn(function(E){t.resolved=ai(E,e),s?i.length=0:o(!0)}),f=Nn(function(E){k(t.errorComp)&&(t.error=!0,o(!0))}),g=t(c,f);return ve(g)&&(vi(g)?X(t.resolved)&&g.then(c,f):vi(g.component)&&(g.component.then(c,f),k(g.error)&&(t.errorComp=ai(g.error,e)),k(g.loading)&&(t.loadingComp=ai(g.loading,e),g.delay===0?t.loading=!0:r=setTimeout(function(){r=null,X(t.resolved)&&X(t.error)&&(t.loading=!0,o(!1))},g.delay||200)),k(g.timeout)&&(a=setTimeout(function(){a=null,X(t.resolved)&&f(null)},g.timeout)))),s=!1,t.loading?t.loadingComp:t.resolved}}function na(t){if(Y(t))for(var e=0;e<t.length;e++){var n=t[e];if(k(n)&&(k(n.componentOptions)||nn(n)))return n}}var gc=1,ia=2;function Fn(t,e,n,i,s,r){return(Y(n)||dn(n))&&(s=i,i=n,n=void 0),oe(r)&&(s=ia),mc(t,e,n,i,s)}function mc(t,e,n,i,s){if(k(n)&&k(n.__ob__)||(k(n)&&k(n.is)&&(e=n.is),!e))return mt();Y(i)&&ae(i[0])&&(n=n||{},n.scopedSlots={default:i[0]},i.length=0),s===ia?i=Yi(i):s===gc&&(i=Ql(i));var r,a;if(typeof e=="string"){var o=void 0;a=t.$vnode&&t.$vnode.ns||Ne.getTagNamespace(e),Ne.isReservedTag(e)?r=new Ie(Ne.parsePlatformTagName(e),n,i,void 0,void 0,t):(!n||!n.pre)&&k(o=Un(t.$options,"components",e))?r=Xs(o,n,t,i,e):r=new Ie(e,n,i,void 0,void 0,t)}else r=Xs(e,n,t,i);return Y(r)?r:k(r)?(k(a)&&sa(r,a),k(n)&&_c(n),r):mt()}function sa(t,e,n){if(t.ns=e,t.tag==="foreignObject"&&(e=void 0,n=!0),k(t.children))for(var i=0,s=t.children.length;i<s;i++){var r=t.children[i];k(r.tag)&&(X(r.ns)||oe(n)&&r.tag!=="svg")&&sa(r,e,n)}}function _c(t){ve(t.style)&&Dn(t.style),ve(t.class)&&Dn(t.class)}function Et(t,e,n){Ut();try{if(e)for(var i=e;i=i.$parent;){var s=i.$options.errorCaptured;if(s)for(var r=0;r<s.length;r++)try{var a=s[r].call(i,t,e,n)===!1;if(a)return}catch(o){Hs(o,i,"errorCaptured hook")}}Hs(t,e,n)}finally{Bt()}}function dt(t,e,n,i,s){var r;try{r=n?t.apply(e,n):t.call(e),r&&!r._isVue&&vi(r)&&!r._handled&&(r.catch(function(a){return Et(a,i,s+" (Promise/async)")}),r._handled=!0)}catch(a){Et(a,i,s)}return r}function Hs(t,e,n){if(Ne.errorHandler)try{return Ne.errorHandler.call(null,t,e,n)}catch(i){i!==t&&qs(i)}qs(t)}function qs(t,e,n){if(Me&&typeof console!="undefined")console.error(t);else throw t}var Ei=!1,Ai=[],xi=!1;function vn(){xi=!1;var t=Ai.slice(0);Ai.length=0;for(var e=0;e<t.length;e++)t[e]()}var Qt;if(typeof Promise!="undefined"&&Pt(Promise)){var vc=Promise.resolve();Qt=function(){vc.then(vn),Fl&&setTimeout(me)},Ei=!0}else if(!Ht&&typeof MutationObserver!="undefined"&&(Pt(MutationObserver)||MutationObserver.toString()==="[object MutationObserverConstructor]")){var yn=1,yc=new MutationObserver(vn),Us=document.createTextNode(String(yn));yc.observe(Us,{characterData:!0}),Qt=function(){yn=(yn+1)%2,Us.data=String(yn)},Ei=!0}else typeof setImmediate!="undefined"&&Pt(setImmediate)?Qt=function(){setImmediate(vn)}:Qt=function(){setTimeout(vn,0)};function Zi(t,e){var n;if(Ai.push(function(){if(t)try{t.call(e)}catch(i){Et(i,e,"nextTick")}else n&&n(e)}),xi||(xi=!0,Qt()),!t&&typeof Promise!="undefined")return new Promise(function(i){n=i})}var bc="2.7.14",Bs=new tn;function Dn(t){return On(t,Bs),Bs.clear(),t}function On(t,e){var n,i,s=Y(t);if(!(!s&&!ve(t)||t.__v_skip||Object.isFrozen(t)||t instanceof Ie)){if(t.__ob__){var r=t.__ob__.dep.id;if(e.has(r))return;e.add(r)}if(s)for(n=t.length;n--;)On(t[n],e);else if(ze(t))On(t.value,e);else for(i=Object.keys(t),n=i.length;n--;)On(t[i[n]],e)}}var Cc=0,es=function(){function t(e,n,i,s,r){Wl(this,Ae&&!Ae._vm?Ae:e?e._scope:void 0),(this.vm=e)&&r&&(e._watcher=this),s?(this.deep=!!s.deep,this.user=!!s.user,this.lazy=!!s.lazy,this.sync=!!s.sync,this.before=s.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++Cc,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new tn,this.newDepIds=new tn,this.expression="",ae(n)?this.getter=n:(this.getter=Pl(n),this.getter||(this.getter=me)),this.value=this.lazy?void 0:this.get()}return t.prototype.get=function(){Ut(this);var e,n=this.vm;try{e=this.getter.call(n,n)}catch(i){if(this.user)Et(i,n,'getter for watcher "'.concat(this.expression,'"'));else throw i}finally{this.deep&&Dn(e),Bt(),this.cleanupDeps()}return e},t.prototype.addDep=function(e){var n=e.id;this.newDepIds.has(n)||(this.newDepIds.add(n),this.newDeps.push(e),this.depIds.has(n)||e.addSub(this))},t.prototype.cleanupDeps=function(){for(var e=this.deps.length;e--;){var n=this.deps[e];this.newDepIds.has(n.id)||n.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},t.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Fc(this)},t.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||ve(e)||this.deep){var n=this.value;if(this.value=e,this.user){var i='callback for watcher "'.concat(this.expression,'"');dt(this.cb,this.vm,[e,n],this.vm,i)}else this.cb.call(this.vm,e,n)}}},t.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},t.prototype.depend=function(){for(var e=this.deps.length;e--;)this.deps[e].depend()},t.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&ht(this.vm._scope.effects,this),this.active){for(var e=this.deps.length;e--;)this.deps[e].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},t}();function wc(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&ra(t,e)}var sn;function Sc(t,e){sn.$on(t,e)}function Tc(t,e){sn.$off(t,e)}function Ec(t,e){var n=sn;return function i(){var s=e.apply(null,arguments);s!==null&&n.$off(t,i)}}function ra(t,e,n){sn=t,Vr(e,n||{},Sc,Tc,Ec,t),sn=void 0}function Ac(t){var e=/^hook:/;t.prototype.$on=function(n,i){var s=this;if(Y(n))for(var r=0,a=n.length;r<a;r++)s.$on(n[r],i);else(s._events[n]||(s._events[n]=[])).push(i),e.test(n)&&(s._hasHookEvent=!0);return s},t.prototype.$once=function(n,i){var s=this;function r(){s.$off(n,r),i.apply(s,arguments)}return r.fn=i,s.$on(n,r),s},t.prototype.$off=function(n,i){var s=this;if(!arguments.length)return s._events=Object.create(null),s;if(Y(n)){for(var r=0,a=n.length;r<a;r++)s.$off(n[r],i);return s}var o=s._events[n];if(!o)return s;if(!i)return s._events[n]=null,s;for(var c,f=o.length;f--;)if(c=o[f],c===i||c.fn===i){o.splice(f,1);break}return s},t.prototype.$emit=function(n){var i=this,s=i._events[n];if(s){s=s.length>1?yi(s):s;for(var r=yi(arguments,1),a='event handler for "'.concat(n,'"'),o=0,c=s.length;o<c;o++)dt(s[o],i,r,i,a)}return i}}var _t=null;function aa(t){var e=_t;return _t=t,function(){_t=e}}function xc(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){for(;n.$options.abstract&&n.$parent;)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._provided=n?n._provided:Object.create(null),t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function kc(t){t.prototype._update=function(e,n){var i=this,s=i.$el,r=i._vnode,a=aa(i);i._vnode=e,r?i.$el=i.__patch__(r,e):i.$el=i.__patch__(i.$el,e,n,!1),a(),s&&(s.__vue__=null),i.$el&&(i.$el.__vue__=i);for(var o=i;o&&o.$vnode&&o.$parent&&o.$vnode===o.$parent._vnode;)o.$parent.$el=o.$el,o=o.$parent},t.prototype.$forceUpdate=function(){var e=this;e._watcher&&e._watcher.update()},t.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){De(e,"beforeDestroy"),e._isBeingDestroyed=!0;var n=e.$parent;n&&!n._isBeingDestroyed&&!e.$options.abstract&&ht(n.$children,e),e._scope.stop(),e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),De(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}function Oc(t,e,n){t.$el=e,t.$options.render||(t.$options.render=mt),De(t,"beforeMount");var i;i=function(){t._update(t._render(),n)};var s={before:function(){t._isMounted&&!t._isDestroyed&&De(t,"beforeUpdate")}};new es(t,i,me,s,!0),n=!1;var r=t._preWatchers;if(r)for(var a=0;a<r.length;a++)r[a].run();return t.$vnode==null&&(t._isMounted=!0,De(t,"mounted")),t}function Ic(t,e,n,i,s){var r=i.data.scopedSlots,a=t.$scopedSlots,o=!!(r&&!r.$stable||a!==ke&&!a.$stable||r&&t.$scopedSlots.$key!==r.$key||!r&&t.$scopedSlots.$key),c=!!(s||t.$options._renderChildren||o),f=t.$vnode;t.$options._parentVnode=i,t.$vnode=i,t._vnode&&(t._vnode.parent=i),t.$options._renderChildren=s;var g=i.data.attrs||ke;t._attrsProxy&&$n(t._attrsProxy,g,f.data&&f.data.attrs||ke,t,"$attrs")&&(c=!0),t.$attrs=g,n=n||ke;var E=t.$options._parentListeners;if(t._listenersProxy&&$n(t._listenersProxy,n,E||ke,t,"$listeners"),t.$listeners=t.$options._parentListeners=n,ra(t,n,E),e&&t.$options.props){ut(!1);for(var A=t._props,N=t.$options._propKeys||[],$=0;$<N.length;$++){var b=N[$],_=t.$options.props;A[b]=as(b,_,e,t)}ut(!0),t.$options.propsData=e}c&&(t.$slots=Ki(s,i.context),t.$forceUpdate())}function oa(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function ts(t,e){if(e){if(t._directInactive=!1,oa(t))return}else if(t._directInactive)return;if(t._inactive||t._inactive===null){t._inactive=!1;for(var n=0;n<t.$children.length;n++)ts(t.$children[n]);De(t,"activated")}}function la(t,e){if(!(e&&(t._directInactive=!0,oa(t)))&&!t._inactive){t._inactive=!0;for(var n=0;n<t.$children.length;n++)la(t.$children[n]);De(t,"deactivated")}}function De(t,e,n,i){i===void 0&&(i=!0),Ut();var s=Yt;i&&lt(t);var r=t.$options[e],a="".concat(e," hook");if(r)for(var o=0,c=r.length;o<c;o++)dt(r[o],t,n||null,t,a);t._hasHookEvent&&t.$emit("hook:"+e),i&&lt(s),Bt()}var Qe=[],ns=[],Hn={},ki=!1,is=!1,Rt=0;function Mc(){Rt=Qe.length=ns.length=0,Hn={},ki=is=!1}var ca=0,Oi=Date.now;if(Me&&!Ht){var oi=window.performance;oi&&typeof oi.now=="function"&&Oi()>document.createEvent("Event").timeStamp&&(Oi=function(){return oi.now()})}var Rc=function(t,e){if(t.post){if(!e.post)return 1}else if(e.post)return-1;return t.id-e.id};function Nc(){ca=Oi(),is=!0;var t,e;for(Qe.sort(Rc),Rt=0;Rt<Qe.length;Rt++)t=Qe[Rt],t.before&&t.before(),e=t.id,Hn[e]=null,t.run();var n=ns.slice(),i=Qe.slice();Mc(),$c(n),Lc(i),Hl(),Ln&&Ne.devtools&&Ln.emit("flush")}function Lc(t){for(var e=t.length;e--;){var n=t[e],i=n.vm;i&&i._watcher===n&&i._isMounted&&!i._isDestroyed&&De(i,"updated")}}function Pc(t){t._inactive=!1,ns.push(t)}function $c(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,ts(t[e],!0)}function Fc(t){var e=t.id;if(Hn[e]==null&&!(t===ct.target&&t.noRecurse)){if(Hn[e]=!0,!is)Qe.push(t);else{for(var n=Qe.length-1;n>Rt&&Qe[n].id>t.id;)n--;Qe.splice(n+1,0,t)}ki||(ki=!0,Zi(Nc))}}function Dc(t){var e=t.$options.provide;if(e){var n=ae(e)?e.call(t):e;if(!ve(n))return;for(var i=jl(t),s=pn?Reflect.ownKeys(n):Object.keys(n),r=0;r<s.length;r++){var a=s[r];Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))}}}function Hc(t){var e=ua(t.$options.inject,t);e&&(ut(!1),Object.keys(e).forEach(function(n){Tt(t,n,e[n])}),ut(!0))}function ua(t,e){if(t){for(var n=Object.create(null),i=pn?Reflect.ownKeys(t):Object.keys(t),s=0;s<i.length;s++){var r=i[s];if(r!=="__ob__"){var a=t[r].from;if(a in e._provided)n[r]=e._provided[a];else if("default"in t[r]){var o=t[r].default;n[r]=ae(o)?o.call(e):o}}}return n}}function ss(t,e,n,i,s){var r=this,a=s.options,o;Ce(i,"_uid")?(o=Object.create(i),o._original=i):(o=i,i=i._original);var c=oe(a._compiled),f=!c;this.data=t,this.props=e,this.children=n,this.parent=i,this.listeners=t.on||ke,this.injections=ua(a.inject,i),this.slots=function(){return r.$slots||Kt(i,t.scopedSlots,r.$slots=Ki(n,i)),r.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Kt(i,t.scopedSlots,this.slots())}}),c&&(this.$options=a,this.$slots=this.slots(),this.$scopedSlots=Kt(i,t.scopedSlots,this.$slots)),a._scopeId?this._c=function(g,E,A,N){var $=Fn(o,g,E,A,N,f);return $&&!Y($)&&($.fnScopeId=a._scopeId,$.fnContext=i),$}:this._c=function(g,E,A,N){return Fn(o,g,E,A,N,f)}}ea(ss.prototype);function qc(t,e,n,i,s){var r=t.options,a={},o=r.props;if(k(o))for(var c in o)a[c]=as(c,o,e||ke);else k(n.attrs)&&Ws(a,n.attrs),k(n.props)&&Ws(a,n.props);var f=new ss(n,a,s,i,t),g=r.render.call(null,f._c,f);if(g instanceof Ie)return zs(g,n,f.parent,r);if(Y(g)){for(var E=Yi(g)||[],A=new Array(E.length),N=0;N<E.length;N++)A[N]=zs(E[N],n,f.parent,r);return A}}function zs(t,e,n,i,s){var r=Ci(t);return r.fnContext=n,r.fnOptions=i,e.slot&&((r.data||(r.data={})).slot=e.slot),r}function Ws(t,e){for(var n in e)t[wt(n)]=e[n]}function qn(t){return t.name||t.__name||t._componentTag}var rs={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;rs.prepatch(n,n)}else{var i=t.componentInstance=Uc(t,_t);i.$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var n=e.componentOptions,i=e.componentInstance=t.componentInstance;Ic(i,n.propsData,n.listeners,e,n.children)},insert:function(t){var e=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,De(n,"mounted")),t.data.keepAlive&&(e._isMounted?Pc(n):ts(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?la(e,!0):e.$destroy())}},js=Object.keys(rs);function Xs(t,e,n,i,s){if(!X(t)){var r=n.$options._base;if(ve(t)&&(t=r.extend(t)),typeof t=="function"){var a;if(X(t.cid)&&(a=t,t=pc(a,r),t===void 0))return fc(a,e,n,i,s);e=e||{},ls(t),k(e.model)&&Wc(t.options,e);var o=Xl(e,t);if(oe(t.options.functional))return qc(t,o,e,n,i);var c=e.on;if(e.on=e.nativeOn,oe(t.options.abstract)){var f=e.slot;e={},f&&(e.slot=f)}Bc(e);var g=qn(t.options)||s,E=new Ie("vue-component-".concat(t.cid).concat(g?"-".concat(g):""),e,void 0,void 0,void 0,n,{Ctor:t,propsData:o,listeners:c,tag:s,children:i},a);return E}}}function Uc(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},i=t.data.inlineTemplate;return k(i)&&(n.render=i.render,n.staticRenderFns=i.staticRenderFns),new t.componentOptions.Ctor(n)}function Bc(t){for(var e=t.hook||(t.hook={}),n=0;n<js.length;n++){var i=js[n],s=e[i],r=rs[i];s!==r&&!(s&&s._merged)&&(e[i]=s?zc(r,s):r)}}function zc(t,e){var n=function(i,s){t(i,s),e(i,s)};return n._merged=!0,n}function Wc(t,e){var n=t.model&&t.model.prop||"value",i=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var s=e.on||(e.on={}),r=s[i],a=e.model.callback;k(r)?(Y(r)?r.indexOf(a)===-1:r!==a)&&(s[i]=[a].concat(r)):s[i]=a}var jc=me,Ue=Ne.optionMergeStrategies;function rn(t,e,n){if(n===void 0&&(n=!0),!e)return t;for(var i,s,r,a=pn?Reflect.ownKeys(e):Object.keys(e),o=0;o<a.length;o++)i=a[o],i!=="__ob__"&&(s=t[i],r=e[i],!n||!Ce(t,i)?Ji(t,i,r):s!==r&&Oe(s)&&Oe(r)&&rn(s,r));return t}function Qs(t,e,n){return n?function(){var s=ae(e)?e.call(n,n):e,r=ae(t)?t.call(n,n):t;return s?rn(s,r):r}:e?t?function(){return rn(ae(e)?e.call(this,this):e,ae(t)?t.call(this,this):t)}:e:t}Ue.data=function(t,e,n){return n?Qs(t,e,n):e&&typeof e!="function"?t:Qs(t,e)};function Xc(t,e){var n=e?t?t.concat(e):Y(e)?e:[e]:t;return n&&Qc(n)}function Qc(t){for(var e=[],n=0;n<t.length;n++)e.indexOf(t[n])===-1&&e.push(t[n]);return e}Br.forEach(function(t){Ue[t]=Xc});function Gc(t,e,n,i){var s=Object.create(t||null);return e?re(s,e):s}Jn.forEach(function(t){Ue[t+"s"]=Gc});Ue.watch=function(t,e,n,i){if(t===bi&&(t=void 0),e===bi&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var s={};re(s,t);for(var r in e){var a=s[r],o=e[r];a&&!Y(a)&&(a=[a]),s[r]=a?a.concat(o):Y(o)?o:[o]}return s};Ue.props=Ue.methods=Ue.inject=Ue.computed=function(t,e,n,i){if(!t)return e;var s=Object.create(null);return re(s,t),e&&re(s,e),s};Ue.provide=function(t,e){return t?function(){var n=Object.create(null);return rn(n,ae(t)?t.call(this):t),e&&rn(n,ae(e)?e.call(this):e,!1),n}:e};var Jc=function(t,e){return e===void 0?t:e};function Vc(t,e){var n=t.props;if(!!n){var i={},s,r,a;if(Y(n))for(s=n.length;s--;)r=n[s],typeof r=="string"&&(a=wt(r),i[a]={type:null});else if(Oe(n))for(var o in n)r=n[o],a=wt(o),i[a]=Oe(r)?r:{type:r};t.props=i}}function Yc(t,e){var n=t.inject;if(!!n){var i=t.inject={};if(Y(n))for(var s=0;s<n.length;s++)i[n[s]]={from:n[s]};else if(Oe(n))for(var r in n){var a=n[r];i[r]=Oe(a)?re({from:r},a):{from:a}}}}function Kc(t){var e=t.directives;if(e)for(var n in e){var i=e[n];ae(i)&&(e[n]={bind:i,update:i})}}function At(t,e,n){if(ae(e)&&(e=e.options),Vc(e),Yc(e),Kc(e),!e._base&&(e.extends&&(t=At(t,e.extends,n)),e.mixins))for(var i=0,s=e.mixins.length;i<s;i++)t=At(t,e.mixins[i],n);var r={},a;for(a in t)o(a);for(a in e)Ce(t,a)||o(a);function o(c){var f=Ue[c]||Jc;r[c]=f(t[c],e[c],n,c)}return r}function Un(t,e,n,i){if(typeof n=="string"){var s=t[e];if(Ce(s,n))return s[n];var r=wt(n);if(Ce(s,r))return s[r];var a=kl(r);if(Ce(s,a))return s[a];var o=s[n]||s[r]||s[a];return o}}function as(t,e,n,i){var s=e[t],r=!Ce(n,t),a=n[t],o=Js(Boolean,s.type);if(o>-1){if(r&&!Ce(s,"default"))a=!1;else if(a===""||a===hn(t)){var c=Js(String,s.type);(c<0||o<c)&&(a=!0)}}if(a===void 0){a=Zc(i,s,t);var f=Gi;ut(!0),Je(a),ut(f)}return a}function Zc(t,e,n){if(!!Ce(e,"default")){var i=e.default;return t&&t.$options.propsData&&t.$options.propsData[n]===void 0&&t._props[n]!==void 0?t._props[n]:ae(i)&&Ii(e.type)!=="Function"?i.call(t):i}}var eu=/^\s*function (\w+)/;function Ii(t){var e=t&&t.toString().match(eu);return e?e[1]:""}function Gs(t,e){return Ii(t)===Ii(e)}function Js(t,e){if(!Y(e))return Gs(e,t)?0:-1;for(var n=0,i=e.length;n<i;n++)if(Gs(e[n],t))return n;return-1}var tt={enumerable:!0,configurable:!0,get:me,set:me};function os(t,e,n){tt.get=function(){return this[e][n]},tt.set=function(s){this[e][n]=s},Object.defineProperty(t,n,tt)}function tu(t){var e=t.$options;if(e.props&&nu(t,e.props),oc(t),e.methods&&ou(t,e.methods),e.data)iu(t);else{var n=Je(t._data={});n&&n.vmCount++}e.computed&&au(t,e.computed),e.watch&&e.watch!==bi&&lu(t,e.watch)}function nu(t,e){var n=t.$options.propsData||{},i=t._props=Jr({}),s=t.$options._propKeys=[],r=!t.$parent;r||ut(!1);var a=function(c){s.push(c);var f=as(c,e,n,t);Tt(i,c,f),c in t||os(t,"_props",c)};for(var o in e)a(o);ut(!0)}function iu(t){var e=t.$options.data;e=t._data=ae(e)?su(e,t):e||{},Oe(e)||(e={});var n=Object.keys(e),i=t.$options.props;t.$options.methods;for(var s=n.length;s--;){var r=n[s];i&&Ce(i,r)||zr(r)||os(t,"_data",r)}var a=Je(e);a&&a.vmCount++}function su(t,e){Ut();try{return t.call(e,e)}catch(n){return Et(n,e,"data()"),{}}finally{Bt()}}var ru={lazy:!0};function au(t,e){var n=t._computedWatchers=Object.create(null),i=fn();for(var s in e){var r=e[s],a=ae(r)?r:r.get;i||(n[s]=new es(t,a||me,me,ru)),s in t||da(t,s,r)}}function da(t,e,n){var i=!fn();ae(n)?(tt.get=i?Vs(e):Ys(n),tt.set=me):(tt.get=n.get?i&&n.cache!==!1?Vs(e):Ys(n.get):me,tt.set=n.set||me),Object.defineProperty(t,e,tt)}function Vs(t){return function(){var n=this._computedWatchers&&this._computedWatchers[t];if(n)return n.dirty&&n.evaluate(),ct.target&&n.depend(),n.value}}function Ys(t){return function(){return t.call(this,this)}}function ou(t,e){t.$options.props;for(var n in e)t[n]=typeof e[n]!="function"?me:Dr(e[n],t)}function lu(t,e){for(var n in e){var i=e[n];if(Y(i))for(var s=0;s<i.length;s++)Mi(t,n,i[s]);else Mi(t,n,i)}}function Mi(t,e,n,i){return Oe(n)&&(i=n,n=n.handler),typeof n=="string"&&(n=t[n]),t.$watch(e,n,i)}function cu(t){var e={};e.get=function(){return this._data};var n={};n.get=function(){return this._props},Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",n),t.prototype.$set=Ji,t.prototype.$delete=Qr,t.prototype.$watch=function(i,s,r){var a=this;if(Oe(s))return Mi(a,i,s,r);r=r||{},r.user=!0;var o=new es(a,i,s,r);if(r.immediate){var c='callback for immediate watcher "'.concat(o.expression,'"');Ut(),dt(s,a,[o.value],a,c),Bt()}return function(){o.teardown()}}}var uu=0;function du(t){t.prototype._init=function(e){var n=this;n._uid=uu++,n._isVue=!0,n.__v_skip=!0,n._scope=new zl(!0),n._scope._vm=!0,e&&e._isComponent?hu(n,e):n.$options=At(ls(n.constructor),e||{},n),n._renderProxy=n,n._self=n,xc(n),wc(n),dc(n),De(n,"beforeCreate",void 0,!1),Hc(n),tu(n),Dc(n),De(n,"created"),n.$options.el&&n.$mount(n.$options.el)}}function hu(t,e){var n=t.$options=Object.create(t.constructor.options),i=e._parentVnode;n.parent=e.parent,n._parentVnode=i;var s=i.componentOptions;n.propsData=s.propsData,n._parentListeners=s.listeners,n._renderChildren=s.children,n._componentTag=s.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}function ls(t){var e=t.options;if(t.super){var n=ls(t.super),i=t.superOptions;if(n!==i){t.superOptions=n;var s=fu(t);s&&re(t.extendOptions,s),e=t.options=At(n,t.extendOptions),e.name&&(e.components[e.name]=t)}}return e}function fu(t){var e,n=t.options,i=t.sealedOptions;for(var s in n)n[s]!==i[s]&&(e||(e={}),e[s]=n[s]);return e}function ee(t){this._init(t)}du(ee);cu(ee);Ac(ee);kc(ee);hc(ee);function pu(t){t.use=function(e){var n=this._installedPlugins||(this._installedPlugins=[]);if(n.indexOf(e)>-1)return this;var i=yi(arguments,1);return i.unshift(this),ae(e.install)?e.install.apply(e,i):ae(e)&&e.apply(null,i),n.push(e),this}}function gu(t){t.mixin=function(e){return this.options=At(this.options,e),this}}function mu(t){t.cid=0;var e=1;t.extend=function(n){n=n||{};var i=this,s=i.cid,r=n._Ctor||(n._Ctor={});if(r[s])return r[s];var a=qn(n)||qn(i.options),o=function(f){this._init(f)};return o.prototype=Object.create(i.prototype),o.prototype.constructor=o,o.cid=e++,o.options=At(i.options,n),o.super=i,o.options.props&&_u(o),o.options.computed&&vu(o),o.extend=i.extend,o.mixin=i.mixin,o.use=i.use,Jn.forEach(function(c){o[c]=i[c]}),a&&(o.options.components[a]=o),o.superOptions=i.options,o.extendOptions=n,o.sealedOptions=re({},o.options),r[s]=o,o}}function _u(t){var e=t.options.props;for(var n in e)os(t.prototype,"_props",n)}function vu(t){var e=t.options.computed;for(var n in e)da(t.prototype,n,e[n])}function yu(t){Jn.forEach(function(e){t[e]=function(n,i){return i?(e==="component"&&Oe(i)&&(i.name=i.name||n,i=this.options._base.extend(i)),e==="directive"&&ae(i)&&(i={bind:i,update:i}),this.options[e+"s"][n]=i,i):this.options[e+"s"][n]}})}function Ks(t){return t&&(qn(t.Ctor.options)||t.tag)}function bn(t,e){return Y(t)?t.indexOf(e)>-1:typeof t=="string"?t.split(",").indexOf(e)>-1:Sl(t)?t.test(e):!1}function Zs(t,e){var n=t.cache,i=t.keys,s=t._vnode;for(var r in n){var a=n[r];if(a){var o=a.name;o&&!e(o)&&Ri(n,r,i,s)}}}function Ri(t,e,n,i){var s=t[e];s&&(!i||s.tag!==i.tag)&&s.componentInstance.$destroy(),t[e]=null,ht(n,e)}var er=[String,RegExp,Array],bu={name:"keep-alive",abstract:!0,props:{include:er,exclude:er,max:[String,Number]},methods:{cacheVNode:function(){var t=this,e=t.cache,n=t.keys,i=t.vnodeToCache,s=t.keyToCache;if(i){var r=i.tag,a=i.componentInstance,o=i.componentOptions;e[s]={name:Ks(o),tag:r,componentInstance:a},n.push(s),this.max&&n.length>parseInt(this.max)&&Ri(e,n[0],n,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Ri(this.cache,t,this.keys)},mounted:function(){var t=this;this.cacheVNode(),this.$watch("include",function(e){Zs(t,function(n){return bn(e,n)})}),this.$watch("exclude",function(e){Zs(t,function(n){return!bn(e,n)})})},updated:function(){this.cacheVNode()},render:function(){var t=this.$slots.default,e=na(t),n=e&&e.componentOptions;if(n){var i=Ks(n),s=this,r=s.include,a=s.exclude;if(r&&(!i||!bn(r,i))||a&&i&&bn(a,i))return e;var o=this,c=o.cache,f=o.keys,g=e.key==null?n.Ctor.cid+(n.tag?"::".concat(n.tag):""):e.key;c[g]?(e.componentInstance=c[g].componentInstance,ht(f,g),f.push(g)):(this.vnodeToCache=e,this.keyToCache=g),e.data.keepAlive=!0}return e||t&&t[0]}},Cu={KeepAlive:bu};function wu(t){var e={};e.get=function(){return Ne},Object.defineProperty(t,"config",e),t.util={warn:jc,extend:re,mergeOptions:At,defineReactive:Tt},t.set=Ji,t.delete=Qr,t.nextTick=Zi,t.observable=function(n){return Je(n),n},t.options=Object.create(null),Jn.forEach(function(n){t.options[n+"s"]=Object.create(null)}),t.options._base=t,re(t.options.components,Cu),pu(t),gu(t),mu(t),yu(t)}wu(ee);Object.defineProperty(ee.prototype,"$isServer",{get:fn});Object.defineProperty(ee.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}});Object.defineProperty(ee,"FunctionalRenderContext",{value:ss});ee.version=bc;var Su=He("style,class"),Tu=He("input,textarea,option,select,progress"),Eu=function(t,e,n){return n==="value"&&Tu(t)&&e!=="button"||n==="selected"&&t==="option"||n==="checked"&&t==="input"||n==="muted"&&t==="video"},ha=He("contenteditable,draggable,spellcheck"),Au=He("events,caret,typing,plaintext-only"),xu=function(t,e){return Bn(e)||e==="false"?"false":t==="contenteditable"&&Au(e)?e:"true"},ku=He("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),Ni="http://www.w3.org/1999/xlink",cs=function(t){return t.charAt(5)===":"&&t.slice(0,5)==="xlink"},fa=function(t){return cs(t)?t.slice(6,t.length):""},Bn=function(t){return t==null||t===!1};function Ou(t){for(var e=t.data,n=t,i=t;k(i.componentInstance);)i=i.componentInstance._vnode,i&&i.data&&(e=tr(i.data,e));for(;k(n=n.parent);)n&&n.data&&(e=tr(e,n.data));return Iu(e.staticClass,e.class)}function tr(t,e){return{staticClass:us(t.staticClass,e.staticClass),class:k(t.class)?[t.class,e.class]:e.class}}function Iu(t,e){return k(t)||k(e)?us(t,ds(e)):""}function us(t,e){return t?e?t+" "+e:t:e||""}function ds(t){return Array.isArray(t)?Mu(t):ve(t)?Ru(t):typeof t=="string"?t:""}function Mu(t){for(var e="",n,i=0,s=t.length;i<s;i++)k(n=ds(t[i]))&&n!==""&&(e&&(e+=" "),e+=n);return e}function Ru(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}var Nu={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Lu=He("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),hs=He("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),pa=function(t){return Lu(t)||hs(t)};function Pu(t){if(hs(t))return"svg";if(t==="math")return"math"}var Cn=Object.create(null);function $u(t){if(!Me)return!0;if(pa(t))return!1;if(t=t.toLowerCase(),Cn[t]!=null)return Cn[t];var e=document.createElement(t);return t.indexOf("-")>-1?Cn[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Cn[t]=/HTMLUnknownElement/.test(e.toString())}var Li=He("text,number,password,search,email,tel,url");function Fu(t){if(typeof t=="string"){var e=document.querySelector(t);return e||document.createElement("div")}else return t}function Du(t,e){var n=document.createElement(t);return t!=="select"||e.data&&e.data.attrs&&e.data.attrs.multiple!==void 0&&n.setAttribute("multiple","multiple"),n}function Hu(t,e){return document.createElementNS(Nu[t],e)}function qu(t){return document.createTextNode(t)}function Uu(t){return document.createComment(t)}function Bu(t,e,n){t.insertBefore(e,n)}function zu(t,e){t.removeChild(e)}function Wu(t,e){t.appendChild(e)}function ju(t){return t.parentNode}function Xu(t){return t.nextSibling}function Qu(t){return t.tagName}function Gu(t,e){t.textContent=e}function Ju(t,e){t.setAttribute(e,"")}var Vu=Object.freeze({__proto__:null,createElement:Du,createElementNS:Hu,createTextNode:qu,createComment:Uu,insertBefore:Bu,removeChild:zu,appendChild:Wu,parentNode:ju,nextSibling:Xu,tagName:Qu,setTextContent:Gu,setStyleScope:Ju}),Yu={create:function(t,e){Nt(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Nt(t,!0),Nt(e))},destroy:function(t){Nt(t,!0)}};function Nt(t,e){var n=t.data.ref;if(!!k(n)){var i=t.context,s=t.componentInstance||t.elm,r=e?null:s,a=e?void 0:s;if(ae(n)){dt(n,i,[r],i,"template ref function");return}var o=t.data.refInFor,c=typeof n=="string"||typeof n=="number",f=ze(n),g=i.$refs;if(c||f){if(o){var E=c?g[n]:n.value;e?Y(E)&&ht(E,s):Y(E)?E.includes(s)||E.push(s):c?(g[n]=[s],nr(i,n,g[n])):n.value=[s]}else if(c){if(e&&g[n]!==s)return;g[n]=a,nr(i,n,r)}else if(f){if(e&&n.value!==s)return;n.value=r}}}}function nr(t,e,n){var i=t._setupState;i&&Ce(i,e)&&(ze(i[e])?i[e].value=n:i[e]=n)}var it=new Ie("",{},[]),jt=["create","activate","update","remove","destroy"];function ft(t,e){return t.key===e.key&&t.asyncFactory===e.asyncFactory&&(t.tag===e.tag&&t.isComment===e.isComment&&k(t.data)===k(e.data)&&Ku(t,e)||oe(t.isAsyncPlaceholder)&&X(e.asyncFactory.error))}function Ku(t,e){if(t.tag!=="input")return!0;var n,i=k(n=t.data)&&k(n=n.attrs)&&n.type,s=k(n=e.data)&&k(n=n.attrs)&&n.type;return i===s||Li(i)&&Li(s)}function Zu(t,e,n){var i,s,r={};for(i=e;i<=n;++i)s=t[i].key,k(s)&&(r[s]=i);return r}function ed(t){var e,n,i={},s=t.modules,r=t.nodeOps;for(e=0;e<jt.length;++e)for(i[jt[e]]=[],n=0;n<s.length;++n)k(s[n][jt[e]])&&i[jt[e]].push(s[n][jt[e]]);function a(C){return new Ie(r.tagName(C).toLowerCase(),{},[],void 0,C)}function o(C,w){function O(){--O.listeners===0&&c(C)}return O.listeners=w,O}function c(C){var w=r.parentNode(C);k(w)&&r.removeChild(w,C)}function f(C,w,O,F,q,B,z){if(k(C.elm)&&k(B)&&(C=B[z]=Ci(C)),C.isRootInsert=!q,!g(C,w,O,F)){var W=C.data,S=C.children,T=C.tag;k(T)?(C.elm=C.ns?r.createElementNS(C.ns,T):r.createElement(T,C),l(C),$(C,S,w),k(W)&&_(C,w),N(O,C.elm,F)):oe(C.isComment)?(C.elm=r.createComment(C.text),N(O,C.elm,F)):(C.elm=r.createTextNode(C.text),N(O,C.elm,F))}}function g(C,w,O,F){var q=C.data;if(k(q)){var B=k(C.componentInstance)&&q.keepAlive;if(k(q=q.hook)&&k(q=q.init)&&q(C,!1),k(C.componentInstance))return E(C,w),N(O,C.elm,F),oe(B)&&A(C,w,O,F),!0}}function E(C,w){k(C.data.pendingInsert)&&(w.push.apply(w,C.data.pendingInsert),C.data.pendingInsert=null),C.elm=C.componentInstance.$el,b(C)?(_(C,w),l(C)):(Nt(C),w.push(C))}function A(C,w,O,F){for(var q,B=C;B.componentInstance;)if(B=B.componentInstance._vnode,k(q=B.data)&&k(q=q.transition)){for(q=0;q<i.activate.length;++q)i.activate[q](it,B);w.push(B);break}N(O,C.elm,F)}function N(C,w,O){k(C)&&(k(O)?r.parentNode(O)===C&&r.insertBefore(C,w,O):r.appendChild(C,w))}function $(C,w,O){if(Y(w))for(var F=0;F<w.length;++F)f(w[F],O,C.elm,null,!0,w,F);else dn(C.text)&&r.appendChild(C.elm,r.createTextNode(String(C.text)))}function b(C){for(;C.componentInstance;)C=C.componentInstance._vnode;return k(C.tag)}function _(C,w){for(var O=0;O<i.create.length;++O)i.create[O](it,C);e=C.data.hook,k(e)&&(k(e.create)&&e.create(it,C),k(e.insert)&&w.push(C))}function l(C){var w;if(k(w=C.fnScopeId))r.setStyleScope(C.elm,w);else for(var O=C;O;)k(w=O.context)&&k(w=w.$options._scopeId)&&r.setStyleScope(C.elm,w),O=O.parent;k(w=_t)&&w!==C.context&&w!==C.fnContext&&k(w=w.$options._scopeId)&&r.setStyleScope(C.elm,w)}function u(C,w,O,F,q,B){for(;F<=q;++F)f(O[F],B,C,w,!1,O,F)}function m(C){var w,O,F=C.data;if(k(F))for(k(w=F.hook)&&k(w=w.destroy)&&w(C),w=0;w<i.destroy.length;++w)i.destroy[w](C);if(k(w=C.children))for(O=0;O<C.children.length;++O)m(C.children[O])}function p(C,w,O){for(;w<=O;++w){var F=C[w];k(F)&&(k(F.tag)?(v(F),m(F)):c(F.elm))}}function v(C,w){if(k(w)||k(C.data)){var O,F=i.remove.length+1;for(k(w)?w.listeners+=F:w=o(C.elm,F),k(O=C.componentInstance)&&k(O=O._vnode)&&k(O.data)&&v(O,w),O=0;O<i.remove.length;++O)i.remove[O](C,w);k(O=C.data.hook)&&k(O=O.remove)?O(C,w):w()}else c(C.elm)}function y(C,w,O,F,q){for(var B=0,z=0,W=w.length-1,S=w[0],T=w[W],I=O.length-1,P=O[0],U=O[I],H,Q,V,J,ce=!q;B<=W&&z<=I;)X(S)?S=w[++B]:X(T)?T=w[--W]:ft(S,P)?(M(S,P,F,O,z),S=w[++B],P=O[++z]):ft(T,U)?(M(T,U,F,O,I),T=w[--W],U=O[--I]):ft(S,U)?(M(S,U,F,O,I),ce&&r.insertBefore(C,S.elm,r.nextSibling(T.elm)),S=w[++B],U=O[--I]):ft(T,P)?(M(T,P,F,O,z),ce&&r.insertBefore(C,T.elm,S.elm),T=w[--W],P=O[++z]):(X(H)&&(H=Zu(w,B,W)),Q=k(P.key)?H[P.key]:x(P,w,B,W),X(Q)?f(P,F,C,S.elm,!1,O,z):(V=w[Q],ft(V,P)?(M(V,P,F,O,z),w[Q]=void 0,ce&&r.insertBefore(C,V.elm,S.elm)):f(P,F,C,S.elm,!1,O,z)),P=O[++z]);B>W?(J=X(O[I+1])?null:O[I+1].elm,u(C,J,O,z,I,F)):z>I&&p(w,B,W)}function x(C,w,O,F){for(var q=O;q<F;q++){var B=w[q];if(k(B)&&ft(C,B))return q}}function M(C,w,O,F,q,B){if(C!==w){k(w.elm)&&k(F)&&(w=F[q]=Ci(w));var z=w.elm=C.elm;if(oe(C.isAsyncPlaceholder)){k(w.asyncFactory.resolved)?D(C.elm,w,O):w.isAsyncPlaceholder=!0;return}if(oe(w.isStatic)&&oe(C.isStatic)&&w.key===C.key&&(oe(w.isCloned)||oe(w.isOnce))){w.componentInstance=C.componentInstance;return}var W,S=w.data;k(S)&&k(W=S.hook)&&k(W=W.prepatch)&&W(C,w);var T=C.children,I=w.children;if(k(S)&&b(w)){for(W=0;W<i.update.length;++W)i.update[W](C,w);k(W=S.hook)&&k(W=W.update)&&W(C,w)}X(w.text)?k(T)&&k(I)?T!==I&&y(z,T,I,O,B):k(I)?(k(C.text)&&r.setTextContent(z,""),u(z,null,I,0,I.length-1,O)):k(T)?p(T,0,T.length-1):k(C.text)&&r.setTextContent(z,""):C.text!==w.text&&r.setTextContent(z,w.text),k(S)&&k(W=S.hook)&&k(W=W.postpatch)&&W(C,w)}}function R(C,w,O){if(oe(O)&&k(C.parent))C.parent.data.pendingInsert=w;else for(var F=0;F<w.length;++F)w[F].data.hook.insert(w[F])}var L=He("attrs,class,staticClass,staticStyle,key");function D(C,w,O,F){var q,B=w.tag,z=w.data,W=w.children;if(F=F||z&&z.pre,w.elm=C,oe(w.isComment)&&k(w.asyncFactory))return w.isAsyncPlaceholder=!0,!0;if(k(z)&&(k(q=z.hook)&&k(q=q.init)&&q(w,!0),k(q=w.componentInstance)))return E(w,O),!0;if(k(B)){if(k(W))if(!C.hasChildNodes())$(w,W,O);else if(k(q=z)&&k(q=q.domProps)&&k(q=q.innerHTML)){if(q!==C.innerHTML)return!1}else{for(var S=!0,T=C.firstChild,I=0;I<W.length;I++){if(!T||!D(T,W[I],O,F)){S=!1;break}T=T.nextSibling}if(!S||T)return!1}if(k(z)){var P=!1;for(var U in z)if(!L(U)){P=!0,_(w,O);break}!P&&z.class&&Dn(z.class)}}else C.data!==w.text&&(C.data=w.text);return!0}return function(w,O,F,q){if(X(O)){k(w)&&m(w);return}var B=!1,z=[];if(X(w))B=!0,f(O,z);else{var W=k(w.nodeType);if(!W&&ft(w,O))M(w,O,z,null,null,q);else{if(W){if(w.nodeType===1&&w.hasAttribute(Is)&&(w.removeAttribute(Is),F=!0),oe(F)&&D(w,O,z))return R(O,z,!0),w;w=a(w)}var S=w.elm,T=r.parentNode(S);if(f(O,z,S._leaveCb?null:T,r.nextSibling(S)),k(O.parent))for(var I=O.parent,P=b(O);I;){for(var U=0;U<i.destroy.length;++U)i.destroy[U](I);if(I.elm=O.elm,P){for(var H=0;H<i.create.length;++H)i.create[H](it,I);var Q=I.data.hook.insert;if(Q.merged)for(var V=1;V<Q.fns.length;V++)Q.fns[V]()}else Nt(I);I=I.parent}k(T)?p([w],0,0):k(w.tag)&&m(w)}}return R(O,z,B),O.elm}}var td={create:li,update:li,destroy:function(e){li(e,it)}};function li(t,e){(t.data.directives||e.data.directives)&&nd(t,e)}function nd(t,e){var n=t===it,i=e===it,s=ir(t.data.directives,t.context),r=ir(e.data.directives,e.context),a=[],o=[],c,f,g;for(c in r)f=s[c],g=r[c],f?(g.oldValue=f.value,g.oldArg=f.arg,Xt(g,"update",e,t),g.def&&g.def.componentUpdated&&o.push(g)):(Xt(g,"bind",e,t),g.def&&g.def.inserted&&a.push(g));if(a.length){var E=function(){for(var A=0;A<a.length;A++)Xt(a[A],"inserted",e,t)};n?nt(e,"insert",E):E()}if(o.length&&nt(e,"postpatch",function(){for(var A=0;A<o.length;A++)Xt(o[A],"componentUpdated",e,t)}),!n)for(c in s)r[c]||Xt(s[c],"unbind",t,t,i)}var id=Object.create(null);function ir(t,e){var n=Object.create(null);if(!t)return n;var i,s;for(i=0;i<t.length;i++){if(s=t[i],s.modifiers||(s.modifiers=id),n[sd(s)]=s,e._setupState&&e._setupState.__sfc){var r=s.def||Un(e,"_setupState","v-"+s.name);typeof r=="function"?s.def={bind:r,update:r}:s.def=r}s.def=s.def||Un(e.$options,"directives",s.name)}return n}function sd(t){return t.rawName||"".concat(t.name,".").concat(Object.keys(t.modifiers||{}).join("."))}function Xt(t,e,n,i,s){var r=t.def&&t.def[e];if(r)try{r(n.elm,t,n,i,s)}catch(a){Et(a,n.context,"directive ".concat(t.name," ").concat(e," hook"))}}var rd=[Yu,td];function sr(t,e){var n=e.componentOptions;if(!(k(n)&&n.Ctor.options.inheritAttrs===!1)&&!(X(t.data.attrs)&&X(e.data.attrs))){var i,s,r,a=e.elm,o=t.data.attrs||{},c=e.data.attrs||{};(k(c.__ob__)||oe(c._v_attr_proxy))&&(c=e.data.attrs=re({},c));for(i in c)s=c[i],r=o[i],r!==s&&rr(a,i,s,e.data.pre);(Ht||Qi)&&c.value!==o.value&&rr(a,"value",c.value);for(i in o)X(c[i])&&(cs(i)?a.removeAttributeNS(Ni,fa(i)):ha(i)||a.removeAttribute(i))}}function rr(t,e,n,i){i||t.tagName.indexOf("-")>-1?ar(t,e,n):ku(e)?Bn(n)?t.removeAttribute(e):(n=e==="allowfullscreen"&&t.tagName==="EMBED"?"true":e,t.setAttribute(e,n)):ha(e)?t.setAttribute(e,xu(e,n)):cs(e)?Bn(n)?t.removeAttributeNS(Ni,fa(e)):t.setAttributeNS(Ni,e,n):ar(t,e,n)}function ar(t,e,n){if(Bn(n))t.removeAttribute(e);else{if(Ht&&!qt&&t.tagName==="TEXTAREA"&&e==="placeholder"&&n!==""&&!t.__ieph){var i=function(s){s.stopImmediatePropagation(),t.removeEventListener("input",i)};t.addEventListener("input",i),t.__ieph=!0}t.setAttribute(e,n)}}var ad={create:sr,update:sr};function or(t,e){var n=e.elm,i=e.data,s=t.data;if(!(X(i.staticClass)&&X(i.class)&&(X(s)||X(s.staticClass)&&X(s.class)))){var r=Ou(e),a=n._transitionClasses;k(a)&&(r=us(r,ds(a))),r!==n._prevClass&&(n.setAttribute("class",r),n._prevClass=r)}}var od={create:or,update:or},ci="__r",ui="__c";function ld(t){if(k(t[ci])){var e=Ht?"change":"input";t[e]=[].concat(t[ci],t[e]||[]),delete t[ci]}k(t[ui])&&(t.change=[].concat(t[ui],t.change||[]),delete t[ui])}var an;function cd(t,e,n){var i=an;return function s(){var r=e.apply(null,arguments);r!==null&&ga(t,s,n,i)}}var ud=Ei&&!(Ms&&Number(Ms[1])<=53);function dd(t,e,n,i){if(ud){var s=ca,r=e;e=r._wrapper=function(a){if(a.target===a.currentTarget||a.timeStamp>=s||a.timeStamp<=0||a.target.ownerDocument!==document)return r.apply(this,arguments)}}an.addEventListener(t,e,Wr?{capture:n,passive:i}:n)}function ga(t,e,n,i){(i||an).removeEventListener(t,e._wrapper||e,n)}function di(t,e){if(!(X(t.data.on)&&X(e.data.on))){var n=e.data.on||{},i=t.data.on||{};an=e.elm||t.elm,ld(n),Vr(n,i,dd,ga,cd,e.context),an=void 0}}var hd={create:di,update:di,destroy:function(t){return di(t,it)}},wn;function lr(t,e){if(!(X(t.data.domProps)&&X(e.data.domProps))){var n,i,s=e.elm,r=t.data.domProps||{},a=e.data.domProps||{};(k(a.__ob__)||oe(a._v_attr_proxy))&&(a=e.data.domProps=re({},a));for(n in r)n in a||(s[n]="");for(n in a){if(i=a[n],n==="textContent"||n==="innerHTML"){if(e.children&&(e.children.length=0),i===r[n])continue;s.childNodes.length===1&&s.removeChild(s.childNodes[0])}if(n==="value"&&s.tagName!=="PROGRESS"){s._value=i;var o=X(i)?"":String(i);fd(s,o)&&(s.value=o)}else if(n==="innerHTML"&&hs(s.tagName)&&X(s.innerHTML)){wn=wn||document.createElement("div"),wn.innerHTML="<svg>".concat(i,"</svg>");for(var c=wn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;c.firstChild;)s.appendChild(c.firstChild)}else if(i!==r[n])try{s[n]=i}catch(f){}}}}function fd(t,e){return!t.composing&&(t.tagName==="OPTION"||pd(t,e)||gd(t,e))}function pd(t,e){var n=!0;try{n=document.activeElement!==t}catch(i){}return n&&t.value!==e}function gd(t,e){var n=t.value,i=t._vModifiers;if(k(i)){if(i.number)return en(n)!==en(e);if(i.trim)return n.trim()!==e.trim()}return n!==e}var md={create:lr,update:lr},_d=Ot(function(t){var e={},n=/;(?![^(]*\))/g,i=/:(.+)/;return t.split(n).forEach(function(s){if(s){var r=s.split(i);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e});function hi(t){var e=ma(t.style);return t.staticStyle?re(t.staticStyle,e):e}function ma(t){return Array.isArray(t)?Hr(t):typeof t=="string"?_d(t):t}function vd(t,e){var n={},i;if(e)for(var s=t;s.componentInstance;)s=s.componentInstance._vnode,s&&s.data&&(i=hi(s.data))&&re(n,i);(i=hi(t.data))&&re(n,i);for(var r=t;r=r.parent;)r.data&&(i=hi(r.data))&&re(n,i);return n}var yd=/^--/,cr=/\s*!important$/,ur=function(t,e,n){if(yd.test(e))t.style.setProperty(e,n);else if(cr.test(n))t.style.setProperty(hn(e),n.replace(cr,""),"important");else{var i=bd(e);if(Array.isArray(n))for(var s=0,r=n.length;s<r;s++)t.style[i]=n[s];else t.style[i]=n}},dr=["Webkit","Moz","ms"],Sn,bd=Ot(function(t){if(Sn=Sn||document.createElement("div").style,t=wt(t),t!=="filter"&&t in Sn)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<dr.length;n++){var i=dr[n]+e;if(i in Sn)return i}});function hr(t,e){var n=e.data,i=t.data;if(!(X(n.staticStyle)&&X(n.style)&&X(i.staticStyle)&&X(i.style))){var s,r,a=e.elm,o=i.staticStyle,c=i.normalizedStyle||i.style||{},f=o||c,g=ma(e.data.style)||{};e.data.normalizedStyle=k(g.__ob__)?re({},g):g;var E=vd(e,!0);for(r in f)X(E[r])&&ur(a,r,"");for(r in E)s=E[r],s!==f[r]&&ur(a,r,s==null?"":s)}}var Cd={create:hr,update:hr},_a=/\s+/;function va(t,e){if(!(!e||!(e=e.trim())))if(t.classList)e.indexOf(" ")>-1?e.split(_a).forEach(function(i){return t.classList.add(i)}):t.classList.add(e);else{var n=" ".concat(t.getAttribute("class")||""," ");n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function ya(t,e){if(!(!e||!(e=e.trim())))if(t.classList)e.indexOf(" ")>-1?e.split(_a).forEach(function(s){return t.classList.remove(s)}):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var n=" ".concat(t.getAttribute("class")||""," "),i=" "+e+" ";n.indexOf(i)>=0;)n=n.replace(i," ");n=n.trim(),n?t.setAttribute("class",n):t.removeAttribute("class")}}function ba(t){if(!!t){if(typeof t=="object"){var e={};return t.css!==!1&&re(e,fr(t.name||"v")),re(e,t),e}else if(typeof t=="string")return fr(t)}}var fr=Ot(function(t){return{enterClass:"".concat(t,"-enter"),enterToClass:"".concat(t,"-enter-to"),enterActiveClass:"".concat(t,"-enter-active"),leaveClass:"".concat(t,"-leave"),leaveToClass:"".concat(t,"-leave-to"),leaveActiveClass:"".concat(t,"-leave-active")}}),Ca=Me&&!qt,It="transition",fi="animation",In="transition",zn="transitionend",Pi="animation",wa="animationend";Ca&&(window.ontransitionend===void 0&&window.onwebkittransitionend!==void 0&&(In="WebkitTransition",zn="webkitTransitionEnd"),window.onanimationend===void 0&&window.onwebkitanimationend!==void 0&&(Pi="WebkitAnimation",wa="webkitAnimationEnd"));var pr=Me?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Sa(t){pr(function(){pr(t)})}function vt(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),va(t,e))}function Ge(t,e){t._transitionClasses&&ht(t._transitionClasses,e),ya(t,e)}function Ta(t,e,n){var i=Ea(t,e),s=i.type,r=i.timeout,a=i.propCount;if(!s)return n();var o=s===It?zn:wa,c=0,f=function(){t.removeEventListener(o,g),n()},g=function(E){E.target===t&&++c>=a&&f()};setTimeout(function(){c<a&&f()},r+1),t.addEventListener(o,g)}var wd=/\b(transform|all)(,|$)/;function Ea(t,e){var n=window.getComputedStyle(t),i=(n[In+"Delay"]||"").split(", "),s=(n[In+"Duration"]||"").split(", "),r=gr(i,s),a=(n[Pi+"Delay"]||"").split(", "),o=(n[Pi+"Duration"]||"").split(", "),c=gr(a,o),f,g=0,E=0;e===It?r>0&&(f=It,g=r,E=s.length):e===fi?c>0&&(f=fi,g=c,E=o.length):(g=Math.max(r,c),f=g>0?r>c?It:fi:null,E=f?f===It?s.length:o.length:0);var A=f===It&&wd.test(n[In+"Property"]);return{type:f,timeout:g,propCount:E,hasTransform:A}}function gr(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(n,i){return mr(n)+mr(t[i])}))}function mr(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function $i(t,e){var n=t.elm;k(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var i=ba(t.data.transition);if(!X(i)&&!(k(n._enterCb)||n.nodeType!==1)){for(var s=i.css,r=i.type,a=i.enterClass,o=i.enterToClass,c=i.enterActiveClass,f=i.appearClass,g=i.appearToClass,E=i.appearActiveClass,A=i.beforeEnter,N=i.enter,$=i.afterEnter,b=i.enterCancelled,_=i.beforeAppear,l=i.appear,u=i.afterAppear,m=i.appearCancelled,p=i.duration,v=_t,y=_t.$vnode;y&&y.parent;)v=y.context,y=y.parent;var x=!v._isMounted||!t.isRootInsert;if(!(x&&!l&&l!=="")){var M=x&&f?f:a,R=x&&E?E:c,L=x&&g?g:o,D=x&&_||A,C=x&&ae(l)?l:N,w=x&&u||$,O=x&&m||b,F=en(ve(p)?p.enter:p),q=s!==!1&&!qt,B=fs(C),z=n._enterCb=Nn(function(){q&&(Ge(n,L),Ge(n,R)),z.cancelled?(q&&Ge(n,M),O&&O(n)):w&&w(n),n._enterCb=null});t.data.show||nt(t,"insert",function(){var W=n.parentNode,S=W&&W._pending&&W._pending[t.key];S&&S.tag===t.tag&&S.elm._leaveCb&&S.elm._leaveCb(),C&&C(n,z)}),D&&D(n),q&&(vt(n,M),vt(n,R),Sa(function(){Ge(n,M),z.cancelled||(vt(n,L),B||(xa(F)?setTimeout(z,F):Ta(n,r,z)))})),t.data.show&&(e&&e(),C&&C(n,z)),!q&&!B&&z()}}}function Aa(t,e){var n=t.elm;k(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var i=ba(t.data.transition);if(X(i)||n.nodeType!==1)return e();if(k(n._leaveCb))return;var s=i.css,r=i.type,a=i.leaveClass,o=i.leaveToClass,c=i.leaveActiveClass,f=i.beforeLeave,g=i.leave,E=i.afterLeave,A=i.leaveCancelled,N=i.delayLeave,$=i.duration,b=s!==!1&&!qt,_=fs(g),l=en(ve($)?$.leave:$),u=n._leaveCb=Nn(function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[t.key]=null),b&&(Ge(n,o),Ge(n,c)),u.cancelled?(b&&Ge(n,a),A&&A(n)):(e(),E&&E(n)),n._leaveCb=null});N?N(m):m();function m(){u.cancelled||(!t.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[t.key]=t),f&&f(n),b&&(vt(n,a),vt(n,c),Sa(function(){Ge(n,a),u.cancelled||(vt(n,o),_||(xa(l)?setTimeout(u,l):Ta(n,r,u)))})),g&&g(n,u),!b&&!_&&u())}}function xa(t){return typeof t=="number"&&!isNaN(t)}function fs(t){if(X(t))return!1;var e=t.fns;return k(e)?fs(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function _r(t,e){e.data.show!==!0&&$i(e)}var Sd=Me?{create:_r,activate:_r,remove:function(t,e){t.data.show!==!0?Aa(t,e):e()}}:{},Td=[ad,od,hd,md,Cd,Sd],Ed=Td.concat(rd),Ad=ed({nodeOps:Vu,modules:Ed});qt&&document.addEventListener("selectionchange",function(){var t=document.activeElement;t&&t.vmodel&&ps(t,"input")});var ka={inserted:function(t,e,n,i){n.tag==="select"?(i.elm&&!i.elm._vOptions?nt(n,"postpatch",function(){ka.componentUpdated(t,e,n)}):vr(t,e,n.context),t._vOptions=[].map.call(t.options,Wn)):(n.tag==="textarea"||Li(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",xd),t.addEventListener("compositionend",Cr),t.addEventListener("change",Cr),qt&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if(n.tag==="select"){vr(t,e,n.context);var i=t._vOptions,s=t._vOptions=[].map.call(t.options,Wn);if(s.some(function(a,o){return!St(a,i[o])})){var r=t.multiple?e.value.some(function(a){return br(a,s)}):e.value!==e.oldValue&&br(e.value,s);r&&ps(t,"change")}}}};function vr(t,e,n){yr(t,e),(Ht||Qi)&&setTimeout(function(){yr(t,e)},0)}function yr(t,e,n){var i=e.value,s=t.multiple;if(!(s&&!Array.isArray(i))){for(var r,a,o=0,c=t.options.length;o<c;o++)if(a=t.options[o],s)r=Ur(i,Wn(a))>-1,a.selected!==r&&(a.selected=r);else if(St(Wn(a),i)){t.selectedIndex!==o&&(t.selectedIndex=o);return}s||(t.selectedIndex=-1)}}function br(t,e){return e.every(function(n){return!St(n,t)})}function Wn(t){return"_value"in t?t._value:t.value}function xd(t){t.target.composing=!0}function Cr(t){!t.target.composing||(t.target.composing=!1,ps(t.target,"input"))}function ps(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function Fi(t){return t.componentInstance&&(!t.data||!t.data.transition)?Fi(t.componentInstance._vnode):t}var kd={bind:function(t,e,n){var i=e.value;n=Fi(n);var s=n.data&&n.data.transition,r=t.__vOriginalDisplay=t.style.display==="none"?"":t.style.display;i&&s?(n.data.show=!0,$i(n,function(){t.style.display=r})):t.style.display=i?r:"none"},update:function(t,e,n){var i=e.value,s=e.oldValue;if(!i!=!s){n=Fi(n);var r=n.data&&n.data.transition;r?(n.data.show=!0,i?$i(n,function(){t.style.display=t.__vOriginalDisplay}):Aa(n,function(){t.style.display="none"})):t.style.display=i?t.__vOriginalDisplay:"none"}},unbind:function(t,e,n,i,s){s||(t.style.display=t.__vOriginalDisplay)}},Od={model:ka,show:kd},Oa={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Di(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Di(na(e.children)):t}function Ia(t){var e={},n=t.$options;for(var i in n.propsData)e[i]=t[i];var s=n._parentListeners;for(var i in s)e[wt(i)]=s[i];return e}function wr(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function Id(t){for(;t=t.parent;)if(t.data.transition)return!0}function Md(t,e){return e.key===t.key&&e.tag===t.tag}var Rd=function(t){return t.tag||nn(t)},Nd=function(t){return t.name==="show"},Ld={name:"transition",props:Oa,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(!!n&&(n=n.filter(Rd),!!n.length)){var i=this.mode,s=n[0];if(Id(this.$vnode))return s;var r=Di(s);if(!r)return s;if(this._leaving)return wr(t,s);var a="__transition-".concat(this._uid,"-");r.key=r.key==null?r.isComment?a+"comment":a+r.tag:dn(r.key)?String(r.key).indexOf(a)===0?r.key:a+r.key:r.key;var o=(r.data||(r.data={})).transition=Ia(this),c=this._vnode,f=Di(c);if(r.data.directives&&r.data.directives.some(Nd)&&(r.data.show=!0),f&&f.data&&!Md(r,f)&&!nn(f)&&!(f.componentInstance&&f.componentInstance._vnode.isComment)){var g=f.data.transition=re({},o);if(i==="out-in")return this._leaving=!0,nt(g,"afterLeave",function(){e._leaving=!1,e.$forceUpdate()}),wr(t,s);if(i==="in-out"){if(nn(r))return c;var E,A=function(){E()};nt(o,"afterEnter",A),nt(o,"enterCancelled",A),nt(g,"delayLeave",function(N){E=N})}}return s}}},Ma=re({tag:String,moveClass:String},Oa);delete Ma.mode;var Pd={props:Ma,beforeMount:function(){var t=this,e=this._update;this._update=function(n,i){var s=aa(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,s(),e.call(t,n,i)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),i=this.prevChildren=this.children,s=this.$slots.default||[],r=this.children=[],a=Ia(this),o=0;o<s.length;o++){var c=s[o];c.tag&&c.key!=null&&String(c.key).indexOf("__vlist")!==0&&(r.push(c),n[c.key]=c,(c.data||(c.data={})).transition=a)}if(i){for(var f=[],g=[],o=0;o<i.length;o++){var c=i[o];c.data.transition=a,c.data.pos=c.elm.getBoundingClientRect(),n[c.key]?f.push(c):g.push(c)}this.kept=t(e,null,f),this.removed=g}return t(e,null,r)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";!t.length||!this.hasMove(t[0].elm,e)||(t.forEach($d),t.forEach(Fd),t.forEach(Dd),this._reflow=document.body.offsetHeight,t.forEach(function(n){if(n.data.moved){var i=n.elm,s=i.style;vt(i,e),s.transform=s.WebkitTransform=s.transitionDuration="",i.addEventListener(zn,i._moveCb=function r(a){a&&a.target!==i||(!a||/transform$/.test(a.propertyName))&&(i.removeEventListener(zn,r),i._moveCb=null,Ge(i,e))})}}))},methods:{hasMove:function(t,e){if(!Ca)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach(function(s){ya(n,s)}),va(n,e),n.style.display="none",this.$el.appendChild(n);var i=Ea(n);return this.$el.removeChild(n),this._hasMove=i.hasTransform}}};function $d(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function Fd(t){t.data.newPos=t.elm.getBoundingClientRect()}function Dd(t){var e=t.data.pos,n=t.data.newPos,i=e.left-n.left,s=e.top-n.top;if(i||s){t.data.moved=!0;var r=t.elm.style;r.transform=r.WebkitTransform="translate(".concat(i,"px,").concat(s,"px)"),r.transitionDuration="0s"}}var Hd={Transition:Ld,TransitionGroup:Pd};ee.config.mustUseProp=Eu;ee.config.isReservedTag=pa;ee.config.isReservedAttr=Su;ee.config.getTagNamespace=Pu;ee.config.isUnknownElement=$u;re(ee.options.directives,Od);re(ee.options.components,Hd);ee.prototype.__patch__=Me?Ad:me;ee.prototype.$mount=function(t,e){return t=t&&Me?Fu(t):void 0,Oc(this,t,e)};Me&&setTimeout(function(){Ne.devtools&&Ln&&Ln.emit("init",ee)},0);var Te={exports:{}};/**
 * vuex v2.1.2
 * (c) 2017 Evan You
 * @license MIT
 */(function(t,e){(function(n,i){t.exports=i()})(xt,function(){var n=typeof window!="undefined"&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function i(S){!n||(S._devtoolHook=n,n.emit("vuex:init",S),n.on("vuex:travel-to-state",function(T){S.replaceState(T)}),S.subscribe(function(T,I){n.emit("vuex:mutation",T,I)}))}var s=function(S){var T=Number(S.version.split(".")[0]);if(T>=2){var I=S.config._lifecycleHooks.indexOf("init")>-1;S.mixin(I?{init:U}:{beforeCreate:U})}else{var P=S.prototype._init;S.prototype._init=function(H){H===void 0&&(H={}),H.init=H.init?[U].concat(H.init):U,P.call(this,H)}}function U(){var H=this.$options;H.store?this.$store=H.store:H.parent&&H.parent.$store&&(this.$store=H.parent.$store)}},r=g(function(S,T){var I={};return f(T).forEach(function(P){var U=P.key,H=P.val;I[U]=function(){var V=this.$store.state,J=this.$store.getters;if(S){var ce=E(this.$store,"mapState",S);if(!ce)return;V=ce.context.state,J=ce.context.getters}return typeof H=="function"?H.call(this,V,J):V[H]}}),I}),a=g(function(S,T){var I={};return f(T).forEach(function(P){var U=P.key,H=P.val;H=S+H,I[U]=function(){for(var V=[],J=arguments.length;J--;)V[J]=arguments[J];if(!(S&&!E(this.$store,"mapMutations",S)))return this.$store.commit.apply(this.$store,[H].concat(V))}}),I}),o=g(function(S,T){var I={};return f(T).forEach(function(P){var U=P.key,H=P.val;H=S+H,I[U]=function(){if(!(S&&!E(this.$store,"mapGetters",S))){if(!(H in this.$store.getters)){console.error("[vuex] unknown getter: "+H);return}return this.$store.getters[H]}}}),I}),c=g(function(S,T){var I={};return f(T).forEach(function(P){var U=P.key,H=P.val;H=S+H,I[U]=function(){for(var V=[],J=arguments.length;J--;)V[J]=arguments[J];if(!(S&&!E(this.$store,"mapActions",S)))return this.$store.dispatch.apply(this.$store,[H].concat(V))}}),I});function f(S){return Array.isArray(S)?S.map(function(T){return{key:T,val:T}}):Object.keys(S).map(function(T){return{key:T,val:S[T]}})}function g(S){return function(T,I){return typeof T!="string"?(I=T,T=""):T.charAt(T.length-1)!=="/"&&(T+="/"),S(T,I)}}function E(S,T,I){var P=S._modulesNamespaceMap[I];return P||console.error("[vuex] module namespace not found in "+T+"(): "+I),P}function A(S,T){Object.keys(S).forEach(function(I){return T(S[I],I)})}function N(S){return S!==null&&typeof S=="object"}function $(S){return S&&typeof S.then=="function"}function b(S,T){if(!S)throw new Error("[vuex] "+T)}var _=function(T,I){this.runtime=I,this._children=Object.create(null),this._rawModule=T},l={state:{},namespaced:{}};l.state.get=function(){return this._rawModule.state||{}},l.namespaced.get=function(){return!!this._rawModule.namespaced},_.prototype.addChild=function(T,I){this._children[T]=I},_.prototype.removeChild=function(T){delete this._children[T]},_.prototype.getChild=function(T){return this._children[T]},_.prototype.update=function(T){this._rawModule.namespaced=T.namespaced,T.actions&&(this._rawModule.actions=T.actions),T.mutations&&(this._rawModule.mutations=T.mutations),T.getters&&(this._rawModule.getters=T.getters)},_.prototype.forEachChild=function(T){A(this._children,T)},_.prototype.forEachGetter=function(T){this._rawModule.getters&&A(this._rawModule.getters,T)},_.prototype.forEachAction=function(T){this._rawModule.actions&&A(this._rawModule.actions,T)},_.prototype.forEachMutation=function(T){this._rawModule.mutations&&A(this._rawModule.mutations,T)},Object.defineProperties(_.prototype,l);var u=function(T){var I=this;this.root=new _(T,!1),T.modules&&A(T.modules,function(P,U){I.register([U],P,!1)})};u.prototype.get=function(T){return T.reduce(function(I,P){return I.getChild(P)},this.root)},u.prototype.getNamespace=function(T){var I=this.root;return T.reduce(function(P,U){return I=I.getChild(U),P+(I.namespaced?U+"/":"")},"")},u.prototype.update=function(T){m(this.root,T)},u.prototype.register=function(T,I,P){var U=this;P===void 0&&(P=!0);var H=this.get(T.slice(0,-1)),Q=new _(I,P);H.addChild(T[T.length-1],Q),I.modules&&A(I.modules,function(V,J){U.register(T.concat(J),V,P)})},u.prototype.unregister=function(T){var I=this.get(T.slice(0,-1)),P=T[T.length-1];!I.getChild(P).runtime||I.removeChild(P)};function m(S,T){if(S.update(T),T.modules)for(var I in T.modules){if(!S.getChild(I)){console.warn("[vuex] trying to add a new module '"+I+"' on hot reloading, manual reload is needed");return}m(S.getChild(I),T.modules[I])}}var p,v=function(T){var I=this;T===void 0&&(T={}),b(p,"must call Vue.use(Vuex) before creating a store instance."),b(typeof Promise!="undefined","vuex requires a Promise polyfill in this browser.");var P=T.state;P===void 0&&(P={});var U=T.plugins;U===void 0&&(U=[]);var H=T.strict;H===void 0&&(H=!1),this._committing=!1,this._actions=Object.create(null),this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new u(T),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new p;var Q=this,V=this,J=V.dispatch,ce=V.commit;this.dispatch=function(se,Pe){return J.call(Q,se,Pe)},this.commit=function(se,Pe,qo){return ce.call(Q,se,Pe,qo)},this.strict=H,R(this,P,[],this._modules.root),M(this,P),U.concat(i).forEach(function(de){return de(I)})},y={state:{}};y.state.get=function(){return this._vm.$data.state},y.state.set=function(S){b(!1,"Use store.replaceState() to explicit replace store state.")},v.prototype.commit=function(T,I,P){var U=this,H=B(T,I,P),Q=H.type,V=H.payload,J=H.options,ce={type:Q,payload:V},de=this._mutations[Q];if(!de){console.error("[vuex] unknown mutation type: "+Q);return}this._withCommit(function(){de.forEach(function(Pe){Pe(V)})}),this._subscribers.forEach(function(se){return se(ce,U.state)}),J&&J.silent&&console.warn("[vuex] mutation type: "+Q+". Silent option has been removed. Use the filter functionality in the vue-devtools")},v.prototype.dispatch=function(T,I){var P=B(T,I),U=P.type,H=P.payload,Q=this._actions[U];if(!Q){console.error("[vuex] unknown action type: "+U);return}return Q.length>1?Promise.all(Q.map(function(V){return V(H)})):Q[0](H)},v.prototype.subscribe=function(T){var I=this._subscribers;return I.indexOf(T)<0&&I.push(T),function(){var P=I.indexOf(T);P>-1&&I.splice(P,1)}},v.prototype.watch=function(T,I,P){var U=this;return b(typeof T=="function","store.watch only accepts a function."),this._watcherVM.$watch(function(){return T(U.state,U.getters)},I,P)},v.prototype.replaceState=function(T){var I=this;this._withCommit(function(){I._vm.state=T})},v.prototype.registerModule=function(T,I){typeof T=="string"&&(T=[T]),b(Array.isArray(T),"module path must be a string or an Array."),this._modules.register(T,I),R(this,this.state,T,this._modules.get(T)),M(this,this.state)},v.prototype.unregisterModule=function(T){var I=this;typeof T=="string"&&(T=[T]),b(Array.isArray(T),"module path must be a string or an Array."),this._modules.unregister(T),this._withCommit(function(){var P=q(I.state,T.slice(0,-1));p.delete(P,T[T.length-1])}),x(this)},v.prototype.hotUpdate=function(T){this._modules.update(T),x(this,!0)},v.prototype._withCommit=function(T){var I=this._committing;this._committing=!0,T(),this._committing=I},Object.defineProperties(v.prototype,y);function x(S,T){S._actions=Object.create(null),S._mutations=Object.create(null),S._wrappedGetters=Object.create(null),S._modulesNamespaceMap=Object.create(null);var I=S.state;R(S,I,[],S._modules.root,!0),M(S,I,T)}function M(S,T,I){var P=S._vm;S.getters={};var U=S._wrappedGetters,H={};A(U,function(V,J){H[J]=function(){return V(S)},Object.defineProperty(S.getters,J,{get:function(){return S._vm[J]},enumerable:!0})});var Q=p.config.silent;p.config.silent=!0,S._vm=new p({data:{state:T},computed:H}),p.config.silent=Q,S.strict&&F(S),P&&(I&&S._withCommit(function(){P.state=null}),p.nextTick(function(){return P.$destroy()}))}function R(S,T,I,P,U){var H=!I.length,Q=S._modules.getNamespace(I);if(Q&&(S._modulesNamespaceMap[Q]=P),!H&&!U){var V=q(T,I.slice(0,-1)),J=I[I.length-1];S._withCommit(function(){p.set(V,J,P.state)})}var ce=P.context=L(S,Q,I);P.forEachMutation(function(de,se){var Pe=Q+se;C(S,Pe,de,ce)}),P.forEachAction(function(de,se){var Pe=Q+se;w(S,Pe,de,ce)}),P.forEachGetter(function(de,se){var Pe=Q+se;O(S,Pe,de,ce)}),P.forEachChild(function(de,se){R(S,T,I.concat(se),de,U)})}function L(S,T,I){var P=T==="",U={dispatch:P?S.dispatch:function(H,Q,V){var J=B(H,Q,V),ce=J.payload,de=J.options,se=J.type;if((!de||!de.root)&&(se=T+se,!S._actions[se])){console.error("[vuex] unknown local action type: "+J.type+", window type: "+se);return}return S.dispatch(se,ce)},commit:P?S.commit:function(H,Q,V){var J=B(H,Q,V),ce=J.payload,de=J.options,se=J.type;if((!de||!de.root)&&(se=T+se,!S._mutations[se])){console.error("[vuex] unknown local mutation type: "+J.type+", window type: "+se);return}S.commit(se,ce,de)}};return Object.defineProperties(U,{getters:{get:P?function(){return S.getters}:function(){return D(S,T)}},state:{get:function(){return q(S.state,I)}}}),U}function D(S,T){var I={},P=T.length;return Object.keys(S.getters).forEach(function(U){if(U.slice(0,P)===T){var H=U.slice(P);Object.defineProperty(I,H,{get:function(){return S.getters[U]},enumerable:!0})}}),I}function C(S,T,I,P){var U=S._mutations[T]||(S._mutations[T]=[]);U.push(function(Q){I(P.state,Q)})}function w(S,T,I,P){var U=S._actions[T]||(S._actions[T]=[]);U.push(function(Q,V){var J=I({dispatch:P.dispatch,commit:P.commit,getters:P.getters,state:P.state,rootGetters:S.getters,rootState:S.state},Q,V);return $(J)||(J=Promise.resolve(J)),S._devtoolHook?J.catch(function(ce){throw S._devtoolHook.emit("vuex:error",ce),ce}):J})}function O(S,T,I,P){if(S._wrappedGetters[T]){console.error("[vuex] duplicate getter key: "+T);return}S._wrappedGetters[T]=function(H){return I(P.state,P.getters,H.state,H.getters)}}function F(S){S._vm.$watch("state",function(){b(S._committing,"Do not mutate vuex store state outside mutation handlers.")},{deep:!0,sync:!0})}function q(S,T){return T.length?T.reduce(function(I,P){return I[P]},S):S}function B(S,T,I){return N(S)&&S.type&&(I=T,T=S,S=S.type),b(typeof S=="string","Expects string as the type, but found "+typeof S+"."),{type:S,payload:T,options:I}}function z(S){if(p){console.error("[vuex] already installed. Vue.use(Vuex) should be called only once.");return}p=S,s(p)}typeof window!="undefined"&&window.Vue&&z(window.Vue);var W={Store:v,install:z,version:"2.1.2",mapState:r,mapMutations:a,mapGetters:o,mapActions:c};return W})})(Te);const Vn=Te.exports;var qd={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(xt,function(){function n(o,c){return o.filter(c)[0]}function i(o,c){if(c===void 0&&(c=[]),o===null||typeof o!="object")return o;var f=n(c,function(E){return E.original===o});if(f)return f.copy;var g=Array.isArray(o)?[]:{};return c.push({original:o,copy:g}),Object.keys(o).forEach(function(E){g[E]=i(o[E],c)}),g}function s(o){o===void 0&&(o={});var c=o.collapsed;c===void 0&&(c=!0);var f=o.transformer;f===void 0&&(f=function(E){return E});var g=o.mutationTransformer;return g===void 0&&(g=function(E){return E}),function(E){var A=i(E.state);E.subscribe(function(N,$){if(typeof console!="undefined"){var b=i($),_=new Date,l=" @ "+a(_.getHours(),2)+":"+a(_.getMinutes(),2)+":"+a(_.getSeconds(),2)+"."+a(_.getMilliseconds(),3),u=g(N),m="mutation "+N.type+l,p=c?console.groupCollapsed:console.group;try{p.call(console,m)}catch(v){console.log(m)}console.log("%c prev state","color: #9E9E9E; font-weight: bold",f(A)),console.log("%c mutation","color: #03A9F4; font-weight: bold",u),console.log("%c next state","color: #4CAF50; font-weight: bold",f(b));try{console.groupEnd()}catch(v){console.log("\u2014\u2014 log end \u2014\u2014")}A=b}})}}function r(o,c){return new Array(c+1).join(o)}function a(o,c){return r("0",c-o.toString().length)+o}return s})})(qd);const Ve="DISPLAY_COLLAPSE",Fe="DISPLAY_EXPAND",Gt="DISPLAY_EXPAND_FULL",Ra="CHAT_CONTEXT_NONE",Na="CHAT_CONTEXT_LIVE_AGENT",Ud="CHAT_CONTEXT_CHATBOT",Yn="CHAT_CONTEXT_ASYNC",We="WORKFLOW_DISABLED",La="WORKFLOW_BLOCKED",Ee="WORKFLOW_NOT_STARTED",Hi="WORKFLOW_COMPLETE_PROFILE_BEFORE_TO_START",Le="WORKFLOW_QUEUE",_e="WORKFLOW_CHAT",on="WORKFLOW_RATING",$e="WORKFLOW_TRANSCRIPT",yt="WORKFLOW_TRANSCRIPT_SENT",Bd=25,zd=t=>t.messages,Wd=t=>t.message,jd=t=>t.asyncWelcomeBackMsg,Xd=t=>t.quickReplyAnswers,Qd=t=>t.isTyping,Gd=t=>t.disconnected,Jd=t=>t.messages.filter(e=>!e.read).length,Vd=t=>t.vueMessage,Yd=t=>t.vueWait,Kd=t=>t.vueProfile,Zd=t=>t.vueRating,eh=t=>t.vueUpload,th=t=>t.vueSendTranscript,nh=t=>t.vueRegister,ih=t=>t.stateContactReasonOnly,sh=t=>t.stateContactReasonWithRegister,rh=t=>t.stateContactReasonSubmitted,ah=t=>t.contactReason,oh=t=>t.summarizeOnHandover,lh=t=>t.vueAsyncContinue,ch=t=>t.display,uh=t=>t.profile,dh=t=>t.profileError,hh=t=>t.request,fh=t=>t.list,ph=t=>t.orderedList,gh=t=>JSON.stringify(t.profile)!==JSON.stringify(t.profileTmp),mh=t=>t.config,_h=t=>t.rating,vh=t=>t.transcriptSent,yh=t=>t.feedbackSent,bh=t=>t.hide,Ch=t=>t.close,wh=t=>t.whoClosed,Sh=t=>t.settings,Th=t=>t.profileTmp,Eh=t=>t.workflow,Ah=t=>t.waitingQueueSize,xh=t=>t.displayWaitContactFormButton,kh=t=>t.apiError,Oh=t=>t.toConfirmHandover,Ih=t=>t.confirmedHandover,Mh=t=>t.toRegisterHandover,Rh=t=>t.registeredHandover,Nh=t=>t.chatbotContext,Lh=t=>t.asyncChatSessionClosed,Ph=t=>t.chatContext,$h=t=>t.request.asyncEnabled||t.asyncValidatedResumeChatToken,Fh=t=>t.isAsyncAllowed,Dh=t=>t.chatContext===Yn,Hh=t=>t.chatContext===Yn?t.settings.virtual_agent_xid:t.xmppSession.operatorXid,qh=t=>t.request.status===Bd,Uh=t=>t.chatContext!==Ud&&t.chatContext!==Ra&&t.settings.async_chat_enabled&&!t.settings.is_chat_open&&!t.xmppSession.operatorXid&&t.messageSentAfterReconnect&&t.profile.email===""&&t.profile.phone==="",Bh=t=>!(t.stateContactReasonOnly||t.stateContactReasonWithRegister||t.vueRating||t.vueWait||t.vueRegister||t.vueAsyncContinue||t.vueSendTranscript&&t.transcriptSent||t.workflow===We||t.workflow===yt||t.display===Ve),zh=Object.freeze(Object.defineProperty({__proto__:null,messages:zd,message:Wd,asyncWelcomeBackMsg:jd,quickReplyAnswers:Xd,isTyping:Qd,disconnected:Gd,messagesUnread:Jd,vueMessage:Vd,vueWait:Yd,vueProfile:Kd,vueRating:Zd,vueUpload:eh,vueSendTranscript:th,vueRegister:nh,stateContactReasonOnly:ih,stateContactReasonWithRegister:sh,stateContactReasonSubmitted:rh,contactReason:ah,summarizeOnHandover:oh,vueAsyncContinue:lh,display:ch,profile:uh,profileError:dh,request:hh,list:fh,orderedList:ph,isEditingProfile:gh,config:mh,rating:_h,transcriptSent:vh,feedbackSent:yh,hide:bh,close:Ch,whoClosed:wh,settings:Sh,profileTmp:Th,workflow:Eh,waitingQueueSize:Ah,displayWaitContactFormButton:xh,apiError:kh,toConfirmHandover:Oh,confirmedHandover:Ih,toRegisterHandover:Mh,registeredHandover:Rh,chatbotContext:Nh,asyncChatSessionClosed:Lh,chatContext:Ph,isCurrentChatAsync:$h,isAsyncAllowed:Fh,isChattingWithVirtualAgent:Dh,currentOperatorXid:Hh,requestIsStandby:qh,askFillProfile:Uh,canUpdateProfile:Bh},Symbol.toStringTag,{value:"Module"})),Pa="RECEIVE_MESSAGE",$a="SEND_MESSAGE",Fa="SEND_ATTACHMENT",Da="START_TYPING",Ha="STOP_TYPING",qa="DISCONNECTED",Ua="RECONNECTED",gs="MARK_HAS_READ",Ba="MARK_HAS_RECEIPT",za="RECEIPT_MESSAGE_UNREAD_DISABLE",qi="UPDATE_MESSAGE",Wa="UPDATE_QUICK_REPLY_ANSWERS",Ye="UPDATE_VIEW",Ke="UPDATE_DISPLAY",zt="END_CHAT",jn="REVERT_PROFILE_TMP",Ze="UPDATE_PROFILE_TMP",Wh="UPDATE_PROFILE_FORM",ms="UPDATE_PROFILE",Kn="UPDATE_REQUEST_DATA",ja="UPDATE_CHATBOT_CONTEXT",Xa="UPDATE_CHATBOT_LAST_ACTIVITY",Qa="UPDATE_PROFILE_ID",Ga="UPDATE_PROFILE_PHONE",_s="UPDATE_PROFILE_ERROR",Ja="UPDATE_TRANSCRIPT",jh="UPDATE_COMMUNICATOR",Xh="UPDATE_CALLEO_CHAT",Ui="UPDATE_PUSH_SEND_PRESENCE_TIMESTAMP",Va="API_SUCCESS",Ya="UPDATE_LIST",Ka="UPDATE_ORDERED_LIST",Za="UPDATE_XMPP_SESSION",eo="UPDATE_CONFIG",to="UPDATE_SETTINGS",Jt="UPDATE_RATING",no="SHOW",io="HIDE",we="UPDATE_WORKFLOW",vs="SET_DISABLED_WORKFLOW",Qh="RESET_CHAT",so="RESET_MESSAGES",Zn="UPDATE_FIRST_MESSAGE",ro="UPDATE_WAITING_QUEUE_SIZE",ao="DISPLAY_WAIT_CONTACT_FORM_BUTTON",ys="API_ERROR",ei="TO_CONFIRM_HANDOVER",oo="CONFIRMED_HANDOVER",ti="TO_REGISTER_HANDOVER",lo="REGISTERED_HANDOVER",Xn="ASYNC_VALIDATED_RESUME_CHAT_TOKEN",co="ASYNC_WELCOME_BACK_MESSAGE",uo="ASYNC_SESSION_CLOSED",ni="UPDATE_CHAT_CONTEXT",bs="ASYNC_CHAT_STANDBY_OR_WAKEUP",Bi="ASYNC_UPDATE_TESTED_TOKEN",ho="ASYNC_UPDATE_IS_ALLOWED",fo="UPDATE_CONTACT_REASON",ii="UPDATE_CONTACT_REASON_STATE",po="UPDATE_SUMMARIZE_ON_HANDOVER",Gh="none",Jh="end",Vh="handover",Mn={NONE:Gh,END:Jh,HANDOVER:Vh},Yh="no_chatbot",Kh="chatbot_only",Zh="chatbot_handover",ie={NO_CHATBOT:Yh,CHATBOT_ONLY:Kh,CHATBOT_HANDOVER:Zh},ef="agent",tf="chatbot",ln={AGENT:ef,CHATBOT:tf},nf="othertab",sf="finished_chat",rf="invalid_token",af="livechat_closed",of="livechat_nothing_online",bt={OPEN_IN_OTHER_TAB:nf,IS_FINISHED:sf,BAD_TOKEN:rf,CLOSED:af,NOTHING_ONLINE:of};let K={app_version:"30",frontBaseUrl:"https://www.contact.nespresso.com",defaultOperatorAvatarPath:"/assets/operators/avatar/default.png",livechatController:"contact/index",url:{api:"https://www.contact.nespresso.com",livechat:"https://www.contact.nespresso.com/livechat",bosh:"https://www.contact.nespresso.com/http-bind/"},apiSettings:{sendError:!1,app_version:"30",setting_version:"build",opening_hours:{},next_open_datetime:null,timezone:0,customer_percent:100,chatbot_enabled:!0,chatbot_enabled_rating_form:!1,chatbot_allow_anonymous:!1,chatbot_percent_language:100,chatbot_timeout:-1,chatbot_id:null,chatbot_simulate_first_message_enabled:!1,chatbot_simulate_first_message:"",chatbot_ask_summarize_on_handover:!1,time_format:24,nb_no_break_chars:21,enabled:!0,is_chat_open:!0,enabled_reactive:!0,enabled_upload:!0,moderator_in_room:1,allow_anonymous:!1,only_on_response:!1,enabled_receipts:!1,exclude_url:[],notification_api_mode:"ifNotVisible",blink_title_new_message:!0,sounds:{new_message:{sound:"notification",mode:"ifNotVisibleChat"}},allowedHostPatterns:["*"],bannedWords:[],contact_form_display_after_waiting_time:300,contact_form_url:"",async_chat_enabled:!1,async_chat_start:{},async_chat_continue:{},ask_for_contact_reason:!1,debug_quota_information:{enabled:!1,is_reached:!1,load_percent:0,number_of_slots:0,online_users_ids:[],requests_ass:0,requests_tbh:0,setting:0}},excludedFromLiveChat:!1,excludedFromChatbot:!1,excludedFromEmbed:!1,livechatHost:"livechat.contact.nespresso.com",defaultStorage:"chatRequest",storagePrefix:"virtua_livechat",conversationalWindowSettings:{enabled:!1,feedbackBlockEnabled:!1,feedbackBlockUrl:null,excludedUrls:[],blocksData:[]}};var go={exports:{}};(function(t){(function(e,n,i){t.exports?(t.exports=i(),t.exports.default=t.exports):window[n]=i()})(xt,"b64toBlob",function(){return function(n,i,s){i=i||"",s=s||512;for(var r=atob(n),a=[],o=0;o<r.length;o+=s){for(var c=r.slice(o,o+s),f=new Array(c.length),g=0;g<c.length;g++)f[g]=c.charCodeAt(g);var E=new Uint8Array(f);a.push(E)}var A=new Blob(a,{type:i});return A}})})(go);const lf=go.exports;var mo={exports:{}};(function(t,e){(function(n,i){i()})(xt,function(){function n(f,g){return typeof g=="undefined"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function i(f,g,E){var A=new XMLHttpRequest;A.open("GET",f),A.responseType="blob",A.onload=function(){c(A.response,g,E)},A.onerror=function(){console.error("could not download file")},A.send()}function s(f){var g=new XMLHttpRequest;g.open("HEAD",f,!1);try{g.send()}catch(E){}return 200<=g.status&&299>=g.status}function r(f){try{f.dispatchEvent(new MouseEvent("click"))}catch(E){var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(g)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof window=="object"&&window.global===window?window:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(f,g,E){var A=a.URL||a.webkitURL,N=document.createElement("a");g=g||f.name||"download",N.download=g,N.rel="noopener",typeof f=="string"?(N.href=f,N.origin===location.origin?r(N):s(N.href)?i(f,g,E):r(N,N.target="_blank")):(N.href=A.createObjectURL(f),setTimeout(function(){A.revokeObjectURL(N.href)},4e4),setTimeout(function(){r(N)},0))}:"msSaveOrOpenBlob"in navigator?function(f,g,E){if(g=g||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(n(f,E),g);else if(s(f))i(f,g,E);else{var A=document.createElement("a");A.href=f,A.target="_blank",setTimeout(function(){r(A)})}}:function(f,g,E,A){if(A=A||open("","_blank"),A&&(A.document.title=A.document.body.innerText="downloading..."),typeof f=="string")return i(f,g,E);var N=f.type==="application/octet-stream",$=/constructor/i.test(a.HTMLElement)||a.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||N&&$||o)&&typeof FileReader!="undefined"){var _=new FileReader;_.onloadend=function(){var m=_.result;m=b?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),A?A.location.href=m:location=m,A=null},_.readAsDataURL(f)}else{var l=a.URL||a.webkitURL,u=l.createObjectURL(f);A?A.location=u:location.href=u,A=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});a.saveAs=c.saveAs=c,t.exports=c})})(mo);const cf=mo.exports,_o=(t,e)=>{if(t.error==="profile_form_incorrect"){const n=[];return new Map(Object.entries(t.error_details)).forEach((s,r)=>{if(s){const a=Object.values(s);a.length&&n.push({field:r,error:a[0]})}}),n.length&&e(_s,n),!0}return!1},uf=t=>{const e=le.get("livechat.async_chat.welcome_open"),n=Number(t.request.queueSize),i=n*Number(t.settings.avg_waiting_time||0);let s="";return i<60?s=i+" "+le.get("livechat.seconds"):i<120?s="1:"+String(i%60).padStart(2,"0")+" "+le.get("livechat.minute"):s=Math.floor(i/60)+":"+String(i%60).padStart(2,"0")+" "+le.get("livechat.minutes"),e.replace("{$$customer$$}",String(n)).replace("{$$time$$}",s)},df=({commit:t,dispatch:e,state:n,getters:i},s)=>{i.requestIsStandby&&G.wakeUpAsyncChatServerSide({requestId:n.request.id},r=>{r.isWakeUp?t(bs,r):(Z.finishChat(),t(we,$e),e("showTranscript"))},()=>{Z.finishChat(),t(we,$e),e("showTranscript")}),e("sendMessageAction",s)},hf=({commit:t,dispatch:e,state:n},i)=>{let s=!1;typeof i!="string"&&(s=!0);const r=s?JSON.stringify(i):i,a=s?i.title:i,o=Z.sendMessage(r);t($a,{message:a,id:o}),n.workflow===Ee&&t(Zn,a),G.dispatcher.emit("store.message-sent")},ff=({commit:t,state:e},n)=>{const{name:i,location:s}=n,r=Z.sendAttachment(i,s);t(Fa,{payload:n,id:r}),G.dispatcher.emit("store.message-sent")},pf=({commit:t,dispatch:e,state:n},i)=>{n.workflow===Le&&(n.confirmedHandover||t(so),t(Kn,{rqTakeAt:new Date().getTime()})),t(Pa,i),n.workflow===Le&&(n.firstMessage&&!n.confirmedHandover&&(e("sendMessage",n.firstMessage),t(Zn,"")),G.dispatcher.emit("start",n.request.id,n.request.liveTriggerId,n.request.source,n.request.liveTriggerStartMode),t(we,_e),Z.sendChatState("active"),Z.sendDatalayer(),e("showMessage")),(!i.rel||i.rel!=="welcome"&&i.rel!=="register")&&Ft.messageReceived(i),G.dispatcher.emit("store.message-received")},gf=({commit:t},e)=>{t(Ba,e.getAttribute("id")),G.dispatcher.emit("store.message-receipt-received")},mf=({commit:t},e)=>{t(Da,e)},_f=({commit:t})=>{t(Ha)},vf=({commit:t},e)=>{Ft.setChatState(e),Z.sendChatState(e)},yf=({commit:t},e)=>{Z.sendPageState(e)},bf=({dispatch:t},e)=>{t("receiveMessage",{message:`${le.get("livechat.chat_transferred_to")} <strong>${e.name}</strong>`,operator:{},read:!0,rel:"system"})},Cf=({state:t,dispatch:e})=>{(t.workflow===Le||t.workflow===_e)&&(t.xmppSession.jid?Z.restoreChat(t):Z.startChat(t)),t.workflow!==Ee&&Ft.requestPermission(),e("apiErrorFinish")},wf=({commit:t})=>{t(qa)},Sf=({commit:t})=>{window.setTimeout(()=>{Z.sendDatalayer()},2e3),t(Ua)},Tf=({commit:t,state:e,dispatch:n})=>{if(e.workflow!==yt){if(t(ms),e.workflow===Ee||e.workflow===Hi){e.chatbotContext===ie.CHATBOT_ONLY?t(we,Le):n("showWait"),n("start");return}G.sendAction(e.request.id,"update-profile",e.profile,i=>{t(_s,null),t(Qa,i.profile_id),i.profile_phone&&t(Ga,i.profile_phone),t(jn),Z.updateProfile(),e.workflow!==We&&(e.workflow===Ee||e.workflow===Le||e.workflow===Hi?n("goInQueue"):e.workflow===_e?e.confirmedHandover&&e.chatbotContext!==ie.CHATBOT_HANDOVER?n("startHandoverOnAgent"):n("showMessage"):e.workflow===on?n("showTranscript"):e.workflow===$e&&(n("sendTranscript"),n("showTranscript"),G.dispatcher.emit("transcript-sent-from-anonymous",e.request.id,e.request.liveTriggerId,e.request.source,e.request.liveTriggerStartMode)))},i=>{try{const s=JSON.parse(i.response);if(n("showProfile"),_o(s,t))return;n("apiError",i.response)}catch(s){n("apiError",s)}})}},Ef=({commit:t},e)=>{t(Za,e),Z.sendDatalayer()},Af=({commit:t},e)=>{t(Kn,e)},xf=({commit:t},e)=>{t(ja,e)},kf=({state:t,commit:e,dispatch:n},i)=>{const s=Object.keys(t.xmppSession.operatorsInQueue||{}).length;Z.sendFinishChat("cancel"),Z.finishChat(),e(Ke,Ve),e(we,Ee),t.request.id&&!t.close&&(G.dispatcher.emit("cancel",t.request.id,t.request.liveTriggerId,t.request.source,t.request.liveTriggerStartMode),G.sendAction(t.request.id,"end",Re(ue({},i),{profileId:t.profile.id,jsAction:"cancel",lastMessage:t.messages.slice(-10),nbOperatorsInQueue:s}),()=>{},()=>{console.warn("Error on close chat")})),e(zt),Se.restoreDefaultState(),Se.getIsEnableNewChat()||(n("disable"),n("hide"))},Of=({commit:t,state:e,dispatch:n},i)=>{const s=Object.keys(e.xmppSession.operatorsInQueue||{}).length;t(gs),t(we,on),n("showTranscript"),G.dispatcher.emit("end",e.request.id,e.request.liveTriggerId,e.request.source,e.request.liveTriggerStartMode),i.blockUser&&(G.dispatcher.emit("livechat.bann-user"),G.dispatcher.emit("user-banned",e.request.id,e.request.liveTriggerId,e.request.source,e.request.liveTriggerStartMode)),G.sendAction(e.request.id,"end",Re(ue({},i),{profileId:e.profile.id,jsAction:"close",lastMessage:e.messages.slice(-10),nbOperatorsInQueue:s}),r=>{!i.blockUser&&r.end_source==="op_ban"&&(G.dispatcher.emit("livechat.bann-user"),G.dispatcher.emit("user-banned",e.request.id,e.request.liveTriggerId,e.request.source,e.request.liveTriggerStartMode))},()=>{console.warn("Error on close chat")}),t(zt,{source:i.source}),i.source!=="operator"&&Z.sendFinishChat(i.source),Z.finishChat()},If=({state:t},e)=>{let n=document.querySelector("#announce-area");n||(n=document.createElement("div"),n.id="announce-area",n.style.height="0px",n.style.overflow="hidden",n.ariaLive="assertive",document.querySelector("body").append(n)),n.innerHTML="<p>"+e.message+"</p>"},Mf=({state:t})=>{G.dispatcher.emit("rating",t.request.id,t.request.liveTriggerId,Object.assign({},t.rating),t.request.source,t.request.liveTriggerStartMode),G.sendAction(t.request.id,"rating",{rating:t.rating},()=>{},()=>{})},Rf=({state:t,commit:e})=>{G.sendAction(t.request.id,"send-transcript",null,n=>e(Ja,n),()=>{}),G.dispatcher.emit("transcript-sent",t.request.id,t.request.liveTriggerId,t.request.source,t.request.liveTriggerStartMode),e(we,yt)},Nf=({state:t},e)=>{G.sendAction(t.request.id,"download-attachment",{attachment:e.location},n=>{n.data&&n.type&&cf(lf(n.data,n.type),e.name)},()=>{}),G.dispatcher.emit("download-attachment",t.request.id,e)},Lf=({dispatch:t,state:e})=>{e.request.liveTriggerStartMode===ln.CHATBOT?t("updateChatbotContext",ie.CHATBOT_ONLY):e.request.liveTriggerStartMode===ln.AGENT&&(t("updateChatbotContext",ie.NO_CHATBOT),e.settings.moderator_in_room===0&&t("disable")),t("show"),t("expandChat")},Pf=({dispatch:t})=>{t("showWait"),t("start")},$f=({state:t,commit:e,dispatch:n})=>{if(t.workflow===Ee){if(te.load(),n("updateProfileFromDatalayer"),t.asyncValidatedResumeChatToken&&!t.asyncChatSessionClosed)n("goInQueue");else if(t.messages.length===0){const i=t.chatbotContext===ie.NO_CHATBOT?t.settings.allow_anonymous:t.settings.chatbot_allow_anonymous;if(!Se.getIsEnableNewChat())n("displayDisabledMessage");else if(t.settings.ask_for_contact_reason&&!t.stateContactReasonSubmitted)i||te.isLoggedIn&&te.email&&te.firstName&&te.lastName?n("showContactReasonFormOnly"):n("showContactReasonFormWithRegister"),n("showRegister");else if(i||te.isLoggedIn&&te.email&&te.firstName&&te.lastName)if((t.settings.chatbot_enabled||t.chatbotContext===ie.CHATBOT_ONLY||t.request.liveTriggerStartMode===ln.CHATBOT)&&G.dispatcher.emit("chatbot.ready"),!t.settings.chatbot_simulate_first_message_enabled&&(t.settings.only_on_response||t.chatbotContext===ie.CHATBOT_ONLY||t.request.liveTriggerStartMode===ln.CHATBOT)){const s=t.settings.chatbot_enabled?"chatbot.welcome_default":"livechat.welcome_default";n("receiveMessage",{message:le.get(s),operator:{},read:!0,rel:"welcome"})}else t.chatbotContext,ie.CHATBOT_ONLY,n("goInQueue");else n("showRegister"),t.settings.allow_anonymous&&t.settings.ask_for_contact_reason&&n("receiveMessage",{message:le.get("livechat.registration_welcome"),operator:{},read:!0,rel:"register"})}Ft.requestPermission()}e(Ke,Fe)},Ff=({commit:t})=>{t(Ke,Gt)},Df=({state:t,commit:e})=>{(t.workflow===Ee||t.workflow===We)&&e(io)},Hf=({state:t,commit:e})=>{if(t.workflow!==We){const n=Object.keys(t.xmppSession.operatorsInQueue||{}).length,i=t.display;Z.sendFinishChat("disable"),Z.finishChat(),t.request.id&&!t.close&&(G.dispatcher.emit("cancel",t.request.id,t.request.liveTriggerId,t.request.source,t.request.liveTriggerStartMode),G.sendAction(t.request.id,"end",{source:"disable",profileId:t.profile.id,jsAction:"disable",lastMessage:t.messages.slice(-10),nbOperatorsInQueue:n},()=>{},()=>{})),e(zt),Se.restoreDefaultState(),e(Ke,i)}},qf=({commit:t})=>{t(no)},Uf=({state:t,commit:e,dispatch:n,store:i})=>{if(!t.request.id){const s=te.isLoggedIn?"loggedin":t.profile.email?"prospect":"ano_prospect",r=K.apiSettings.chatbot_enabled&&t.request.liveTriggerStartMode!==ln.AGENT&&!t.asyncValidatedResumeChatToken;G.start({request:{source:t.request.source,faq_id:t.request.faqId},profile:Object.assign({},t.profile),contact_reason:t.contactReason,additional_data:{current_url:window.location.href},live_trigger_id:t.request.liveTriggerId,start_mode:t.request.liveTriggerStartMode,is_logged_in:te.isLoggedIn,weight:cn.setStore(i).computeStaticPriority(Object.assign({},t.request,{customerType:s})),asyncValidatedStartToken:t.asyncValidatedResumeChatToken},r,a=>{(t.stateContactReasonOnly||t.stateContactReasonWithRegister)&&n("contactReasonSubmitted"),n("apiErrorFinish"),n("apiSuccess",a)},a=>{try{const o=a;if(Object.values(bt).indexOf(o.error)!==-1){const c=t.display;e(zt),Se.restoreDefaultState(!1,{},!0),e(vs,o.error),e(Ke,c),G.dispatcher.emit("livechat.send-action.error",a);return}if(o.error==="anon_not_allowed"||_o(o,e)){e(we,Ee),t.stateContactReasonOnly?n("showContactReasonFormOnly"):t.stateContactReasonWithRegister&&n("showContactReasonFormWithRegister"),n("showRegister");return}n("showRegister"),n("apiError",a.response)}catch(o){n("showRegister"),n("apiError",o)}}),e(Kn,{rqStartAt:new Date().getTime()})}},Bf=({commit:t,dispatch:e,state:n},i)=>{G.dispatcher.emit("launch",i.request.id,n.request.liveTriggerId,n.request.source,n.request.liveTriggerStartMode),t(Va,i),Z.startChat(n)},zf=({commit:t},e)=>{console.error(e),t(ys,!0)},Wf=({commit:t})=>{t(ys,!1)},jf=({commit:t},e)=>{t(Ya,e)},Xf=({commit:t},e)=>{t(Ka,e)},Qf=({commit:t},e)=>{t(eo,e)},Gf=({commit:t},e)=>{t(to,e)},Jf=({commit:t})=>{t(Ye,{vueMessage:!0,vueWait:!1,vueProfile:!1,vueRating:!1,vueSendTranscript:!1,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!1})},Vf=({commit:t})=>{t(Ye,{vueMessage:!1,vueWait:!0,vueProfile:!1,vueRating:!1,vueSendTranscript:!1,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!1}),t(we,Le)},Yf=({commit:t})=>{t(Ye,{vueMessage:!1,vueWait:!1,vueProfile:!0,vueRating:!1,vueSendTranscript:!1,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!1})},Kf=({commit:t})=>{t(Ye,{vueMessage:!1,vueWait:!1,vueProfile:!1,vueRating:!0,vueSendTranscript:!1,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!1})},Zf=({commit:t})=>{t(Ye,{vueMessage:!1,vueWait:!1,vueProfile:!1,vueRating:!1,vueSendTranscript:!0,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!1})},ep=({commit:t})=>{t(Ye,{vueMessage:!1,vueWait:!1,vueProfile:!1,vueRating:!1,vueSendTranscript:!1,vueUpload:!1,vueRegister:!0,vueAsyncContinue:!1})},tp=({commit:t})=>{t(ii,{stateContactReasonOnly:!1,stateContactReasonWithRegister:!0,stateContactReasonSubmitted:!1})},np=({commit:t})=>{t(ii,{stateContactReasonOnly:!0,stateContactReasonWithRegister:!1,stateContactReasonSubmitted:!1})},ip=({commit:t})=>{t(ii,{stateContactReasonSubmitted:!0})},sp=({commit:t})=>{t(Ye,{vueMessage:!1,vueWait:!1,vueProfile:!1,vueRating:!1,vueSendTranscript:!1,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!0})},rp=({commit:t})=>{const{title:e,firstName:n,lastName:i,email:s,nessClubId:r,nessClubLevel:a}=te;t(Ze,{title:e,firstName:n,lastName:i,email:s,nessClubId:r,nessClubLevel:a}),t(ms)},ap=({commit:t},e)=>{t(ro,e)},op=({commit:t,dispatch:e,state:n},{action:i,canHandover:s,isAsyncChat:r,handoverEnabled:a})=>{switch(i){case Mn.NONE:break;case Mn.HANDOVER:if(!a){e("receiveMessage",{message:le.get("chatbot.handover_disabled"),operator:{},rel:"nespresso_chatbot",read:!1,id:"chatbot.handover_disabled"}),G.dispatcher.emit("chatbot.end");break}r||(s?e("receiveMessage",{message:le.get("chatbot.handover_confirm.title"),operator:{},rel:"nespresso_chatbot",read:!1,id:"chatbot.handover_confirm.title"}):t(ti,!0)),e("showHandoverConfirmButton");break;case Mn.END:G.dispatcher.emit("chatbot.end");break;default:throw new Error("Unhandled response action")}},lp=({commit:t})=>{t(ei,!0)},cp=({commit:t,dispatch:e,state:n})=>{if(t(ei,!1),t(oo,!0),!n.settings.allow_anonymous&&!n.profile.email){e("showRegister");return}e("startHandoverOnAgent")},up=({dispatch:t,state:e})=>{t("updateChatbotContext",ie.CHATBOT_HANDOVER);const n=e.request;G.sendAction(n.id,"chatbot-handover",{},i=>{Z.resetClient(),i.is_chatbot_handover?(t("apiSuccess",i),t("goInQueue")):t("showHandoverRegister"),G.dispatcher.emit("chatbot.handover")},()=>{t("showWait"),t("apiError","Error on chatbot handover")})},dp=({commit:t,dispatch:e})=>{t(ti,!0),e("showRegister"),e("receiveMessage",{message:le.get("chatbot.registration_handover"),operator:{},read:!0,rel:"register",id:"chatbot.registration_handover"})},hp=({commit:t,dispatch:e,state:n})=>{G.sendAction(n.request.id,"chatbot-register-handover",{email:n.profileTmp.email,requestSummarizeOnHandover:n.settings.chatbot_ask_summarize_on_handover?n.summarizeOnHandover:null},()=>{t(ei,!1),t(ti,!1),t(lo,!0),e("receiveMessage",{message:le.get("chatbot.registration_handover_confirm"),operator:{},read:!0,id:"chatbot.registration_handover_confirm"}),e("showMessage"),e("closeChat",{source:"chatbot"}),t(we,$e),e("showTranscript")},i=>{try{e("apiError",i.response)}catch(s){e("apiError",s)}})},fp=({commit:t,dispatch:e},n)=>{t(vs,n),t(Ke,Fe),e("show")},pp=({dispatch:t,state:e})=>{e.request.asyncEnabled&&t("asyncChatXmppSessionInitialized")},gp=({commit:t,dispatch:e,state:n})=>{if(t(we,_e),t(ni,Yn),e("showMessage"),n.request.joinCount>1)return;n.firstMessage&&!n.confirmedHandover&&(e("sendMessage",n.firstMessage),t(Zn,""));let i="";if(n.settings.is_chat_open)i=uf(n);else if(n.settings.next_open_datetime){const s=new Date(n.settings.next_open_datetime*1e3),r=fe.formatDateTime(s,K.apiSettings.time_format);i=le.get("livechat.async_chat.welcome_close").replace("{$$nextOpenDayHour$$}",r)}else i=le.get("livechat.async_chat.welcome_close.no_next_opening");e("receiveMessage",{message:i,operator:{},read:!0,rel:"system"})},mp=({commit:t})=>{t(ni,Na)},_p=({commit:t,dispatch:e})=>{t(ni,Yn),e("clearReceipts")},vp=({commit:t})=>{t(za),Z.clearReceipts()},yp=({commit:t,dispatch:e,state:n},i)=>{Z.finishChat(),t(zt),Se.restoreDefaultState(!1,{display:Fe},!0),t(Ke,Fe),t(we,La),t(uo,!0),"asyncValidatedStartToken"in i&&t(Xn,i.asyncValidatedStartToken),e("showAsyncContinue")},bp=({commit:t,dispatch:e,state:n},i)=>{t(bs,i),i.isStandby?e("switchLiveAgentChatToAsyncChat"):e("switchAsyncChatToLiveAgentChat")},Cp=({commit:t,state:e})=>{t(Ke,Ve),e.disabledReason&&Se.restoreDefaultState()},wp=Object.freeze(Object.defineProperty({__proto__:null,sendMessage:df,sendMessageAction:hf,sendAttachment:ff,receiveMessage:pf,receiveReceipt:gf,startTyping:mf,stopTyping:_f,sendChatState:vf,sendPageState:yf,chatTransfered:bf,restoreChat:Cf,disconnected:wf,reconnected:Sf,updateProfile:Tf,updateXmppSession:Ef,updateRequestData:Af,updateChatbotContext:xf,cancelRequest:kf,closeChat:Of,announce:If,sendRating:Mf,sendTranscript:Rf,downloadAttachment:Nf,openChat:Lf,goInQueue:Pf,expandChat:$f,expandChatFullWindow:Ff,hide:Df,disable:Hf,show:qf,start:Uf,apiSuccess:Bf,apiError:zf,apiErrorFinish:Wf,updateList:jf,updateOrderedList:Xf,updateConfig:Qf,updateSettings:Gf,showMessage:Jf,showWait:Vf,showProfile:Yf,showRating:Kf,showTranscript:Zf,showRegister:ep,showContactReasonFormWithRegister:tp,showContactReasonFormOnly:np,contactReasonSubmitted:ip,showAsyncContinue:sp,updateProfileFromDatalayer:rp,queueWaitingSize:ap,handleChatbotAction:op,showHandoverConfirmButton:lp,triggerHandoverOnAgent:cp,startHandoverOnAgent:up,showHandoverRegister:dp,registerHandover:hp,displayDisabledMessage:fp,xmppConnected:pp,asyncChatXmppSessionInitialized:gp,switchAsyncChatToLiveAgentChat:mp,switchLiveAgentChatToAsyncChat:_p,clearReceipts:vp,asyncChatSessionClosed:yp,asyncChatStandbyChange:bp,collapseChat:Cp},Symbol.toStringTag,{value:"Module"}));class j{static addClass(e,n){e.classList?e.classList.add(n):e.className+=` ${n}`}static hasClass(e,n){return e.classList?e.classList.contains(n):!1}static removeClass(e,n){e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp(`(^|\\b)${n.split(" ").join("|")}(\\b|$)`,"gi")," ")}static create(e){const n=document.createDocumentFragment(),i=document.createElement("div");for(i.innerHTML=e;i.firstChild;)n.appendChild(i.firstChild);return n}static html(e,n){n instanceof Element?e.innerHTML=n.outerHTML:e.innerHTML=n}static text(e,n){n instanceof Element?e.innerText=n.outerText:e.innerText=n}static htmlEscape(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")}static htmlDecode(e){const n=document.createElement("textarea");return n.innerHTML=e,n.value}static wrapWordsInHtmlNoBreak(e,n){if(n&&n>1){let i="",s="",r=!1,a;const o=()=>{s.length>1&&s.length<=n?i+=`<nobr>${s}</nobr>${a}`:i+=`${s}${a}`,s=""};for(a of e)switch(a){case"<":r=!0,o();break;case(a.match(/\s/)||[" "])[0]:o();break;case">":r?(r=!1,i+=a):s+=a;break;default:r?i+=a:s+=a;break}return a="",s.length>0&&o(),i}return e}static nl2br(e){return String(e).replace(/(\r\n|\n\r)/g,"<br>").replace(/(\r|\n)/g,"<br>")}static loadJs(e,n=document.body,i={}){return new Promise((s,r)=>{const a=document.createElement("script");if(i)for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&a.setAttribute(o,i[o]);a.src=e,a.onload=s,a.onreadystatechange=s,a.onerror=r,n.appendChild(a)})}static loadCss(e){const n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e),document.body.appendChild(n)}static parseMessage(e){e=e.replace(/(;-?\))(\s|$)/gi,j.applySmileys("wink","$1")+"$2").replace(/(:-?3)(\s|$)/gi,j.applySmileys("waii","$1")+"$2").replace(/(:-?\()(\s|$)/gi,j.applySmileys("unhappy","$1")+"$2").replace(/(:-?P)(\s|$)/gi,j.applySmileys("tongue","$1")+"$2").replace(/(:-?O)(\s|$)/gi,j.applySmileys("surprised","$1")+"$2").replace(/(:-?\))(\s|$)/gi,j.applySmileys("smile","$1")+"$2").replace(/(\^_?\^)(\s|$)/gi,j.applySmileys("happy","$1")+"$2").replace(/(:-?D)(\s|$)/gi,j.applySmileys("grin","$1")+"$2"),e=j.nl2br(e),e=j.activateLinksInHtml(e);const n=parseInt(K.apiSettings.nb_no_break_chars,10);return e=j.wrapWordsInHtmlNoBreak(e,n),e}static preloadSound(e){const n=document.createElement("audio");n.style.display="none",n.setAttribute("preload","auto");let i=document.createElement("source");return i.setAttribute("type","audio/ogg"),i.setAttribute("src",`${K.frontBaseUrl}/apps/calleo-livechat/sound/${e}.ogg`),n.appendChild(i),i=document.createElement("source"),i.setAttribute("type","audio/mpeg"),i.setAttribute("src",`${K.frontBaseUrl}/apps/calleo-livechat/sound/${e}.mp3`),n.appendChild(i),document.body.appendChild(n),n}static applySmileys(e,n){return`<img class="s ${e}" alt="${n}" title="${n}" src="${K.frontBaseUrl}/apps/calleo-livechat/img/s.gif">`}static activateLinks(e,n=null){e=String(e);let i=e;if(e.indexOf("://")===-1)return e;const s=/(^|\s|>|\(|\)|"|'|:|\[|])((https?|ftp|file|xmpp|irc|mailto|vnc|webcal|ssh|ldap|smb|magnet|spotify)(:\/\/)([^<>'"\s)(]+))/gim;let r='target="_blank"';if(n===null&&(n=rt.parseURIBase(window.location.href).host),n){let a;for(;a=s.exec(e);){const o=rt.parseURIBase(a[2].trim());r='target="_blank"',o&&o.host===n&&(r=""),i=i.replace(a[0],`${a[1]}<a href="${a[2]}" ${r}>${a[2]}</a>`)}}else i=e.replace(s,`$1<a href="$2" ${r}>$2</a>`);return i}static activateLinksInHtml(e,n=null){let i="",s=!1,r=0,a="",o="";for(let c=0;c<e.length;c++)o=e[c],o==="<"?(s=!0,e.substring(c+1,c+3).toLocaleLowerCase()==="a "&&(r=!0),i&&(a+=j.activateLinks(i,n),i=""),a+=o):o===">"?(r&&(r=e.substring(c-3,c+1).toLocaleLowerCase()!=="</a>"),r||(s=!1),a+=o):s?a+=o:i+=o;return i&&(a+=j.activateLinks(i,n)),a}static hasCssAnimationSupport(){return"animationName"in document.createElement("div").style}}const Lt="vchat_async_continue",vo=30;/*! js-cookie v3.0.1 | MIT */function Tn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t}var Sp={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function zi(t,e){function n(s,r,a){if(typeof document!="undefined"){a=Tn({},e,a),typeof a.expires=="number"&&(a.expires=new Date(Date.now()+a.expires*864e5)),a.expires&&(a.expires=a.expires.toUTCString()),s=encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var c in a)!a[c]||(o+="; "+c,a[c]!==!0&&(o+="="+a[c].split(";")[0]));return document.cookie=s+"="+t.write(r,s)+o}}function i(s){if(!(typeof document=="undefined"||arguments.length&&!s)){for(var r=document.cookie?document.cookie.split("; "):[],a={},o=0;o<r.length;o++){var c=r[o].split("="),f=c.slice(1).join("=");try{var g=decodeURIComponent(c[0]);if(a[g]=t.read(f,g),s===g)break}catch(E){}}return s?a[s]:a}}return Object.create({set:n,get:i,remove:function(s,r){n(s,"",Tn({},r,{expires:-1}))},withAttributes:function(s){return zi(this.converter,Tn({},this.attributes,s))},withConverter:function(s){return zi(Tn({},this.converter,s),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var Be=zi(Sp,{path:"/"});const Tp="text",Ep="image",Ap="card",xp="quick_reply",kp="text_with_buttons",Op="carousel",xe={TEXT:Tp,IMAGE:Ep,CARD:Ap,QUICK_REPLY:xp,TEXT_WITH_BUTTONS:kp,CAROUSEL:Op},Ip="cookie",Mp="login",Rp="email",Np="sms",Qn={COOKIE:Ip,LOGIN:Mp,EMAIL_LINK:Rp,SMS_LINK:Np},Lp={[$a](t,e){t.quickReplyAnswers=[],Sr(t,e.message,null,e.id)},[Fa](t,e){t.quickReplyAnswers=[];const n=e.payload;Sr(t,n.name,n,e.id)},[Pa](t,e){const{message:n,operator:i,read:s,rel:r="nespresso",attachment:a=null,id:o=null,image:c=null,chatbot:f=null}=e;let g=!1;t.messages.forEach(E=>{E.id!==null&&E.id===o&&(g=!0)}),g||Pp(t,n,i,s,r,a,o,c,f)},[Da](t,e){t.isTyping=e},[Ha](t){t.isTyping=!1},[qa](t){t.disconnected=!0},[Ua](t){t.disconnected=!1},[gs](t){t.messages.forEach(e=>{e.read=!0}),t.updateHack=!t.updateHack,Ft.messageRead()},[Ba](t,e){t.messages.forEach(n=>{n.id===e&&(n.receipt=!0)}),t.updateHack=!t.updateHack},[za](t){t.messages.forEach(e=>{e.receipt===!1&&(e.receipt=null)}),t.updateHack=!t.updateHack},[qi](t,e){t.message=e},[Wa](t,e){t.quickReplyAnswers=e},[Ye](t,e){const{vueWait:n,vueMessage:i,vueProfile:s,vueRating:r,vueSendTranscript:a,vueUpload:o,vueRegister:c,vueAsyncContinue:f}=e;t.vueWait=n,t.vueMessage=i,t.vueProfile=s,t.vueRating=r,t.vueSendTranscript=a,t.vueUpload=o,t.vueRegister=c,t.vueAsyncContinue=f},[ii](t,e){const{stateContactReasonOnly:n,stateContactReasonWithRegister:i,stateContactReasonSubmitted:s}=e;t.stateContactReasonOnly=n,t.stateContactReasonWithRegister=i,t.stateContactReasonSubmitted=s},[Ke](t,e){t.display=e,G.dispatcher.emit("display-status",e===Fe)},[io](t){t.hide=!0},[no](t){t.hide=!1},[zt](t,e={}){t.whoClosed=e.source?e.source:t.whoClosed,t.close=!0,Ft.closeChat()},[Kn](t,e){t.request=Object.assign({},t.request,e)},[ja](t,e){t.chatbotContext=e},[Xa](t,e){t.chatbotLastActivity=e},[Ze](t,e){t.profileTmp=Object.assign({},t.profileTmp,e)},[jn](t){t.profileTmp=Object.assign({},t.profileTmp,t.profile)},[ms](t){t.profile=Object.assign({},t.profile,t.profileTmp)},[ei](t,e){t.toConfirmHandover=e},[oo](t,e){t.confirmedHandover=e},[ti](t,e){t.toRegisterHandover=e},[lo](t,e){t.registeredHandover=e},[Za](t,e){t.xmppSession=Object.assign({},t.xmppSession,e)},[Qa](t,e){t.profile.id=e},[Ga](t,e){t.profile.phone=e},[_s](t,e){t.profileError=e},[Wh](t,e){t.formProfile=e},[Ja](t,e){t.transcriptSent=e},[jh](t,e){t.communicator=e},[Xh](t,e){t.calleoChat=e},[Ya](t,e){t.list=e},[Ka](t,e){t.orderedList=Object.assign({},t.orderedList),Object.entries(e).forEach(([n,i])=>{t.orderedList[n]=[],i.forEach(s=>{t.orderedList[n].push(s)})})},[eo](t,e){t.config=Object.assign({},t.config,e)},[to](t,e){t.settings=Object.assign({},t.settings,e)},[Jt](t,e){t.rating=Object.assign({},t.rating,e)},[we](t,e){t.workflow=e,e===$e&&(t.feedbackSent=!0),t.disabledReason=null},[vs](t,e){t.workflow=We,t.disabledReason=e},[Ui](t,e){t.push.sendPresenceTimestamp=e},[Va](t,e){if(!!e&&(e.request&&(t.request.id=e.request.id,t.request.categoryId=e.request.category_id,t.request.chatbotStatus=e.request.chatbot_status,t.request.country=e.request.country,t.request.marketId=e.request.market_id,t.request.channel=e.request.channel,t.request.replyLang=e.request.reply_lang,t.request.rqTime=parseInt(e.request.rq_time,10),t.request.customerType=e.request.customer_type,t.request.source=e.request.source,t.request.priorityTimeFactor=e.request.priority_time_factor,t.request.timeDiffServer=Math.ceil(new Date().getTime()/1e3)-parseInt(e.request.rq_time,10),t.request.status=e.request.status,t.request.asyncEnabled=Boolean(e.request.asyncEnabled),t.request.joinCount=parseInt(e.request.join_count,10),t.request.queueSize=e.request.queueSize?parseInt(e.request.queueSize,10):0,e.asyncContinueMode&&(e.asyncContinueMode===Qn.EMAIL_LINK||e.asyncContinueMode===Qn.SMS_LINK)&&(t.asyncWelcomeBackMsg=!0)),e.profile&&e.profile.id&&(t.profile.id=e.profile.id,t.profile.title=e.profile.title,t.profile.firstName=e.profile.firstName,t.profile.lastName=e.profile.lastName,t.profile.email=e.profile.email,t.profile.phone=e.profile.phone,t.profile.legalTerms=e.profile.legalTerms,t.profile.nessClubId=e.profile.nessClubId,t.profile.nessClubLevel=e.profile.nessClubLevel,t.profileTmp=Object.assign({},t.profileTmp,t.profile)),e.access&&(t.access=e.access),e.secretToken&&(t.secretToken=e.secretToken),e.settingsUpdate&&(t.settings=Object.assign({},t.settings,e.settingsUpdate)),Tr(e.asyncContinueToken),t.asyncValidatedResumeChatToken=null,t.asyncChatSessionClosed=!1,e.messages)){if(t.messages=[],e.messages.forEach(n=>{t.messages.push({id:n.id,message:j.parseMessage(j.htmlEscape(n.message)),messageRaw:n.message,image:n.image,attachment:n.attachment,operator:n.operator,rel:n.rel,time:n.time,read:n.read,receipt:n.receipt,chatbotContext:n.chatbotContext,chatbot:n.chatbot})}),t.messages[t.messages.length-1]){const n=t.messages[t.messages.length-1];if(n.chatbot&&n.chatbot.elements){const i=[];n.chatbot.elements.forEach(s=>{(s.type===xe.QUICK_REPLY||s.type===xe.TEXT_WITH_BUTTONS||s.type===xe.CAROUSEL)&&s.answers&&s.answers.forEach(r=>{const a={text:r.text,payload:null};r.payload&&(a.payload=r.payload),i.push(a)})}),t.quickReplyAnswers=i}}t.vueWait&&e.messages.length>0&&(t.vueMessage=!0,t.vueWait=!1)}},[bs](t,e){Tr(e.asyncContinueToken),t.request.status=e.status,e.settingsUpdate&&(t.settings=Object.assign({},t.settings,e.settingsUpdate))},[Qh](t,e){},[so](t){t.messages=[]},[Zn](t,e){t.firstMessage=e},[ro](t,e){(t.waitingQueueSize===null||t.waitingQueueSize>e)&&(t.waitingQueueSize=e)},[ao](t,e){t.displayWaitContactFormButton=e},[ys](t,e){t.apiError=e},[Bi](t,e){t.asyncTokenAllreadyTested=e},[ho](t,e){t.isAsyncAllowed=e},[Xn](t,e){t.asyncValidatedResumeChatToken=e},[uo](t,e){t.asyncChatSessionClosed=e},[co](t,e){t.asyncWelcomeBackMsg=e},[ni](t,e){t.chatContext=e,e!==Na&&(t.xmppSession.operatorXid=null)},[fo](t,e){t.contactReason=e},[po](t,e){t.summarizeOnHandover=e}};function Sr(t,e,n=null,i=null,s=!1){const r={id:i,message:j.parseMessage(j.htmlEscape(e)),messageRaw:e,attachment:n,rel:"client",time:new Date().getTime(),read:!0,receipt:s,chatbotContext:t.chatbotContext};t.messages.push(r),t.messageSentAfterReconnect=!0,t.updateHack=!t.updateHack}function Tr(t){t&&Be.set(Lt,t,{expires:vo})}function Pp(t,e,n,i=!1,s="nespresso",r=null,a=null,o=null,c=null){t.messages.push({id:a,message:j.parseMessage(j.htmlDecode(e)),messageRaw:e,chatbot:c,image:o,attachment:r,operator:n,read:i,rel:s,time:new Date().getTime()}),t.updateHack=!t.updateHack}const yo={get(){return ue({},{settings:{},config:{},list:{},orderedList:{},request:{id:null,categoryId:null,country:null,marketId:null,channel:null,replyLang:null,liveTriggerId:null,liveTriggerStartMode:null,source:"chat_embed",customerType:"",rqTime:0,timeDiffServer:0,priority:0,priorityTimeFactor:1,rqStartAt:0,rqTakeAt:0,faqId:null,status:null,asyncEnabled:!1,joinCount:0},profileTmp:{id:null,title:"",firstName:"",lastName:"",email:"",phone:"",legalTerms:!1},xmppSession:{jid:null,node:null,bareJid:null,resource:null,chatState:null,operatorXid:null,lastOperatorChange:null,operatorNick:null,operatorAvatar:null,customersInQueue:null,operatorsInQueue:null},access:{username:"",password:""},profile:{id:null,title:"",firstName:"",lastName:"",email:"",phone:"",legalTerms:!1,nessClubId:null,nessClubLevel:null},profileError:null,rating:{delay:"",quality:"",satisfaction:"",comment:""},push:{sendPresenceTimestamp:null},asyncWelcomeBackMsg:!1,secretToken:null,messages:[],messageSentAfterReconnect:!1,message:"",firstMessage:"",quickReplyAnswers:[],disconnected:!1,messagesUnread:0,isTyping:!1,vueWait:!1,vueMessage:!0,vueProfile:!1,vueRating:!1,vueSendTranscript:!1,vueUpload:!1,vueRegister:!1,vueAsyncContinue:!1,display:Ve,close:!1,whoClosed:null,transcriptSent:!1,feedbackSent:!1,hide:!0,workflow:Ee,disabledReason:null,waitingQueueSize:null,displayWaitContactFormButton:!1,apiError:!1,updateHack:!1,toConfirmHandover:!1,confirmedHandover:!1,toRegisterHandover:!1,registeredHandover:!1,chatbotContext:"none",chatbotLastActivity:-1,isAsyncAllowed:!1,asyncTokenAllreadyTested:{cookie:{},url:{},profile:{}},chatContext:Ra,asyncValidatedResumeChatToken:null,asyncChatSessionClosed:!1,ScreenMirroring:{requested:!1,accepted:!1,acceptedRecently:!1,inProgress:!1},contactReason:null,summarizeOnHandover:null,stateContactReasonOnly:!1,stateContactReasonWithRegister:!1,stateContactReasonSubmitted:!1})}},$p={namespaced:!0,state:{requested:!1,requestCanceled:!1,accepted:!1,acceptedRecently:!1,inProgress:!1},getters:{shouldShowAskForm:t=>t.requested&&!t.accepted&&!t.requestCanceled,shouldStartMirroring:t=>t.requested&&t.accepted},mutations:{set(t,e){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},reset(t){t.requested=!1,t.requestCanceled=!1,t.accepted=!1,t.acceptedRecently=!1,t.inProgress=!1},receiveInvitation(t){t.requested=!0},receiveCancelInvitation(t){t.requestCanceled=!0},mirroringInProgress(t){t.inProgress=!0},mirroringStopped(t){t.inProgress=!1},acceptInvitation(t){t.accepted=!0},denyInvitation(t){t.accepted=!1,t.requested=!1}},actions:{receiveInvitation({commit:t}){t("reset"),Xe.init(),t("receiveInvitation")},receiveCancelInvitation({commit:t}){t("reset"),t("receiveCancelInvitation")},stop({commit:t}){t("reset"),Xe.stop()}}};ee.use(Vn);const d=new Vn.Store({state:yo.get(),getters:zh,actions:wp,mutations:Lp,modules:{ScreenMirroring:$p},strict:!0,plugins:[]});function Fp(t,e){t.addConnectionPlugin("receipts",{_conn:null,_msgQueue:{},_retries:{},_resendCount:5,_resendTime:9e3,init(n){this._conn=n,t.addNamespace("RECEIPTS","urn:xmpp:receipts")},sendMessage(n){const i=this._conn.getUniqueId();return this.pushMessageQueue(i,n),this._conn.send(n),i},pushMessageQueue(n,i){i.tree().setAttribute("id",n);const s=t.xmlElement("request",{xmlns:t.NS.RECEIPTS});i.tree().appendChild(s),this._msgQueue[n]=i,this._retries[n]=0,this.resendMessage(n)},resendMessage(n){const i=this;setTimeout(()=>{if(i._msgQueue[n]){if(!d.state.xmppSession.jid||d.getters.isChattingWithVirtualAgent)return;if(!i._conn.connected||!d.state.xmppSession.operatorXid){i.resendMessage(n);return}if(i._retries[n]++,i._retries[n]>i._resendCount)return;i._msgQueue[n].tree().setAttribute("to",d.state.xmppSession.operatorXid),i._conn.send(i._msgQueue[n]),i.resendMessage(n)}},this._resendTime)},_processReceipt(n){const i=n.getAttribute("id"),s=n.getAttribute("from"),r=n.getElementsByTagName("request"),a=n.getElementsByTagName("received");if(r.length>0){const o=e({to:s,from:this._conn.jid,id:this._conn.getUniqueId()}),c=t.xmlElement("received",{xmlns:t.NS.RECEIPTS,id:i});o.tree().appendChild(c),this._conn.send(o)}if(a.length>0){const o=a[0].getAttribute("id");o&&(delete this._msgQueue[o],delete this._retries[o])}},resendQueue(){if(!this._conn.connected){const n=this;setTimeout(()=>{n.resendQueue()},5e3);return}for(const n in this._msgQueue)Object.prototype.hasOwnProperty.call(this._msgQueue,n)&&this._conn.send(this._msgQueue[n])},addReceiptHandler(n,i,s,r){const a=this,o=function(c){return a._processReceipt(c),n(c)};this._conn.addHandler(o,t.NS.RECEIPTS,"message",i,null,s,r)},statusChanged(n){if(n===t.Status.CONNECTED||n===t.Status.ATTACHED){const i=this;setTimeout(()=>{i.resendQueue()},5e3)}},getUnreceivedMsgs(){const n=[];for(const i in this._msgQueue)Object.prototype.hasOwnProperty.call(this._msgQueue,i)&&n.push(this._msgQueue[i]);return n},clearMessages(){this._msgQueue={},this._retries={}}})}const Dp="user_left",Hp="push_assigned",qp="push_unassigned",Up="terminate_xmpp_session",Bp="chat_standby",zp="chat_wakeup",Wp="chat_finish",jp="ask-screen-mirroring",Xp="cancel-ask-screen-mirroring",Qp="rtc-signaling",Gp="undefined",ge={USER_LEFT:Dp,PUSH_ASSIGNED:Hp,PUSH_UNASSIGNED:qp,TERMINATE_XMPP_SESSION:Up,CHAT_STANDBY:Bp,CHAT_WAKEUP:zp,CHAT_FINISH:Wp,ASK_SCREEN_MIRRORING:jp,CANCEL_ASK_SCREEN_MIRRORING:Xp,RTC_SIGNALING:Qp,UNDEFINED:Gp};Cl(h);Fp(h,Pr);class pi{constructor(e,n,i,s,r){this._boshUrl=`${e.url.bosh}?r=${n}`,this._appVersion=e.app_version,this._livechatHost=e.livechatHost,this._username=i,this._uniqueId=n,this._password=s,this._dispatcher=r,this._enableReceipts=e.apiSettings.enabled_receipts,this._connection=null,this._lastInfo=null,e.apiSettings.sendError&&(this._lastInfo={error:[],response:[],request:[],message:[]},this._lastInfoLimit={error:20,response:6,request:6,message:20})}getLastInfo(e){return this._lastInfo[e].join(`
`)}clearLastInfo(e){this._lastInfo[e]=[]}addLastInfo(e,n){this._lastInfo&&(typeof n=="object"&&n!==null&&(n=`JSError: ${Error.prototype.toString.call(n)}`),this._lastInfo[e].push(n),this._lastInfo[e].length>this._lastInfoLimit[e]&&this._lastInfo[e].shift())}_getConnection(){if(!this._connection){h.warn=n=>{h.log(h.LogLevel.WARN,n),this.addLastInfo("error",`Warn: ${n}`)},h.error=n=>{h.log(h.LogLevel.ERROR,n),this.addLastInfo("error",`Error: ${n}`)},h.fatal=n=>{h.log(h.LogLevel.FATAL,n),this.addLastInfo("error",`Fatal: ${n}`)};const e=this._createConnection();e.rawInput=n=>{this.addLastInfo("response",n)},e.rawOutput=n=>{this.addLastInfo("request",n)},this._connection=e}return this._connection}_createConnection(){return new h.Connection(this._boshUrl,{keepalive:!0,mechanisms:[h.SASLPlain]})}startNewConnection(){const e=this._getConnection(),n="livechat("+this._uniqueId+"-"+this._appVersion+")";e.connect(`${this._username}@${this._livechatHost}/${n}`,this._password,this._onConnect.bind(this),20,1,2),this.clearReceipts()}clearReceipts(){this._enableReceipts&&this._connection&&this._connection.receipts.clearMessages()}reConnection(e=null){return this.closeConnection(),this._getConnection().connect(e,this._password,this._onConnect.bind(this),20,1,2),!0}restoreConnection(){this._getConnection().restore(null,this._onConnect.bind(this),20,1,2)}beforePageUnload(){this._connection&&(this._connection.flush(),this._connection.pause())}flush(){this._connection&&this._connection.flush()}closeConnection(){this._connection&&(this._connection.disconnect(),this._connection.reset(),this._connection=null)}get hasConnection(){return Boolean(this._connection)}_onConnect(e){switch(e){case h.Status.CONNECTING:break;case h.Status.CONNFAIL:this._connection&&this._dispatcher.emit("xmpp.fail-connection",this);break;case h.Status.ERROR:this._dispatcher.emit("xmpp.error",this);break;case h.Status.AUTHFAIL:this._dispatcher.emit("xmpp.authfail",this);break;case h.Status.DISCONNECTING:break;case h.Status.DISCONNECTED:this._dispatcher.emit("xmpp.disconnected");break;case h.Status.CONNECTED:this._registerHandler(),this._dispatcher.emit("xmpp.connected",this,this._connection.jid);break;case h.Status.ATTACHED:this._registerHandler(),this._dispatcher.emit("xmpp.attached",this,this._connection.jid);break}}_registerHandler(){this._connection.addHandler(this._onMessage.bind(this),null,"message"),this._connection.addHandler(this._onPresence.bind(this),null,"presence"),this._connection.addHandler(this._onIQ.bind(this),null,"iq"),this._connection.receipts.addReceiptHandler(this._onReceipt.bind(this))}_onMessage(e){const n=h.getBareJidFromJid(e.getAttribute("to")),i=h.getBareJidFromJid(e.getAttribute("from")),s=e.getAttribute("type"),r=e.getElementsByTagName("subject"),a=r.length?h.getText(r.item(0)).trim():null,o=e.getElementsByTagName("body"),c=o.length?h.getText(o.item(0)).trim():null,f=this._getJsonFromHtml(c);if(f){const g=f.action?f.action:ge.UNDEFINED;this._dispatcher.emit(`xmpp.message.${g}`,this,i,n,e,s,f,a)}else this._dispatcher.emit("xmpp.message",this,i,n,e,s,c,a);return!0}_onPresence(e){const n=h.getBareJidFromJid(e.getAttribute("to")),i=h.getBareJidFromJid(e.getAttribute("from")),s=e.getAttribute("type"),r=e.getElementsByTagName("item");let a;for(let o=0;o<r.length&&(a=r[o].getAttribute("role"),!a);o++);return this._dispatcher.emit("xmpp.presence",this,i,n,e,s,a),!0}_onIQ(e){const n=h.getBareJidFromJid(e.getAttribute("to")),i=h.getBareJidFromJid(e.getAttribute("from"));return this._dispatcher.emit("xmpp.iq",this,i,n,e),!0}_onReceipt(e){return this._dispatcher.emit("xmpp.receipts",e),!0}_getJsonFromHtml(e){return!e||e.charAt(0)!=="{"?null:this._parseJson(this._htmlDecode(e))}_parseJson(e){try{return JSON.parse(e)}catch(n){return null}}_htmlDecode(e){try{return new DOMParser().parseFromString(e,"text/html").documentElement.textContent}catch(n){return""}}sendPresence(e={}){if(this._connection){const n=this.generateNodeFromObject("presence",e);this._connection.sendPresence(n.tree())}}sendMessage(e={},n=!1){if(this._connection){const i=this.generateNodeFromObject("message",e);return n&&this._enableReceipts?this._connection.receipts.sendMessage(i):this._connection.send(i.tree())}}pushMessageReceiptQueue(e,n){if(this._enableReceipts){const i=this.generateNodeFromObject("message",n);this._connection.receipts.pushMessageQueue(e,i)}}sendIQ(e={}){if(this._connection){const n=this.generateNodeFromObject("iq",e);this._connection.sendIQ(n.tree())}}generateNodeFromObject(e,n){typeof e=="string"&&(e=new h.Builder(e));for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(i==="_attrs"?e.attrs(n[i]):i==="_"?e.t(n[i]):typeof n[i]=="string"||typeof n[i]=="number"?e.c(i,{},n[i]):(e.c(i),this.generateNodeFromObject(e,n[i]),e.up()));return e}getExplodeJidData(e){return{jid:e,node:h.getNodeFromJid(e),bareJid:h.getBareJidFromJid(e),resource:h.getResourceFromJid(e)}}}class Er{constructor(e,n,i,s,r){this._msgCount=0,this._mode=e.apiSettings.chatbot_allow_anonymous,this._appVersion=e.app_version,this._chatbotId=e.apiSettings.chatbot_id,this._username=i,this._uniqueId=n,this._requestId=0,this._password=s,this._dispatcher=r,this._connection=null,this._lastInfo=null,this._url=e.url.api,e.apiSettings.sendError&&(this._lastInfo={error:[],response:[],request:[],message:[]},this._lastInfoLimit={error:20,response:6,request:6,message:20}),this._expirationTimeout=e.apiSettings.chatbot_timeout,this._expirationTimeoutId=null,this._updateExpirationTimeout(!1)}getLastInfo(e){return this._lastInfo[e].join(`
`)}clearLastInfo(e){this._lastInfo[e]=[]}addLastInfo(e,n){this._lastInfo&&(typeof n=="object"&&n!==null&&(n=`JSError: ${Error.prototype.toString.call(n)}`),this._lastInfo[e].push(n),this._lastInfo[e].length>this._lastInfoLimit[e]&&this._lastInfo[e].shift())}startNewConnection(){this._dispatcher.emit("chatbot.connected",this,this._chatbotId,d.state.request.id),this._requestId=d.state.request.id,d.state.messages[0].chatbot.elements.forEach((e,n)=>{let i=le.get("chatbot.welcome_default");e.title!==void 0?i=e.title:e.text!==void 0&&(i=e.text),d.dispatch("receiveMessage",{id:e.id,message:i,operator:{name:le.get("chatbot.livechat.name"),picture:null},read:!0,rel:n===0?"welcome":"nespresso_chatbot"})})}reConnection(e=null){return!0}restoreConnection(){}beforePageUnload(){}flush(){}closeConnection(){this._clearExpirationTimeout()}get hasConnection(){return!0}sendPresence(e={}){}_getNextMessageCount(){return this._msgCount++,this._msgCount}sendMessage(e={},n=!1){G.sendAction(this._requestId,"chat",{message:e.body},i=>{if(document.querySelectorAll(".nlc-btn-loader").forEach(a=>a.remove()),!i.id||!i.action||!i.elements||!i.nickname)throw new Error("Invalid response payload");const s={id:i.id,message:"",image:"",operator:{name:i.nickname,picture:""},rel:"nespresso_chatbot",read:!1,chatbot:{elements:i.elements}};d.dispatch("receiveMessage",s);const r=this._getQuickReplyAnswers(i.elements);d.commit(Wa,r),i.action!==Mn.NONE&&this._dispatcher.emit("chatbot.response-action",i.action),d.dispatch("handleChatbotAction",{action:i.action,canHandover:i.canHandover,isAsyncChat:i.isAsyncChat,handoverEnabled:i.handoverEnabled}),this._updateExpirationTimeout()},i=>{console.warn(i),d.dispatch("receiveMessage",{id:"error",message:le.get("chatbot.error"),operator:{},read:!0,rel:"welcome"})},"chatbot")}pushMessageReceiptQueue(e,n){}sendIQ(e={}){}getExplodeJidData(e){}_getQuickReplyAnswers(e){const n=[];return e.forEach(i=>{(i.type===xe.QUICK_REPLY||i.type===xe.TEXT_WITH_BUTTONS||i.type===xe.CAROUSEL)&&i.answers&&i.answers.forEach(s=>{const r={text:s.text,payload:null};s.payload&&(r.payload=s.payload),n.push(r)})}),n}_updateExpirationTimeout(e=!0){const n=Math.floor(Date.now()/1e3);if(e&&d.commit(Xa,n),this._clearExpirationTimeout(),d.state.chatbotLastActivity>0&&d.state.chatbotContext===ie.CHATBOT_ONLY){const i=d.state.chatbotLastActivity+(this._expirationTimeout-n);this._expirationTimeoutId=setTimeout(()=>{this._dispatcher.emit("chatbot.end")},i*1e3)}}_clearExpirationTimeout(){this._expirationTimeoutId!==null&&(clearTimeout(this._expirationTimeoutId),this._expirationTimeoutId=null)}}class Jp{constructor(e,n,i=window){this._win=i,this._datalayer=e,this._dispatcher=n,this.datalayerState=null,this._registerAnchorChange(),this._registerHtml5PushState(),this._registerCartUpdate()}getCurentDatalayerState(){const e=this._datalayer;e.load();const n={url:this._win.location.href,pageId:e.pageId,isLoggedIn:e.isLoggedIn,customer:{firstName:e.firstName,lastName:e.lastName,email:e.email,nessClubId:e.nessClubId,city:e.city,zip:e.zip},customerSegment:e.customerSegment,cart:Object.assign({},e.cart)};return JSON.stringify(n)}startDatalayerObserve(){return this.datalayerState=this.getCurentDatalayerState(),this.datalayerState}stopDatalayerObserve(){this.datalayerState=null}_checkDatalayerChange(){const e=this.getCurentDatalayerState();e!==this.datalayerState&&(this.datalayerState=e,this._dispatcher.emit("datalayer.change",e))}_registerAnchorChange(){"onhashchange"in this._win&&this._win.addEventListener("hashchange",()=>{this._win.setTimeout(()=>{this._dispatcher.emit("history.hashchange",this._win.location.hash)},0)},!1),this._dispatcher.on("history.hashchange",()=>{this._checkDatalayerChange()})}_registerHtml5PushState(){const e=this._win.history;if(e&&typeof e.pushState=="function"){const n=e.pushState;e.pushState=(...i)=>{try{this._win.setTimeout(()=>{this._dispatcher.emit("history.pushState",...i)},0)}catch(s){}return n.apply(e,i)}}this._dispatcher.on("history.pushState",()=>{this._checkDatalayerChange()})}_registerCartUpdate(){let e=!1;try{window.napi&&(window.napi.data().on("cart.*",n=>{n==="cart.update"&&this._win.setTimeout(()=>{this._dispatcher.emit("cart.updated")},0)}),e=!0)}catch(n){console.warn(`cannot register cart update by napi ${n}`)}if(!e)try{this._win.jQuery&&this._win.jQuery(document).on("cartUpdated",()=>{this._win.setTimeout(()=>{this._dispatcher.emit("cart.updated")},0)})}catch(n){console.warn(`cannot register cart update by jquery ${n}`)}this._dispatcher.on("cart.updated",()=>{this._checkDatalayerChange()})}}class Vp{constructor(e){e.on("xmpp.presence",this.handleInvitation.bind(this)),e.on("xmpp.message",this.handleAssignment.bind(this))}handleInvitation(e,n,i,s){const r=h.getResourceFromJid(s.getAttribute("from")),a=h.getNodeFromJid(s.getAttribute("to"));if(r!==a)return;const o=s.querySelector('x status[code="307"]'),c=s.querySelector('x status[code="301"]');if(o||c){const f=s.querySelector("x item reason");if(f&&f.textContent.substr(0,5)==="INVT:"){const g=h.getBareJidFromJid(f.textContent.substr(5));if(!String(g).startsWith("op_"))return;this.sendAccept(e,g),Z.quitTheWaitingQueue();const E=s.querySelector("x item actor");this.updateXmppSession(E,g)}}}handleAssignment(e,n,i,s){if(!!String(n).startsWith("op_")&&s.textContent.substr(0,5)==="INVT:"){const r=h.getBareJidFromJid(s.textContent.substr(5));if(!String(r).startsWith("op_"))return;this.sendAccept(e,r),Z.quitTheWaitingQueue();const a=s.querySelector("x item actor");this.updateXmppSession(a,r)}}updateXmppSession(e,n){d.dispatch("switchAsyncChatToLiveAgentChat"),e&&e.getAttribute("nick")?d.dispatch("updateXmppSession",{operatorXid:n,operatorNick:e.getAttribute("nick"),lastOperatorChange:new Date().getTime()}):d.dispatch("updateXmppSession",{operatorXid:n,lastOperatorChange:new Date().getTime()})}sendAccept(e,n){try{e.sendMessage({_attrs:{to:n,type:"chat"},invtd:{_attrs:{xmlns:"invitation:chat:ok"},_:"ok"}}),e.sendPresence({_attrs:{type:"subscribe",to:n}})}catch(i){console.error(i)}}}class Yp{constructor(e){this.sendPresenceInterval=null,e.on("xmpp.presence",this.handlePresence.bind(this)),e.on("xmpp.attached",this.handleChatAttached.bind(this))}handlePresence(e,n,i,s,r){n===d.state.xmppSession.operatorXid&&(r==="unavailable"&&(d.dispatch("disconnected"),e.sendMessage({_attrs:{to:n,type:"chat"},reloadRequestId:d.state.request.id}),this.handleChatAttached(e)),(!r||r==="available"||r==="subscribe"||r==="subscribed")&&d.state.disconnected&&(e.sendPresence({_attrs:{type:"subscribed",to:n}}),e.sendPresence({_attrs:{to:n,type:"available"},reloadRequestId:d.state.request.id}),this.clearInterval(),d.dispatch("reconnected"))),r==="subscribe"?(e.sendPresence({_attrs:{type:"subscribed",to:n}}),e.sendPresence({_attrs:{type:"subscribe",to:n}})):r==="unsubscribe"&&d.state.xmppSession.operatorXid}handleChatAttached(e){this.clearInterval(),d.state.disconnected&&d.state.request.id&&d.state.xmppSession.operatorXid&&e.hasConnection&&(e.sendPresence({_attrs:{to:d.state.xmppSession.operatorXid,type:"available"},reloadRequestId:d.state.request.id}),this.sendPresenceInterval=window.setInterval(()=>{d.state.disconnected&&d.state.request.id&&d.state.xmppSession.operatorXid&&e.hasConnection?e.sendPresence({_attrs:{to:d.state.xmppSession.operatorXid,type:"available"},reloadRequestId:d.state.request.id}):this.clearInterval()},1e4))}clearInterval(){this.sendPresenceInterval&&(window.clearInterval(this.sendPresenceInterval),this.sendPresenceInterval=null)}}class Kp{constructor(e){e.on("xmpp.message",this.handleState.bind(this))}handleState(e,n,i,s){if(!!String(n).startsWith("op_")&&(s.querySelector("active")||s.querySelector("paused")||s.querySelector("inactive")?d.dispatch("stopTyping"):s.querySelector("composing")&&d.dispatch("startTyping",{name:d.state.xmppSession.operatorNick,avatar:d.state.xmppSession.operatorAvatar}),s.querySelector("x finish"))){const r=Boolean(s.querySelector("banUser"));d.dispatch("closeChat",{source:r?"op_ban":"operator",blockUser:r})}}}class Zp{constructor(e){e.on("xmpp.message",this.handleMessage.bind(this))}handleMessage(e,n,i,s,r,a){if(!!String(n).startsWith("op_")&&(r==="chat"||r==="normal")){let o=s.querySelector("image");if(o&&(o=o.textContent),!o&&!a)return;let c=d.state.xmppSession.operatorAvatar;const f=s.querySelector("avatar"),g=s.getAttribute("id");f&&(c=f.textContent,d.dispatch("updateXmppSession",{operatorAvatar:c})),d.dispatch("receiveMessage",{id:g,message:a,image:o,operator:{name:d.state.xmppSession.operatorNick,picture:c},read:!1}),n!==d.state.settings.virtual_agent_xid&&d.state.xmppSession.operatorXid!==n&&(!d.state.xmppSession.lastOperatorChange||new Date().getTime()-d.state.xmppSession.lastOperatorChange>5e3)&&(d.dispatch("switchAsyncChatToLiveAgentChat"),d.dispatch("updateXmppSession",{operatorXid:n}),e.sendPresence({_attrs:{type:"subscribe",to:n}}))}}}class eg{constructor(e){e.on("xmpp.receipts",this.handleReceipt.bind(this))}handleReceipt(e){d.dispatch("receiveReceipt",e)}}const tg="unavailable",ng="conference",Ar="visitor",xr=1e3;class ig{constructor(e){this.customersInQueue=d.state.xmppSession.customersInQueue?this._cloneQueue(d.state.xmppSession.customersInQueue):{},e.on("xmpp.presence",this.handlePresencesMessage.bind(this)),e.on("livechat.userJoined",this.handleLivechatUserJoined.bind(this)),e.on("livechat.userLeft",this.handleLivechatUserLeft.bind(this)),this.nbBeforeMe=null,this._dispatcher=e,this._timeout=null}handlePresencesMessage(e,n,i,s,r){if(n.indexOf(ng)===-1)return;const a=h.getResourceFromJid(s.getAttribute("from")),o=h.getNodeFromJid(s.getAttribute("to"));if(a===o){this.entryTime||(this.entryTime=new Date().getTime()),window.setTimeout(()=>{this.nbBeforeMe===null&&this.updateQueueSize()},xr);return}r===tg?this.removeCustomerInQueue(a):this.pushCustomerInQueue(s,a),this._updateQueueSizeTimed()}handleLivechatUserJoined(e,n,i,s){const r=document.createElement("message");r.innerHTML=`<x><item role="${Ar}"></item></x><priority>${n}</priority><rqTime>${i}</rqTime><priorityTimeFactor>${s}</priorityTimeFactor>`,this.pushCustomerInQueue(r,e),this._updateQueueSizeTimed()}handleLivechatUserLeft(e){this.removeCustomerInQueue(e),this._updateQueueSizeTimed()}pushCustomerInQueue(e,n){const i=e.querySelector("x item");if(i&&i.getAttribute("role")===Ar){let s={},r=!0;Object.prototype.hasOwnProperty.call(this.customersInQueue,n)&&(s=this.customersInQueue[n],r=!1);const a=e.querySelector("priority");a?s.priority=parseInt(a.textContent,10):r&&(s.priority=0);const o=e.querySelector("rqTime");o?s.rqTime=parseInt(o.textContent,10):r&&(s.rqTime=Math.ceil(new Date().getTime()/1e3)-d.state.request.timeDiffServer);const c=e.querySelector("priorityTimeFactor");c?s.priorityTimeFactor=parseFloat(c.textContent):s.priorityTimeFactor=1,this.customersInQueue[n]=s}}removeCustomerInQueue(e){return Object.prototype.hasOwnProperty.call(this.customersInQueue,e)?(delete this.customersInQueue[e],!0):!1}updateQueueSize(){const e=cn.setStore(d).getCurrentPriority();let n=0;const i=Object.values(this.customersInQueue);i.forEach(s=>{cn.computePriority(s.rqTime,s.priority,s.priorityTimeFactor)>e&&n++}),this.nbBeforeMe=n,d.dispatch("updateXmppSession",{customersInQueue:this._cloneQueue(this.customersInQueue)}),this._dispatcher.emit("livechat.queue-size",n,i.length+1,e),d.dispatch("queueWaitingSize",n)}_updateQueueSizeTimed(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._timeout=window.setTimeout(()=>{this.updateQueueSize()},this.nbBeforeMe===null?xr:200)}_cloneQueue(e){const n={};return Object.keys(e).forEach(s=>{const r=e[s];n[s]=Object.assign({},r)}),n}}class sg{constructor(e){e.on("xmpp.message",this.handleMessage.bind(this))}handleMessage(e,n,i,s,r,a){if(!String(n).startsWith("op_"))return;const o=s.querySelector("attachment"),c=s.getAttribute("id");o&&a&&d.dispatch("receiveMessage",{id:c,message:a,attachment:{name:a,location:o?o.textContent:a},operator:{name:d.state.xmppSession.operatorNick,picture:d.state.xmppSession.operatorAvatar},read:!1})}}const rg="conference",ag="unavailable",og="away",lg="moderator",cg="visitor";class ug{constructor(e){this.operatorsInQueue=d.state.xmppSession.operatorsInQueue||{},e.on("xmpp.presence",this.handlePresence.bind(this))}handlePresence(e,n,i,s,r){if(n.indexOf(rg)===-1)return;const a=s.querySelector("x item");if(!a)return;const o=a.getAttribute("role");if(o===cg)return;const c=s.querySelector("show"),f=h.getResourceFromJid(s.getAttribute("from")),g=Object.prototype.hasOwnProperty.call(this.operatorsInQueue,f);let E=null;c&&(E=c.textContent),r===ag||E===og?g&&(delete this.operatorsInQueue[f],d.dispatch("updateXmppSession",{operatorsInQueue:Object.assign({},this.operatorsInQueue)})):(o===lg||!(f.indexOf("livechat(")===0||f.indexOf("vchat(")===0))&&(g||(this.operatorsInQueue[f]=1,d.dispatch("updateXmppSession",{operatorsInQueue:Object.assign({},this.operatorsInQueue)})))}}class dg{constructor(e){e.on("xmpp.message",this.handleMessage.bind(this))}handleMessage(e,n,i,s){if(!!String(n).startsWith("op_")&&d.getters.currentOperatorXid&&d.getters.currentOperatorXid!==n&&s.querySelector("chatTransfer")){const a=s.querySelector("nick");if(!a)return;const o=a.textContent;let c=null;e.sendPresence({_attrs:{type:"subscribe",to:n}});const f=s.querySelector("avatar");f&&(c=f.textContent),d.dispatch("chatTransfered",{name:o,picture:c}),d.dispatch("switchAsyncChatToLiveAgentChat"),d.dispatch("updateXmppSession",{operatorXid:n,operatorNick:o,operatorAvatar:c,lastOperatorChange:new Date().getTime()}),Z.sendDatalayer(),window.setTimeout(()=>{d.dispatch("sendChatState","active")},2e3)}}}class hg{constructor(e){e.on("xmpp.message",this.handleState.bind(this))}handleState(e,n,i,s){!String(n).startsWith("op_")||s.querySelector("request-ping-state")&&Z.sendCurrentState2Agent()}}class fg{constructor(e){this._resendPresenceTimeOut=null,e.on(`xmpp.message.${ge.PUSH_ASSIGNED}`,this.handleMessage.bind(this)),e.on(`xmpp.message.${ge.PUSH_UNASSIGNED}`,this.handleMessage.bind(this)),e.on("xmpp.attached",this.loadSendPresenceTimeOut.bind(this))}handleMessage(e,n,i,s,r,a){try{if(String(n).startsWith("op_")){if(d.state.xmppSession.operatorXid)return}else return;if(s.getElementsByTagName("subject").length===0)return;switch(a.action){case ge.PUSH_ASSIGNED:Z.quitTheWaitingQueue(),d.commit(Ui,Date.now()+a.reassignmentTime*1e3),this.loadSendPresenceTimeOut();break;case ge.PUSH_UNASSIGNED:Z.sendPresenceToWaitingQueue(),Z.enableResendPresenceInterval();break;default:return}}catch(o){console.error(o)}}sendPresenceTimeOut(e){this.clearSendPresenceTimeOut(),this._resendPresenceTimeOut=setTimeout(()=>{d.state.xmppSession.operatorXid||Z.sendPresenceToWaitingQueue(),d.commit(Ui,null),this.clearSendPresenceTimeOut()},e)}clearSendPresenceTimeOut(){this._resendPresenceTimeOut&&(clearTimeout(this._resendPresenceTimeOut),this._resendPresenceTimeOut=null)}loadSendPresenceTimeOut(){if(d.state.push.sendPresenceTimestamp){let e=d.state.push.sendPresenceTimestamp-Date.now();e<0&&(e=0),this.sendPresenceTimeOut(e)}}}class pg{constructor(e){e.on("livechat.registerJid",this.handleRegisterJid.bind(this)),e.on(`xmpp.message.${ge.USER_LEFT}`,this.handleMessage.bind(this)),this._dispatcher=e}handleRegisterJid(e){if(!!e.instant_messaging){e=e.instant_messaging;for(const n of e.requests)this._dispatcher.emit("livechat.userJoined",h.getNodeFromJid(n.jid),n.priority,n.rqTime,n.priorityTimeFactor)}}handleMessage(e,n,i,s,r,a){const o=a.action,c=a.data;switch(o){case ge.USER_LEFT:this._dispatcher.emit("livechat.userLeft",h.getNodeFromJid(c.request.jid));break}}}class gg{constructor(e){e.on(`xmpp.message.${ge.TERMINATE_XMPP_SESSION}`,this.handleMessage.bind(this)),e.on(`xmpp.message.${ge.CHAT_STANDBY}`,this.handleMessage.bind(this)),e.on(`xmpp.message.${ge.CHAT_WAKEUP}`,this.handleMessage.bind(this)),e.on(`xmpp.message.${ge.CHAT_FINISH}`,this.handleMessage.bind(this)),this._dispatcher=e}handleMessage(e,n,i,s,r,a){const o=a.action,c=a.data;switch(c.settingsUpdate&&d.dispatch("updateSettings",c.settingsUpdate),o){case ge.TERMINATE_XMPP_SESSION:d.dispatch("asyncChatSessionClosed",c);break;case ge.CHAT_FINISH:d.dispatch("closeChat",{source:c.endSource});break;case ge.CHAT_STANDBY:case ge.CHAT_WAKEUP:d.dispatch("asyncChatStandbyChange",c);break}}}class mg{constructor(e){e.on(`xmpp.message.${ge.ASK_SCREEN_MIRRORING}`,this.handleAskScreenMirroringMessage.bind(this)),e.on(`xmpp.message.${ge.CANCEL_ASK_SCREEN_MIRRORING}`,this.handleCancelAskScreenMirroringMessage.bind(this)),e.on(`xmpp.message.${ge.RTC_SIGNALING}`,this.handleSignalingMessage.bind(this))}handleAskScreenMirroringMessage(e,n){!String(n).startsWith("op_")||d.dispatch("ScreenMirroring/receiveInvitation")}handleCancelAskScreenMirroringMessage(e,n){!String(n).startsWith("op_")||d.dispatch("ScreenMirroring/receiveCancelInvitation")}handleSignalingMessage(e,n,i,s,r,a){!String(n).startsWith("op_")||(a.rtcAction==="ready"&&Xe.start(),Xe.signalingMessage({type:a.rtcAction,payload:a.payload||null}))}}class _g{constructor(e){e.on("xmpp.message",this.handleState.bind(this))}handleState(e,n,i,s){if(!!String(n).startsWith("op_")&&s.querySelector("request-state-for-issue-report")&&d.state.xmppSession.operatorXid){const r={_attrs:{type:"chat",to:d.state.xmppSession.operatorXid},requestId:d.state.request.id};r["vue-state-for-issue-report"]=fe.encodeUnicode64(JSON.stringify({state:d.state,config:K})),e.sendMessage(r)}}}class vg{constructor(){this._client=null,this._dispatcher=null,this._config=null,this._currentChatState=null,this._currentPageState=null,this._datalayerObserver=null,this._sendErrorTimeout=null,this._restoreTimeout=null,this._isChatRestore=!1,this._retryLogin=0,this._disableRetry=!1,this._resendPresenceInterval=null}get client(){return!this._client&&this._config&&this._dispatcher&&(this._client=d.state.request.chatbotStatus===ie.CHATBOT_ONLY?new Er(this._config,d.state.request.id,d.state.access.username,d.state.access.password,this._dispatcher):new pi(this._config,d.state.request.id,d.state.access.username,d.state.access.password,this._dispatcher),this._config.apiSettings.sendError&&window.addEventListener("beforeunload",()=>{this._sendErrorTimeout&&(window.clearTimeout(this._sendErrorTimeout),this._sendErrorTimeout=null,this._sendError("beforeunload",{},!0))})),this._client}get nickname(){if(!this._nickName){let e;const n=d.state.profile;n&&n.firstName&&(e=`${n.firstName} ${n.lastName}`.trim()),e||(e=le.get("livechat.anonymous_nickname")),this._nickName=e}return this._nickName}get isConnected(){return this._client&&this._client.hasConnection}initializeDependencies(e,n){this._config=e,this._dispatcher=n,this._datalayerObserver=new Jp(te,n),this._registerBehaviors()}startChat(){this._isChatRestore=!1,this.client.startNewConnection(),this._setChatbotContext()}restoreChat(){this._isChatRestore=!0,this._retryLogin++;try{this._retryLogin===1?this.client.restoreConnection(d.state.xmppSession.jid):(this._cleanUpClient(),this.client.reConnection(d.state.xmppSession.jid))}catch(e){this._retryLogin===1?(this._cleanUpClient(),this.client.reConnection(d.state.xmppSession.jid)):(this.client.addLastInfo("error",e),this.sendError("restoreChat"),this._endCurentChat({source:"restore"}))}}restoreFailChatRetry(e){if(this._disableRetry||this._restoreTimeout)return;if(d.dispatch("disconnected"),this._retryLogin>40){this.sendError("xmpp.fail-connection"),d.dispatch("apiError","XMPP fail connection"),this._endCurentChat(e);return}this._restoreTimeout&&(window.clearTimeout(this._restoreTimeout),this._restoreTimeout=null);let n=1e3;this._retryLogin>10?n=2e3:this._retryLogin>20?n=5e3:this._retryLogin>30&&(n=1e4),this._restoreTimeout=window.setTimeout(()=>{this._restoreTimeout=null,this._isChatRestore&&d.dispatch("restoreChat")},n)}beforePageUnload(){this.isConnected&&this._client.beforePageUnload()}_cleanUpClient(){this._client&&(this._disableRetry=!0,this._client.closeConnection(),this._disableRetry=!1,this._client=null)}resetClient(){this._cleanUpClient()}finishChat(){this.disableResendPresenceInterval(),this._cleanUpClient(),d.dispatch("updateXmppSession",{node:null,bareJid:null,resource:null,chatState:null,operatorXid:null,operatorNick:null,operatorAvatar:null,operatorsInQueue:null})}_endCurentChat(e){this._isChatRestore=!1,d.state.workflow===Le?d.dispatch("cancelRequest",e):d.state.workflow===_e&&d.dispatch("closeChat",e)}updateProfile(){this._nickName=null,this.sendVCard(),d.state.xmppSession.operatorXid&&this.client.sendPresence({_attrs:{to:d.state.xmppSession.operatorXid},updateProfile:1,requestId:d.state.request.id})}sendVCard(){const e=this.nickname;this.client.sendIQ({_attrs:{type:"set"},vCard:{_attrs:{xmlns:"vcard-temp"},FN:e,NICKNAME:e,URL:`${d.state.request.id}`}})}sendChatState(e){this._currentChatState!==e&&d.state.xmppSession.operatorXid&&(this._currentChatState=e,this.sendCurrentState2Agent())}sendPageState(e){this._currentPageState!==e&&d.state.xmppSession.operatorXid&&(this._currentPageState=e,this.sendCurrentState2Agent())}sendCurrentState2Agent(){if(this._currentChatState&&d.state.xmppSession.operatorXid){const e={_attrs:{type:"chat",to:d.state.xmppSession.operatorXid},requestId:d.state.request.id};e[this._currentChatState]={_attrs:{xmlns:"http://jabber.org/protocol/chatstates"}},d.state.message&&(e["composing-msg"]=d.state.message),this._currentPageState&&(e["page-state"]=this._currentPageState),console.debug(this._currentChatState,this._currentPageState),this.client.sendMessage(e)}}_genMessageNode(e){return{_attrs:{type:"chat",to:d.getters.currentOperatorXid},body:e,requestId:d.state.request.id,active:{_attrs:{xmlns:"http://jabber.org/protocol/chatstates"}}}}sendMessage(e){if(this._client instanceof Er)return this.client.sendMessage(this._genMessageNode(e));if(this._client instanceof pi&&d.getters.currentOperatorXid)return this._currentChatState=null,this.client.sendMessage(this._genMessageNode(e),!d.getters.isChattingWithVirtualAgent)}clearReceipts(){this._client instanceof pi&&this._client.clearReceipts()}_genMessageAttachmentNode(e,n){return{_attrs:{type:"attachment",to:d.getters.currentOperatorXid},body:e,requestId:d.state.request.id,attachment:n,active:{_attrs:{xmlns:"http://jabber.org/protocol/chatstates"}}}}sendAttachment(e,n){if(d.getters.currentOperatorXid)return this.client.sendMessage(this._genMessageAttachmentNode(e,n),!0)}restoreReceiptsQueue(){try{d.state.xmppSession.operatorXid&&d.state.messages.forEach(e=>{if(e.rel==="client"&&e.receipt===!1){let n;e.attachment?n=this._genMessageAttachmentNode(e.attachment.name,e.attachment.location):n=this._genMessageNode(e.messageRaw),this.client.pushMessageReceiptQueue(e.id,n)}})}catch(e){this.client.addLastInfo("error",e),this.sendError("restoreReceiptsQueue")}}sendFinishChat(e){if(this._client){if(d.getters.currentOperatorXid){const n={_attrs:{to:d.getters.currentOperatorXid,type:"chat"},finish:{reason:"CUSTOMER",source:e},requestId:d.state.request.id};this._client.sendMessage(n)}this._client.flush()}}enableResendPresenceInterval(){d.state.request.asyncEnabled||(this.disableResendPresenceInterval(),this._resendPresenceInterval=window.setInterval(()=>{d.state.xmppSession.operatorXid?this.disableResendPresenceInterval():(!d.state.xmppSession.operatorsInQueue||Object.keys(d.state.xmppSession.operatorsInQueue||{}).length===0)&&this.sendPresenceToWaitingQueue()},6e4))}disableResendPresenceInterval(){this._resendPresenceInterval&&(window.clearInterval(this._resendPresenceInterval),this._resendPresenceInterval=null)}quitTheWaitingQueue(){if(d.state.request.asyncEnabled)return;this.disableResendPresenceInterval();const e=d.state.request,n={_attrs:{to:`${e.marketId}_${e.replyLang}@conference.${this._config.livechatHost}/${d.state.xmppSession.node}`,type:"unavailable"}};this.client.sendPresence(n)}sendPresenceToWaitingQueue(){if(d.state.request.asyncEnabled)return;const e=d.state.request,n={_attrs:{to:`${e.marketId}_${e.replyLang}@conference.${this._config.livechatHost}/${d.state.xmppSession.node}`},x:{_attrs:{xmlns:"http://jabber.org/protocol/muc"},history:{_attrs:{maxstanzas:0,seconds:0}}},country:`${e.country}`,category:`${e.categoryId}`,requestId:`${e.id}`,channel:`${e.channel}`,priority:`${e.priority}`,rqTime:`${e.rqTime}`,status:`${e.status}`,appVersion:`${this._config.app_version}`};d.state.messages.length>0&&d.state.settings.only_on_response&&d.state.messages[0].rel==="welcome"&&!d.state.confirmedHandover?n.welcomeMsg=d.state.messages[0].message:d.state.confirmedHandover&&(n.welcomeMsg=le.get("chatbot.welcome_handover")),this.client.sendPresence(n)}_registerBehaviors(){this._dispatcher.on("xmpp.connected",(e,n)=>{if(this._retryLogin=0,d.dispatch("apiErrorFinish"),this._isChatRestore){e.sendPresence(),d.state.workflow===_e&&d.state.xmppSession.operatorXid?(e.sendPresence({_attrs:{type:"available",to:d.state.xmppSession.operatorXid}}),e.sendPresence({_attrs:{type:"subscribe",to:d.state.xmppSession.operatorXid}}),this.sendDatalayer(),this.restoreReceiptsQueue()):(this.sendPresenceToWaitingQueue(),this.enableResendPresenceInterval()),d.dispatch("reconnected"),this._isChatRestore=!1;return}const i=d.state.request;G.registerJid(n,i.id);const s=e.getExplodeJidData(n);d.dispatch("updateXmppSession",s),e.sendPresence(),d.dispatch("updateRequestData",{priority:cn.setStore(d).computeStaticPriority()}),this.sendPresenceToWaitingQueue(),this.enableResendPresenceInterval(),this.updateProfile(),this._datalayerObserver.startDatalayerObserve(),d.dispatch("xmppConnected")}),this._dispatcher.on("xmpp.attached",()=>{d.state.workflow===_e&&d.state.xmppSession.operatorXid?(this.sendDatalayer(),this.restoreReceiptsQueue()):((!d.state.xmppSession.operatorsInQueue||Object.keys(d.state.xmppSession.operatorsInQueue||{}).length===0)&&this.sendPresenceToWaitingQueue(),this.enableResendPresenceInterval())}),this._dispatcher.on("xmpp.fail-connection",()=>{this._isChatRestore=!0,this.restoreFailChatRetry({source:"failcon"})}),this._dispatcher.on("xmpp.error",()=>{this.sendError("xmpp.error")}),this._dispatcher.on("xmpp.authfail",()=>{this._endCurentChat({source:"authfail"}),this._isChatRestore||this.sendError("xmpp.authfail")}),this._dispatcher.on("xmpp.disconnected",()=>{(d.state.workflow===Le||d.state.workflow===_e)&&(this._isChatRestore=!0,this.restoreFailChatRetry({source:"discon"})),this._datalayerObserver.stopDatalayerObserve()}),this._dispatcher.on("datalayer.change",e=>{this.sendDatalayer(e)}),this._dispatcher.on("chatbot.end",()=>{d.dispatch("closeChat",{source:"chatbot"})}),new Vp(this._dispatcher),new Yp(this._dispatcher),new Kp(this._dispatcher),new dg(this._dispatcher),new Zp(this._dispatcher),new eg(this._dispatcher),new ig(this._dispatcher),new sg(this._dispatcher),new ug(this._dispatcher),new hg(this._dispatcher),new _g(this._dispatcher),new fg(this._dispatcher),new pg(this._dispatcher),new gg(this._dispatcher),new mg(this._dispatcher)}sendDatalayer(e=null){if(d.state.workflow===_e&&d.state.xmppSession.operatorXid&&d.state.xmppSession.operatorXid!==d.state.settings.virtual_agent_xid){e||(e=this._datalayerObserver.startDatalayerObserve());const n=JSON.parse(e);n.screenMirroringCapable="RTCPeerConnection"in window&&"MutationObserver"in window,e=JSON.stringify(n),this.client.sendPresence({_attrs:{to:d.state.xmppSession.operatorXid},datalayer:fe.encodeUnicode64(e),rqpriority:d.state.request.priority,rqdelay:Math.round((d.state.request.rqTakeAt-d.state.request.rqStartAt)/1e3)})}}sendError(e,n=null){this._config&&this._config.apiSettings.sendError&&(n||this._client===null?this._sendError(e,n||{}):(this._client.addLastInfo("message",e),this._sendErrorTimeout&&(window.clearTimeout(this._sendErrorTimeout),this._sendErrorTimeout=null),this._sendErrorTimeout=window.setTimeout(()=>{this._sendErrorTimeout=null,this._sendError(e)},5e3)))}_sendError(e,n={},i=!1){typeof e=="object"&&e!==null&&(e=`JSError: ${Error.prototype.toString.call(e)}`),this._client&&(n.lastMessage=this._client.getLastInfo("message"),n.lastResponse=this._client.getLastInfo("response"),n.lastRequest=this._client.getLastInfo("request"),n.lastError=this._client.getLastInfo("error")),G.sendErrorToServer(e,n,i),this._client&&this._client.clearLastInfo("message")}_setChatbotContext(){this._config.apiSettings.chatbot_enabled?d.state.chatbotContext!==ie.CHATBOT_HANDOVER&&d.dispatch("updateChatbotContext",ie.CHATBOT_ONLY):d.dispatch("updateChatbotContext",ie.NO_CHATBOT)}}class yg{constructor(e,n=window){this._win=n,this._translator=e,this._reset()}_reset(){this.pageId="",this.title="",this.firstName="",this.lastName="",this.email="",this.nessClubId="",this.nessClubLevel="",this.isLoggedIn="",this.city="",this.zip="",this.customerSegment={},this.billingAddress=null,this.deliveryAddress=null,this.cart={nbItem:0,nbUniqueItem:0,totalAmount:0,currency:"",items:[]},this.cartExtend={names:[],categories:[]}}init(e,n,i){this.market=e,this.language=n,this.channel=i}load(){try{this._reset(),this._retrieveStoreData(),this.map()}catch(e){console.error(e)}}map(){this._mapGeneric(),this._mapCustomer(),this._mapCart()}_getFromStorage(e,n=null){try{let i=this._win.sessionStorage.getItem(e);if(i||(i=this._win.localStorage.getItem(e)),i){const s=JSON.parse(i);return n?s&&typeof s[n]!="undefined"?s[n]:(console.warn(`datalayer cannot get ${n} from ${e}`),null):s}}catch(i){console.warn(`datalayer cannot read ${e}`)}return null}_retrieveStoreData(){try{this._padl=this._win.padl&&this._win.padl.events?this._win.padl.events:this._win.padl}catch(e){console.warn(`datalayer cannot read padl from window ${e}`)}this._padl2=this._getFromStorage(`padl-${this.channel}-${this.market}`),this._cart=this._getFromStorage(`cart-${this.market}-${this.channel}`,"cartLines"),this._cart||(this._cart=this._getFromStorage(`cart-${this.market}`)),this._customerInfo=this._getFromStorage(`customerInfo-${this.market}`),this._products=this._getFromStorage(`products-${this.market}-${this.language}-${this.channel}`),this._products||(this._products=this._getFromStorage(`products-${this.market}-${this.language}`)),this._categories=this._getFromStorage(`categories-${this.market}-${this.language}-${this.channel}`),this._categories||(this._categories=this._getFromStorage("categories"));try{const e=this._getFromStorage(`customerAddressesCache-${this.market}`,"value");if(e)for(let n=0;n<e.length;n++)e[n].defaultBilling&&(this.billingAddress=e[n]),e[n].defaultDelivery&&(this.deliveryAddress=e[n])}catch(e){console.warn(`datalayer cannot read customerAddressesCache ${e}`)}}_mapCustomer(){this._win.padl&&this._win.padl.user?this.isLoggedIn=this._win.padl.user.isLoggedIn:this.isLoggedIn=!1,this.isLoggedIn&&(this._win.padl&&this._win.padl.user&&this._win.padl.user.clubMember?this._mapFromPadl(this._win.padl):this._padl&&this._padl.user&&this._padl.user.clubMember?this._mapFromPadl(this._padl):this._padl2&&this._padl2.user&&this._padl2.user.clubMember&&this._mapFromPadl(this._padl2),this.billingAddress&&(!this.title&&this.billingAddress.civility&&(this.title=this._convertTitle(this.billingAddress.civility.label)),this.firstName||(this.firstName=this.billingAddress.firstName),this.lastName||(this.lastName=this.billingAddress.name),this.city=this.billingAddress.city||"",this.zip=this.billingAddress.zipCode||""),this._customerInfo&&(this.title||(this.title=this._convertTitle(this._customerInfo.civility)),this.firstName||(this.firstName=this._customerInfo.firstName),this.lastName||(this.lastName=this._customerInfo.lastName),this.email||(this.email=this._customerInfo.email)))}_mapFromPadl(e){if(e.user&&e.user.clubMember){const n=e.user.clubMember;if(this.title=this._convertTitle(n.clubMemberTitle),this.firstName=n.clubMemberFirstName||"",this.lastName=n.clubMemberLastName||"",this.email=n.clubMemberEmail||"",this.nessClubId=n.clubMemberID||"",this.nessClubLevel=(n.clubMemberLevel||"").toLowerCase(),this.customerSegment={},n.clubMemberTierID&&n.clubMemberLevel){const i=String(n.clubMemberTierID).toLowerCase().split(","),s=String(n.clubMemberLevel).toLowerCase().split(",");for(let r=0;r<i.length;r++)this.customerSegment[String(i[r]).trim()]=String(s[r]).trim()}}}_mapGeneric(){try{this._padl&&this._padl.navigation&&this._padl.navigation.pageView&&this._padl.navigation.pageView[this._padl.navigation.pageView.length-1]&&(this.pageId=this._padl.navigation.pageView[this._padl.navigation.pageView.length-1].page.pageInfo.breadcrumbUID)}catch(e){console.error(e)}try{this._padl&&this._padl.navigation&&this._padl.navigation.pageView&&this._padl.navigation.pageView[this._padl.navigation.pageView.length-1]&&(this.pageId=this._padl.navigation.pageView[this._padl.navigation.pageView.length-1].page.pageInfo.breadcrumbUID)}catch(e){console.error(e)}}_mapCart(){let e=0,n=0,i=0;const s=[];if(this.cart.currency=this._win.padl&&this._win.padl.app&&this._win.padl.app.currency?this._win.padl.app.currency:"",this._cart)for(let r=0;r<this._cart.length;r++){const a=this._cart[r];n++,e+=a.quantity,i+=a.unitPrice*a.quantity,s.push(this._extractCartItem(a))}this.cart.items=s,this.cart.nbItem=e,this.cart.nbUniqueItem=n,this.cart.totalAmount=i,this.cartExtend.categories=this._arrayUnique(this.cartExtend.categories),this.cartExtend.names=this._arrayUnique(this.cartExtend.names)}_convertTitle(e){try{return this._translator.getListValue("titleMapping",String(e).trim().toLowerCase().replace(".",""))}catch(n){console.error(n)}return null}_extractCartItem(e){const n={productId:e.productId,quantity:e.quantity,unitPrice:e.unitPrice,icon:null,url:null,names:[],categories:[]},i=this._products&&this._products[e.productId];if(i){if(n.names.push(String(i.internationalId).trim()),n.names.push(String(i.internationalName).trim()),n.names.push(String(i.name).trim()),i.images&&i.images.icon){let s=`${this._win.location.protocol}//${this._win.location.host}`;(this._win.location.host.indexOf("docker")!==-1||this._win.location.host.indexOf(".contact.")!==-1)&&(s="https://www.nespresso.com"),n.icon=s+i.images.icon}if(i.pdpURLs&&i.pdpURLs.desktop&&(n.url=i.pdpURLs.desktop),n.categories.push(String(i.rootCategory).trim()),n.categories.push(String(i.category).trim()),n.categories=this._arrayUnique(n.categories),this.cartExtend.names.push(String(i.internationalId).toLowerCase().trim()),this.cartExtend.names.push(String(i.internationalName).toLowerCase().trim()),this.cartExtend.names.push(String(i.name).toLowerCase().trim()),this.cartExtend.categories.push(String(i.rootCategory).toLowerCase().trim()),this.cartExtend.categories.push(String(i.category).toLowerCase().trim()),this._categories&&i.supercategories)for(let s=0;s<i.supercategories.length;s++){const r=this._categories[i.supercategories[s]];r&&this.cartExtend.categories.push(String(r.name).toLowerCase().trim())}}return n}_arrayUnique(e){const n={},i=[];for(let s=0;s<e.length;s++)n[e[s]]=!0;for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&i.push(s);return i}prettyRenderHtml(){let e="<pre>",n;e+=`Datalayer Info
`,e+=`==============
`,e+=` - Page ID : ${this.pageId}
`,e+=`=> Client
`,["title","firstName","lastName","email","nessClubId","city","zip"].forEach(i=>{e+=` - ${i.charAt(0).toLowerCase()+i.slice(1)} : ${this[i]}
`}),e+=` - Is Logged In : ${this.isLoggedIn?"true":"false"}
`;for(const i in this.customerSegment)Object.prototype.hasOwnProperty.call(this.customerSegment,i)&&i&&this.customerSegment[i]&&(e+=` - Segmentation ${i} : ${this.customerSegment[i]}
`);e+=`=> Cart
`,e+=` - Nb Products : ${this.cart.nbUniqueItem}
`,e+=` - Total Amount : ${this.cart.currency} ${this.cart.totalAmount}
`,e+=` -> Items : 
`;for(let i=0;i<this.cart.items.length;i++)n=this.cart.items[i],e+=`    -> Product Names  : ${n.names.join(", ")}
`,e+=`       - categories   : ${n.categories.join(", ")}
`,n.url&&(e+=`       - url   : <a href="${n.url}">${n.url}</a>
`),n.icon&&(e+=`       - icon   : <a href="${n.icon}"><img width="50" src="${n.icon}"/></a>
`);return e+="</pre>",e}}class bg{constructor(e){this._datalayer=e,this._rules={}}setRules(e){e.waiting_time&&(e.waiting_time=parseInt(e.waiting_time,10)),this._rules=e}setStore(e){return this._store=e,this}computeStaticPriority(e=null){let n=[],i=0;return e||(e=this._store.state.request),this._datalayer.load(),Array.isArray(this._rules.customer_type)&&(i+=this._computeSimpleMatch(this._rules.customer_type,e.customerType)),Array.isArray(this._rules.source)&&(i+=this._computeSimpleMatch(this._rules.source,e.source)),["cart_size","cart_amount"].forEach(s=>{Array.isArray(this._rules[s])&&(n=n.concat(this._rules[s]))}),n.length>0&&n.forEach(s=>{const r=parseFloat(s.weight),a=this._datalayer.cart;if(r)switch(s.key){case"pro_item":i+=a.nbItem*r;break;case"pro_item_unique":i+=a.nbUniqueItem*r;break;case"pro_amount":r>0&&(i+=a.totalAmount/r);break}}),Array.isArray(this._rules.item_sku)&&(i+=this._computeNamesMatch(this._rules.item_sku,this._datalayer.cartExtend.names)),Array.isArray(this._rules.item_category)&&(i+=this._computeNamesMatch(this._rules.item_category,this._datalayer.cartExtend.categories)),Math.round(i)}getCurrentPriority(){const e=this._store.state.request;return this.computePriority(e.rqTime,e.priority,e.priorityTimeFactor)}computePriority(e,n,i=1){const s=this._store.state.request;if(this._rules.waiting_time){const r=Math.ceil(new Date().getTime()/1e3)-s.timeDiffServer-e;if(r)return n+r*i*this._rules.waiting_time}return n}_computeSimpleMatch(e,n){let i=0;return e.some(s=>{if(s.key===n){const r=parseInt(s.weight,10);if(r)return i=r,!0}return!1}),i}_computeNamesMatch(e,n){let i=0;return e.forEach(s=>{n.some(r=>s.key===r)&&(i+=parseInt(s.weight,10))}),i}}var bo={exports:{}};(function(t,e){(function(){(function(n,i){return t.exports=i()})(this,function(){var n,i,s,r,a,o,c,f,g,E,A,N,$;return f={},s=document,E=!1,A="active",o=6e4,a=!1,i=function(){var b,_,l,u,m;return u={},_="__ceGUID",b=function(p,v,y){return p[_]=void 0,p[_]||(p[_]="ifvisible.object.event.identifier"),u[p[_]]||(u[p[_]]={}),u[p[_]][v]||(u[p[_]][v]=[]),u[p[_]][v].push(y)},l=function(p,v,y){var x,M,R,L,D;if(p[_]&&u[p[_]]&&u[p[_]][v]){for(L=u[p[_]][v],D=[],M=0,R=L.length;M<R;M++)x=L[M],D.push(x(y||{}));return D}},m=function(p,v,y){var x,M,R,L,D;if(y){if(p[_]&&u[p[_]]&&u[p[_]][v]){for(D=u[p[_]][v],M=R=0,L=D.length;R<L;M=++R)if(x=D[M],x===y)return u[p[_]][v].splice(M,1),x}}else if(p[_]&&u[p[_]]&&u[p[_]][v])return delete u[p[_]][v]},{add:b,remove:m,fire:l}}(),n=function(){var b;return b=!1,function(_,l,u){return b||(_.addEventListener?b=function(m,p,v){return m.addEventListener(p,v,!1)}:_.attachEvent?b=function(m,p,v){return m.attachEvent("on"+p,v,!1)}:b=function(m,p,v){return m["on"+p]=v}),b(_,l,u)}}(),c=function(){var b,_,l,u,m;for(u=void 0,m=3,l=s.createElement("div"),b=l.getElementsByTagName("i"),_=function(){return l.innerHTML="<!--[if gt IE "+ ++m+"]><i></i><![endif]-->",b[0]};_(););return m>4?m:u}(),r=!1,$=void 0,typeof s.hidden!="undefined"?(r="hidden",$="visibilitychange"):typeof s.mozHidden!="undefined"?(r="mozHidden",$="mozvisibilitychange"):typeof s.msHidden!="undefined"?(r="msHidden",$="msvisibilitychange"):typeof s.webkitHidden!="undefined"&&(r="webkitHidden",$="webkitvisibilitychange"),N=function(){var b,_;return b=!1,_=function(){return clearTimeout(b),A!=="active"&&f.wakeup(),a=+new Date,b=setTimeout(function(){if(A==="active")return f.idle()},o)},_(),n(s,"mousemove",_),n(s,"keyup",_),n(s,"touchstart",_),n(window,"scroll",_),f.focus(_),f.wakeup(_)},g=function(){var b;return E?!0:(r===!1?(b="blur",c<9&&(b="focusout"),n(window,b,function(){return f.blur()}),n(window,"focus",function(){return f.focus()})):n(s,$,function(){return s[r]?f.blur():f.focus()},!1),E=!0,N())},f={setIdleDuration:function(b){return o=b*1e3},getIdleDuration:function(){return o},getIdleInfo:function(){var b,_;return b=+new Date,_={},A==="idle"?(_.isIdle=!0,_.idleFor=b-a,_.timeLeft=0,_.timeLeftPer=100):(_.isIdle=!1,_.idleFor=b-a,_.timeLeft=a+o-b,_.timeLeftPer=(100-_.timeLeft*100/o).toFixed(2)),_},focus:function(b){return typeof b=="function"?this.on("focus",b):(A="active",i.fire(this,"focus"),i.fire(this,"wakeup"),i.fire(this,"statusChanged",{status:A})),this},blur:function(b){return typeof b=="function"?this.on("blur",b):(A="hidden",i.fire(this,"blur"),i.fire(this,"idle"),i.fire(this,"statusChanged",{status:A})),this},idle:function(b){return typeof b=="function"?this.on("idle",b):(A="idle",i.fire(this,"idle"),i.fire(this,"statusChanged",{status:A})),this},wakeup:function(b){return typeof b=="function"?this.on("wakeup",b):(A="active",i.fire(this,"wakeup"),i.fire(this,"statusChanged",{status:A})),this},on:function(b,_){return g(),i.add(this,b,_),this},off:function(b,_){return g(),i.remove(this,b,_),this},onEvery:function(b,_){var l,u;return g(),l=!1,_&&(u=setInterval(function(){if(A==="active"&&l===!1)return _()},b*1e3)),{stop:function(){return clearInterval(u)},pause:function(){return l=!0},resume:function(){return l=!1},code:u,callback:_}},now:function(b){return g(),A===(b||"active")}},f})}).call(xt)})(bo);const st=bo.exports,gi="calleo-livechat";class Cg{constructor(e,n,i=window){this._win=i,this._config=e,this._translator=n,this._currentNotification=null,this._notificationCreatedAt=null,this._configured=!1,this._songs={},this._chatState=null,this._registration=null,st.now()}requestPermission(){if(this._configured)return;if(this._configured=!0,this._config.apiSettings.notification_api_mode!=="disable"&&"Notification"in this._win&&this._win.Notification.requestPermission){try{"navigator"in this._win&&"serviceWorker"in navigator&&this._win.navigator.serviceWorker.register("/virtualres/livechat/handle.php?c=sw").then(n=>{this._registration=n,this._win.navigator.serviceWorker.addEventListener("message",i=>{i.data===`notification-click:${gi}`&&this._notificationClick()})})}catch(n){console.error(n)}this._win.Notification.permission!=="granted"&&this._win.Notification.requestPermission()}this._win.addEventListener("beforeunload",()=>{this._currentNotification&&this.closeCurrentNotification(!0)});const e=()=>{d.state.display===Fe&&(this.closeCurrentNotificationTimeout(2e3),this.stopBlinkTitle())};st.on("focus",e);for(const n in this._config.apiSettings.sounds)Object.prototype.hasOwnProperty.call(this._config.apiSettings.sounds,n)&&this._config.apiSettings.sounds[n].mode!=="disable"&&(this._songs[n]=j.preloadSound(this._config.apiSettings.sounds[n].sound))}messageReceived(e){const n=!st.now();this._messageReceivedNotificationHandle(e);const i=this._config.apiSettings.sounds.new_message.mode;if(i==="always"||i==="always_inactive"&&!this.isActiveInChat()||i==="ifNotVisible"&&n||i==="ifNotVisibleChat"&&(n||d.state.display===Ve))try{const s=this._songs.new_message.play();s!==void 0&&s.then(()=>{}).catch(r=>{})}catch(s){}this._config.apiSettings.blink_title_new_message&&this.startBlinkTitle()}_messageReceivedNotificationHandle(e){this.closeCurrentNotification();const n=this._config.apiSettings.notification_api_mode,i=!st.now();if("Notification"in this._win&&this._win.Notification.permission==="granted"&&(n==="always_inactive"&&!this.isActiveInChat()||n==="ifNotVisible"&&i||n==="ifNotVisibleChat"&&(d.state.display===Ve||i))){this._closeNofificationTimeout&&(this._win.clearTimeout(this._closeNofificationTimeout),this._closeNofificationTimeout=null);const s=e.picture?e.picture:this._config.defaultOperatorAvatarPath,r={tag:gi,icon:`${this._config.frontBaseUrl}${s}`};try{const a=new this._win.Notification(String(e.message).replace(/(<([^>]+)>)/gi,""),r);this._currentNotification=a,this._notificationCreatedAt=new Date().getTime(),a.addEventListener("click",()=>{a.close(),this._notificationClick()}),a.show&&a.show(),this._win.setTimeout(()=>{a.close()},18e4)}catch(a){if(this._registration)try{const o=this._win.location,c=String(o.pathname).substring(0,6);r.data={sourceURL:this._win.location.href,startsWithURL:`${o.protocol}//${o.hostname}${c}`},this._registration.showNotification(e.message,r).then(()=>{this._notificationCreatedAt=new Date().getTime()}),this._currentNotification=null,this.closeCurrentNotificationTimeout(18e4)}catch(o){}}}}_notificationClick(){this._win.focus(),this.closeCurrentNotification(),d.dispatch("expandChat"),this.stopBlinkTitle(),this._win.setTimeout(()=>{const e=document.querySelector("#nespresso-livechat .nlc-message .nlc-input");e&&e.focus()},100)}messageRead(){d.state.display!==Fe?(this.closeCurrentNotificationTimeout(2e3),this.stopBlinkTitle()):(this._config.apiSettings.notification_api_mode==="always"||this._config.apiSettings.sounds.new_message.mode==="always_inactive")&&this.closeCurrentNotificationTimeout(2e4)}setChatState(e){this._chatState=e,this.isActiveInChat()&&(this.closeCurrentNotification(),this.stopBlinkTitle())}isActiveInChat(){return this._chatState==="active"||this._chatState==="composing"}closeChat(){this.closeCurrentNotification(),this.stopBlinkTitle()}closeCurrentNotificationTimeout(e){(this._currentNotification||this._registration)&&(this._closeNofificationTimeout&&(this._win.clearTimeout(this._closeNofificationTimeout),this._closeNofificationTimeout=null),this._closeNofificationTimeout=this._win.setTimeout(()=>{this.closeCurrentNotification()},e))}closeCurrentNotification(e=!1){try{if(this._currentNotification){const n=new Date().getTime()-this._notificationCreatedAt;if(e||n>2e3)this._currentNotification.close();else{const i=this._currentNotification;this._win.setTimeout(()=>{i.close()},2e3-n)}this._currentNotification=null}else this._registration&&typeof this._registration.getNotifications=="function"&&this._registration.getNotifications({tag:gi}).then(n=>{n.forEach(i=>{i.close()})});this._closeNofificationTimeout&&(this._win.clearTimeout(this._closeNofificationTimeout),this._closeNofificationTimeout=null)}catch(n){}}startBlinkTitle(){this.stopBlinkTitle(),this._originalTitle=document.title,this._blinkTitleInterval=this._win.setInterval(()=>{document.title===this._originalTitle?document.title=this._translator.get("livechat.page_title.new_message"):document.title=this._originalTitle},700)}stopBlinkTitle(){this._blinkTitleInterval&&(this._win.clearInterval(this._blinkTitleInterval),this._blinkTitleInterval=null),this._originalTitle&&(document.title=this._originalTitle,this._originalTitle=null)}}class wg{constructor(){this._translations={},this._lists={}}pushTranslations(e){this._translations=Object.assign({},this._translations,e)}pushList(e){this._lists=Object.assign({},this._lists,e)}get(e){return this._translations[e]?this._translations[e]:e}getList(e){return this._lists[e]?this._lists[e]:{}}getListValue(e,n,i=null){const s=this.getList(e);return s&&s[n]?s[n]:i}italic(e){return String.prototype.replace.call(e,/Nespresso|<i>Nespresso<\/i>|<b>Nespresso<\/b>|<em>Nespresso<\/em>/,"<b>Nespresso</b>")}removeP(e){return String.prototype.replace.call(String.prototype.replace.call(String.prototype.replace.call(e,"<p></p>","<br />"),"<p>",""),"</p>","")}install(e){e.prototype._=n=>this.get(n),e.prototype._i=n=>this.italic(this.get(n)),e.prototype._rmP=n=>this.removeP(n)}}class Sg{constructor(){this.debug=!1,this.market=null,this.language=null,this.channel=null,this.testMode=0,this.isIE9=window.XMLHttpRequest&&window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest)}init(e,n){this.config=e,this.dispatcher=n,this.baseUrl=e.url.api}setTestMode(e){this.testMode=e?1:0}getDispatcher(){return this.dispatcher}setContextParams(e,n,i){this.market=e,this.language=n,this.channel=i}retrieveRules(e,n=null){n||(n=r=>{this.dispatcher.emit("livechat.loading.error",r)});const i={market:this.market,language:this.language,channel:this.channel},s=this._getEndpointUrl("/api/livechat/");this.testMode&&(i.t=Date.now(),i.testmode=this.testMode),i.version=this.config.app_version,this.dispatcher.emit("livechat.loading",s,i),fetch(s+"?"+new URLSearchParams(i),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"}}).then(r=>{let a=r.ok?e:n;r.json().then(o=>a(o))},r=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:r})})}verifyResumeAsyncChat(e,n,i=null){fetch(this._getEndpointUrl("/api/livechat/check-async"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(this._addMarketInfoToObject(e)),credentials:"include"}).then(s=>{let r=s.ok?n:i;s.json().then(a=>r(a))},s=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:s})})}wakeUpAsyncChatServerSide(e,n,i=null){fetch(this._getEndpointUrl("/api/livechat/wake-up-async"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(this._addMarketInfoToObject(e)),credentials:"include"}).then(s=>{let r=s.ok?n:i;s.json().then(a=>r(a))},s=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:s})})}sendAction(e,n,i=null,s=null,r=null,a="livechat"){const o=this._getEndpointUrl(`/api/${a}/${n}?rid=${e}`);r||(r=(g,E)=>{console.error(`Cannot send action ${n} to #${e} ${g} ${E}`)});const c=this._addMarketInfoToObject(i);c.country=this.market,c.requestId=e,this.dispatcher.emit("livechat.send-action",n,a);const f=JSON.stringify(c);fetch(o,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:f,credentials:"include"}).then(g=>{let E=g.ok?s:r;g.json().then(A=>E(A)),g.ok||(this.dispatcher.emit("livechat.send-action.error",g),this.sendErrorToServer(`rest:action:${n}`,{error:this._formatXhrError(g),jsonData:f}))},g=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:g})})}start(e,n,i,s=null){const r=this._getEndpointUrl(n?"/api/chatbot/start":"/api/livechat/start");s||(s=(o,c)=>{console.error(`Cannot start chat ${o} ${c}`)}),e=this._addMarketInfoToObject(e),e.country=this.market,e.lang=this.language,e.setting_version=this.config.apiSettings.setting_version,e.excluded_from_chatbot=this.config.excludedFromChatbot,this.dispatcher.emit("livechat.start",e);const a=JSON.stringify(e);fetch(r,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:a,credentials:"include"}).then(o=>{let c=o.ok?i:s;o.json().then(f=>c(f)),o.ok||(this.dispatcher.emit("livechat.start.error",o),this.sendErrorToServer("rest:start",{error:this._formatXhrError(o),jsonData:a}))},o=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:o})}).then(o=>{o&&i(o)})}_addMarketInfoToObject(e){let n;return e?n=ue({},e):n={},n.market=this.market,n.language=this.language,n.channel=this.channel,n.secretToken=d.state.secretToken,n}registerJid(e,n){const i=this._getEndpointUrl(`/api/livechat/register?rid=${n}`),s=JSON.stringify(this._addMarketInfoToObject({jid:e,requestId:n}));fetch(i,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:s,credentials:"include"}).then(r=>{r.ok?r.json().then(a=>{a.data&&this.dispatcher.emit("livechat.registerJid",a.data)}):(this.dispatcher.emit("livechat.registerJid.error",r),this.sendErrorToServer("rest:register",{error:this._formatXhrError(r),jsonData:s}))},r=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:r})})}sendErrorToServer(e,n={},i=!1){if(!this.config||!this.config.apiSettings.sendError)return;const s=()=>{try{n.description=e,n.url="livechat",n.line=0,n.parent_url=window.location.href,n.user_agent=window.navigator.userAgent,n.jid=d.state.xmppSession.jid,n.request_id=d.state.request.id,n.market=this.market,n.language=this.language,n.channel=this.channel,this.sendErrorToServerLoop(n,0,5,5e3)}catch(r){}};i?s():window.setTimeout(s,1)}sendErrorToServerWithRetry(e,n,i,s){let r=this;fetch(`${this.baseUrl}/api/livechat/js-chat-err-log?rid=${d.state.request.id}`,{method:"POST",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify(e),credentials:"include"}).then(a=>{a.ok||n<i&&(n++,window.setTimeout(()=>{try{n<=i&&(e.retry=n,r.sendErrorToServerWithRetry(e,n,i,s))}catch(o){}},s))},a=>{this.dispatcher.emit("trigger.loading.error",{status:500,statusText:a})})}loadCss(){j.loadCss(`${this.baseUrl}/apps.php?a=calleo-livechat.css`)}_formatXhrError(e){let n=`${e.status} ${e.statusText}`;try{const i=JSON.parse(e.response);n+=`: ${i.error_description}`}catch(i){}return n}_getEndpointUrl(e){let n=`${this.baseUrl}${e}`;if(this.debug===!0){const i="XDEBUG_SESSION_START=ie";n.indexOf("?")===-1?n+=`?${i}`:n+=`&${i}`}return n}}var pt,En,Zt=typeof Map=="function"?new Map:(pt=[],En=[],{has:function(t){return pt.indexOf(t)>-1},get:function(t){return En[pt.indexOf(t)]},set:function(t,e){pt.indexOf(t)===-1&&(pt.push(t),En.push(e))},delete:function(t){var e=pt.indexOf(t);e>-1&&(pt.splice(e,1),En.splice(e,1))}}),Co=function(t){return new Event(t,{bubbles:!0})};try{new Event("test")}catch(t){Co=function(e){var n=document.createEvent("Event");return n.initEvent(e,!0,!1),n}}function Tg(t){var e=Zt.get(t);e&&e.destroy()}function Eg(t){var e=Zt.get(t);e&&e.update()}var Vt=null;typeof window=="undefined"||typeof window.getComputedStyle!="function"?((Vt=function(t){return t}).destroy=function(t){return t},Vt.update=function(t){return t}):((Vt=function(t,e){return t&&Array.prototype.forEach.call(t.length?t:[t],function(n){return function(i){if(i&&i.nodeName&&i.nodeName==="TEXTAREA"&&!Zt.has(i)){var s,r=null,a=null,o=null,c=function(){i.clientWidth!==a&&A()},f=function(N){window.removeEventListener("resize",c,!1),i.removeEventListener("input",A,!1),i.removeEventListener("keyup",A,!1),i.removeEventListener("autosize:destroy",f,!1),i.removeEventListener("autosize:update",A,!1),Object.keys(N).forEach(function($){i.style[$]=N[$]}),Zt.delete(i)}.bind(i,{height:i.style.height,resize:i.style.resize,overflowY:i.style.overflowY,overflowX:i.style.overflowX,wordWrap:i.style.wordWrap});i.addEventListener("autosize:destroy",f,!1),"onpropertychange"in i&&"oninput"in i&&i.addEventListener("keyup",A,!1),window.addEventListener("resize",c,!1),i.addEventListener("input",A,!1),i.addEventListener("autosize:update",A,!1),i.style.overflowX="hidden",i.style.wordWrap="break-word",Zt.set(i,{destroy:f,update:A}),(s=window.getComputedStyle(i,null)).resize==="vertical"?i.style.resize="none":s.resize==="both"&&(i.style.resize="horizontal"),r=s.boxSizing==="content-box"?-(parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)):parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth),isNaN(r)&&(r=0),A()}function g(N){var $=i.style.width;i.style.width="0px",i.style.width=$,i.style.overflowY=N}function E(){if(i.scrollHeight!==0){var N=function($){for(var b=[];$&&$.parentNode&&$.parentNode instanceof Element;)$.parentNode.scrollTop&&($.parentNode.style.scrollBehavior="auto",b.push([$.parentNode,$.parentNode.scrollTop])),$=$.parentNode;return function(){return b.forEach(function(_){var l=_[0];l.scrollTop=_[1],l.style.scrollBehavior=null})}}(i);i.style.height="",i.style.height=i.scrollHeight+r+"px",a=i.clientWidth,N()}}function A(){E();var N=Math.round(parseFloat(i.style.height)),$=window.getComputedStyle(i,null),b=$.boxSizing==="content-box"?Math.round(parseFloat($.height)):i.offsetHeight;if(b<N?$.overflowY==="hidden"&&(g("scroll"),E(),b=$.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(i,null).height)):i.offsetHeight):$.overflowY!=="hidden"&&(g("hidden"),E(),b=$.boxSizing==="content-box"?Math.round(parseFloat(window.getComputedStyle(i,null).height)):i.offsetHeight),o!==b){o=b;var _=Co("autosize:resized");try{i.dispatchEvent(_)}catch(l){}}}}(n)}),t}).destroy=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],Tg),t},Vt.update=function(t){return t&&Array.prototype.forEach.call(t.length?t:[t],Eg),t});var mi=Vt;const Ag=t=>{t.directive("autosize",{bind(e){t.nextTick(()=>{mi(e)})},update(e){t.nextTick(()=>{mi.update(e)})},unbind(e){mi.destroy(e)}})};function he(t,e,n,i,s,r,a,o){var c=typeof t=="function"?t.options:t;e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r);var f;if(a?(f=function(A){A=A||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!A&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(A=__VUE_SSR_CONTEXT__),s&&s.call(this,A),A&&A._registeredComponents&&A._registeredComponents.add(a)},c._ssrRegister=f):s&&(f=o?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),f)if(c.functional){c._injectStyles=f;var g=c.render;c.render=function(N,$){return f.call($),g(N,$)}}else{var E=c.beforeCreate;c.beforeCreate=E?[].concat(E,f):[f]}return{exports:t,options:c}}const xg={name:"StarRating",props:["name","defval","list"],data(){return{value:this.defval}},computed:{orderedRatings(){return[...this.list].sort((t,e)=>e.value-t.value)}},watch:{value:{handler(t){this.$emit("update",{name,value:t})},deep:!0}},methods:{classRating(t,e=!1){return`nlc-${e?"label-":""}${this.list.length-t+1}`}}};var kg=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-rating"},[e._l(e.orderedRatings,function(i){return n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"nlc-rating-star",class:e.classRating(i.value),attrs:{type:"radio",name:e.name,title:i.label,required:""},domProps:{value:i.value,checked:e._q(e.value,i.value)},on:{change:function(s){e.value=i.value}}})}),e._l(e.orderedRatings,function(i){return n("label",{staticClass:"nlc-rating-label",class:e.classRating(i.value,!0),attrs:{for:"nlc-"+i.value}},[e._v(e._s(i.label))])}),e._m(0)],2)},Og=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"nlc-rating-bar"},[e("span",{staticClass:"nlc-rating-bar-highlight"})])}],Ig=he(xg,kg,Og,!1,null,null,null,null);const Mg=Ig.exports,Rg={name:"FormRating",components:{StarRating:Mg},props:["config"],computed:Re(ue({},Te.exports.mapGetters(["chatbotContext","list","orderedList"])),{delay:{get(){return d.state.rating.delay},set(t){d.commit(Jt,{delay:t})}},quality:{get(){return d.state.rating.quality},set(t){d.commit(Jt,{quality:t})}},satisfaction:{get(){return d.state.rating.satisfaction},set(t){d.commit(Jt,{satisfaction:t})}},comment:{get(){return d.state.rating.comment},set(t){d.commit(Jt,{comment:t})}}}),methods:{updateDelay(t){this.delay=t.value},updateQuality(t){this.quality=t.value},isChatbot(t){return t!==ie.NO_CHATBOT}}};var Ng=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-form-feedback",attrs:{role:"form"}},[n("hr"),n("h1",[e._v(e._s(e._(e.isChatbot(e.chatbotContext)?"chatbot.rating":"livechat.rating")))]),n("p",{staticClass:"rating-sub"},[e._v(" "+e._s(e._(e.isChatbot(e.chatbotContext)?"chatbot.rating_sub":"livechat.rating_sub"))+" ")]),n("fieldset",[n("legend",{domProps:{innerHTML:e._s(e._(e.isChatbot(e.chatbotContext)?"chatbot.rating.delay.title":"livechat.rating.delay.title"))}}),n("p",{domProps:{innerHTML:e._s(e._i(e.isChatbot(e.chatbotContext)?"chatbot.rating_question_rate_speed":"livechat.rating_question_rate_speed"))}}),n("StarRating",{attrs:{name:"delay",list:e.orderedList.ratings,defval:e.delay},on:{update:e.updateDelay}})],1),n("fieldset",[n("legend",{domProps:{innerHTML:e._s(e._(e.isChatbot(e.chatbotContext)?"chatbot.rating.quality.title":"livechat.rating.quality.title"))}}),n("p",{domProps:{innerHTML:e._s(e._i(e.isChatbot(e.chatbotContext)?"chatbot.rating_question_rate_quality":"livechat.rating_question_rate_quality"))}}),n("StarRating",{attrs:{name:"quality",list:e.orderedList.ratings,defval:e.quality},on:{update:e.updateQuality}})],1),n("fieldset",[n("legend",{domProps:{innerHTML:e._s(e._(e.isChatbot(e.chatbotContext)?"chatbot.rating.satisfaction.title":"livechat.rating.satisfaction.title"))}}),n("p",{domProps:{innerHTML:e._s(e._i(e.isChatbot(e.chatbotContext)?"chatbot.rating_question_satisfied":"livechat.rating_question_satisfied"))}}),n("div",[n("div",{staticClass:"nlc-ui-radio"},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.satisfaction,expression:"satisfaction"}],attrs:{id:"satisfaction_yes",type:"radio",name:"satisfaction",value:"1",required:""},domProps:{checked:e._q(e.satisfaction,"1")},on:{change:function(i){e.satisfaction="1"}}}),n("label",{attrs:{for:"satisfaction_yes"}},[e._v(e._s(e.list.yesNo[1]))])]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.satisfaction,expression:"satisfaction"}],attrs:{id:"satisfaction_no",type:"radio",name:"satisfaction",value:"0",required:""},domProps:{checked:e._q(e.satisfaction,"0")},on:{change:function(i){e.satisfaction="0"}}}),n("label",{attrs:{for:"satisfaction_no"}},[e._v(e._s(e.list.yesNo[0]))])])]),n("div",{staticClass:"nlc-ui-textarea nlc-ui-h-130"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],staticClass:"nlc-ui-mt-3",attrs:{id:"comment",name:"comment",placeholder:" ","data-escapelabel":"",rows:"24",cols:"80"},domProps:{value:e.comment},on:{input:function(i){i.target.composing||(e.comment=i.target.value)}}}),e._v(" "),n("label",{attrs:{for:"comment"}},[e._v(" "+e._s(e._(e.isChatbot(e.chatbotContext)?"chatbot.rating_additional_remarks":"livechat.rating_additional_remarks"))+" ")])])])])])},Lg=[],Pg=he(Rg,Ng,Lg,!1,null,null,null,null);const $g=Pg.exports,Fg={name:"FormProfile",store:d,computed:Re(ue({},Te.exports.mapGetters(["config","list","orderedList","profileTmp","profileError","request","toRegisterHandover","vueProfile","vueRegister","stateContactReasonWithRegister","stateContactReasonOnly","stateContactReasonSubmitted","contactReason","summarizeOnHandover"])),{title:{get(){return this.profileTmp.title},set(t){d.commit(Ze,{title:t})}},firstName:{get(){return this.profileTmp.firstName},set(t){d.commit(Ze,{firstName:t})}},lastName:{get(){return this.profileTmp.lastName},set(t){d.commit(Ze,{lastName:t})}},email:{get(){return this.profileTmp.email},set(t){d.commit(Ze,{email:t})}},phone:{get(){return this.profileTmp.phone},set(t){d.commit(Ze,{phone:t})}},legalTerms:{get(){return this.profileTmp.legalTerms},set(t){d.commit(Ze,{legalTerms:t})}},contactReasonModel:{get(){return this.contactReason},set(t){d.commit(fo,t)}},summarizeOnHandoverModel:{get(){return this.summarizeOnHandover},set(t){d.commit(po,t)}}}),watch:{profileError(t){this.setAnnouncements(t)}},created(){this.profileError&&this.setAnnouncements(this.profileError)},methods:{formatErrorMessage(t){const e=document.getElementById(t.field);return e&&e.getAttribute("placeholder")?`${e.getAttribute("placeholder")}: ${t.error}`:`${t.error}`},focus(t){const e=document.getElementById(t);!e||ee.nextTick(()=>{e.focus()})},getFormFieldConfig(t){let e=["first_name","last_name","email","summarize_on_handover"];return d.state.stateContactReasonWithRegister&&!d.state.stateContactReasonSubmitted&&e.push("contact_reason"),d.state.stateContactReasonOnly&&!d.state.stateContactReasonSubmitted&&(e=["contact_reason"]),e.indexOf(t)!==-1?1:d.state.stateContactReasonOnly&&!d.state.stateContactReasonSubmitted?null:d.state.config.profileFormSettings[t]},isFormFieldDisplayed(t){const e=[0,1],n=this.getFormFieldConfig(t);return e.indexOf(n)!==-1?!(["title","first_name","last_name","phone"].includes(t)&&d.state.vueRegister&&d.state.toRegisterHandover||t==="summarize_on_handover"&&(!d.state.vueRegister||!d.state.toRegisterHandover||!d.state.settings.chatbot_ask_summarize_on_handover)):!1},isFormFieldRequired(t){return this.getFormFieldConfig(t)===1},setAnnouncements(t){let e="";t.forEach(n=>{const i=document.getElementById(n.field);i&&i.setAttribute("aria-invalid","true"),d.dispatch("announce",{message:n.field+": "+n.error}),e+="<p>"+n.field+": "+n.error+".</p>"}),d.dispatch("announce",{message:e})},getErrorMessage(t){return this.profileError?this.profileError.find(e=>e.field===t):!1}}};var Dg=function(){var e=this,n=e._self._c;return n("div",[n("div",{staticStyle:{clear:"both"}}),n("div",{staticClass:"nlc-form-subscribe row",attrs:{id:"nlc-form-subscribe",role:"form"}},[e.isFormFieldDisplayed("title")?n("div",{staticClass:"nlc-ui-select",class:e.getErrorMessage("title")?"nlc-ui-field-invalid":""},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.title,expression:"title"}],class:e.profileTmp.title!==""?"is-selected":"",attrs:{id:"title",placeholder:e._("livechat.title"),"aria-required":e.isFormFieldRequired("title"),required:e.isFormFieldRequired("title")},on:{change:function(i){var s=Array.prototype.filter.call(i.target.options,function(r){return r.selected}).map(function(r){var a="_value"in r?r._value:r.value;return a});e.title=i.target.multiple?s:s[0]}}},e._l(e.orderedList.titles,function({value:i,label:s}){return n("option",{domProps:{value:i}},[e._v(" "+e._s(s)+" ")])}),0),n("label",{attrs:{for:"title"}},[e._v(" "+e._s(e._("livechat.title"))+" "),e.isFormFieldRequired("title")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("title")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("title").error))]):e._e()])]):e._e(),e.isFormFieldDisplayed("first_name")?n("div",{staticClass:"nlc-ui-field",class:e.getErrorMessage("first_name")?"nlc-ui-field-invalid":""},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.firstName,expression:"firstName"}],attrs:{id:"first_name",type:"text",name:"first_name",title:e._("livechat.fname"),"aria-required":e.isFormFieldRequired("first_name"),required:e.isFormFieldRequired("first_name"),placeholder:" ","aria-label":e._("livechat.fname")},domProps:{value:e.firstName},on:{input:function(i){i.target.composing||(e.firstName=i.target.value)}}}),n("label",{attrs:{for:"first_name"}},[e._v(" "+e._s(e._("livechat.fname"))+" "),e.isFormFieldRequired("first_name")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("first_name")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("first_name").error))]):e._e()])]):e._e(),e.isFormFieldDisplayed("last_name")?n("div",{staticClass:"nlc-ui-field",class:e.getErrorMessage("last_name")?"nlc-ui-field-invalid":""},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.lastName,expression:"lastName"}],attrs:{id:"last_name",type:"text",name:"last_name",title:e._("livechat.lname"),"aria-required":e.isFormFieldRequired("last_name"),required:e.isFormFieldRequired("last_name"),placeholder:" ","aria-label":e._("livechat.lname")},domProps:{value:e.lastName},on:{input:function(i){i.target.composing||(e.lastName=i.target.value)}}}),n("label",{attrs:{for:"last_name"}},[e._v(" "+e._s(e._("livechat.lname"))+" "),e.isFormFieldRequired("last_name")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("last_name")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("last_name").error))]):e._e()])]):e._e(),e.isFormFieldDisplayed("email")?n("div",{staticClass:"nlc-ui-field",class:e.getErrorMessage("email")?"nlc-ui-field-invalid":""},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{id:"email",type:"email",name:"email",title:e._("livechat.email"),"aria-required":e.isFormFieldRequired("email"),required:e.isFormFieldRequired("email"),placeholder:" ","aria-label":e._("livechat.email")},domProps:{value:e.email},on:{input:function(i){i.target.composing||(e.email=i.target.value)}}}),n("label",{attrs:{for:"email"}},[e._v(" "+e._s(e._("livechat.email"))+" "),e.isFormFieldRequired("email")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("email")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("email").error))]):e._e()])]):e._e(),e.isFormFieldDisplayed("summarize_on_handover")?n("div",{staticClass:"nlc-ui-textarea",class:e.getErrorMessage("summarize_on_handover")?"nlc-ui-field-invalid":""},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.summarizeOnHandoverModel,expression:"summarizeOnHandoverModel"}],attrs:{id:"summarize_on_handover",name:"summarize_on_handover",title:e._("livechat.summarize_on_handover"),placeholder:" ","aria-required":e.isFormFieldRequired("summarize_on_handover"),required:e.isFormFieldRequired("summarize_on_handover")},domProps:{value:e.summarizeOnHandoverModel},on:{input:function(i){i.target.composing||(e.summarizeOnHandoverModel=i.target.value)}}}),e._v(" "),n("label",{attrs:{for:"summarize_on_handover"}},[e._v(" "+e._s(e._("livechat.summarize_on_handover"))+" "),e.isFormFieldRequired("summarize_on_handover")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("summarize_on_handover")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("summarize_on_handover").error))]):e._e()])]):e._e(),e.isFormFieldDisplayed("phone")?n("div",{staticClass:"nlc-ui-field",class:e.getErrorMessage("phone")?"nlc-ui-field-invalid":""},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],attrs:{id:"phone",type:"tel",name:"phone",title:e._("livechat.phone"),"aria-required":e.isFormFieldRequired("phone"),required:e.isFormFieldRequired("phone"),placeholder:" ","aria-label":e._("livechat.phone")},domProps:{value:e.phone},on:{input:function(i){i.target.composing||(e.phone=i.target.value)}}}),n("label",{attrs:{for:"phone"}},[e._v(" "+e._s(e._("livechat.phone"))+" "),e.isFormFieldRequired("phone")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("phone")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("phone").error))]):e._e()])]):e._e(),e.isFormFieldDisplayed("contact_reason")?n("div",{staticClass:"nlc-ui-select",class:e.getErrorMessage("contact_reason")?"nlc-ui-field-invalid":""},[n("select",{directives:[{name:"model",rawName:"v-model",value:e.contactReasonModel,expression:"contactReasonModel"}],class:e.contactReason!==null?"is-selected":"",attrs:{id:"contact_reason",placeholder:e._("livechat.contact_reason"),title:e._("livechat.contact_reason"),"aria-required":e.isFormFieldRequired("contact_reason"),required:e.isFormFieldRequired("contact_reason")},on:{change:function(i){var s=Array.prototype.filter.call(i.target.options,function(r){return r.selected}).map(function(r){var a="_value"in r?r._value:r.value;return a});e.contactReasonModel=i.target.multiple?s:s[0]}}},e._l(e.orderedList.contactReasons,function(i){return n("option",{domProps:{value:i.value}},[e._v(" "+e._s(i.label)+" ")])}),0),n("label",{attrs:{for:"contact_reason"}},[e._v(" "+e._s(e._("livechat.contact_reason"))+" "),e.isFormFieldRequired("contact_reason")?n("span",{staticClass:"mandatory"},[e._v("*")]):e._e(),e.getErrorMessage("contact_reason")?n("span",{staticClass:"nlc-ui-error"},[e._v(e._s(e.getErrorMessage("contact_reason").error))]):e._e()])]):e._e(),e.stateContactReasonOnly?e._e():[e.config.enableLegalTerms?n("div",{staticClass:"nlc-privacy-force"},[n("label",{staticClass:"label-as-text",attrs:{for:"legal_terms_content"}},[e._v(" "+e._s(e._("contactus.legal_terms.label"))+" ")]),n("div",{staticClass:"nlc-ui-textarea nlc-ui-no-label"},[n("textarea",{staticClass:"legal-terms-content",attrs:{id:"legal_terms_content",rows:"6",readonly:""}},[e._v(e._s(e._("contactus.legal_terms.content")))])]),n("div",{staticClass:"nlc-ui-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.legalTerms,expression:"legalTerms"}],attrs:{id:"accept_legal_terms",type:"checkbox","aria-required":"true",required:""},domProps:{checked:Array.isArray(e.legalTerms)?e._i(e.legalTerms,null)>-1:e.legalTerms},on:{change:function(i){var s=e.legalTerms,r=i.target,a=!!r.checked;if(Array.isArray(s)){var o=null,c=e._i(s,o);r.checked?c<0&&(e.legalTerms=s.concat([o])):c>-1&&(e.legalTerms=s.slice(0,c).concat(s.slice(c+1)))}else e.legalTerms=a}}}),n("label",{attrs:{for:"accept_legal_terms"}},[e._v(" "+e._s(e._("contactus.legal_terms.agree.label"))+" "),n("span",{staticClass:"mandatory"},[e._v("*")])])])]):n("div",{staticClass:"nlc-ui-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.legalTerms,expression:"legalTerms"}],attrs:{id:"accept_legal_terms",type:"checkbox","aria-required":"true",required:""},domProps:{checked:Array.isArray(e.legalTerms)?e._i(e.legalTerms,null)>-1:e.legalTerms},on:{change:function(i){var s=e.legalTerms,r=i.target,a=!!r.checked;if(Array.isArray(s)){var o=null,c=e._i(s,o);r.checked?c<0&&(e.legalTerms=s.concat([o])):c>-1&&(e.legalTerms=s.slice(0,c).concat(s.slice(c+1)))}else e.legalTerms=a}}}),n("label",{attrs:{for:"accept_legal_terms"},domProps:{innerHTML:e._s(e._rmP(e._i("contactus.privacy_text")))}},[n("span",{staticClass:"mandatory"},[e._v("*")])])])]],2)])},Hg=[],qg=he(Fg,Dg,Hg,!1,null,null,null,null);const Ug=qg.exports,Bg={name:"ElementCard",props:["title","subtitle","imageUri","buttons"],methods:{openLink(t){!t||(this.isSameHost(t,window.location.href)?window.location.assign(t):window.open(t,"_blank"))},sendMessage(t){d.dispatch("sendMessage",t)},isValidHttpUrl(t){let e;try{e=new URL(t)}catch(n){return!1}return e.protocol==="http:"||e.protocol==="https:"},isSameHost(t,e){return new URL(t).host===new URL(e).host}}};var zg=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-chatbot-answer-card"},[n("div",{staticClass:"nlc-chatbot-title nlc-chatbot-answer-card-title"},[e._v(" "+e._s(e.title)+" ")]),e.subtitle?n("div",{staticClass:"nlc-chatbot-subtitle nlc-chatbot-answer-card-subtitle"},[e._v(" "+e._s(e.subtitle)+" ")]):e._e(),e.imageUri?n("div",{staticClass:"nlc-chatbot-image nlc-chatbot-answer-card-image"},[n("img",{staticClass:"nlc-chatbot-answer-card-image-img",attrs:{src:e.imageUri,alt:"title"}})]):e._e(),e.buttons.length>0?n("div",{staticClass:"nlc-chatbot-buttons nlc-chatbot-answer-card-buttons"},e._l(e.buttons,function(i){return n("span",{staticClass:"nlc-chatbot-button-item nlc-chatbot-answer-card-button-item"},[i.postback&&e.isValidHttpUrl(i.postback)?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-btn-margin nlc-ui-btn-block",on:{click:function(s){return e.openLink(i.postback)}}},[e._v(e._s(i.title))]):e._e(),!i.postback||!e.isValidHttpUrl(i.postback)?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-btn-margin nlc-ui-btn-block",on:{click:function(s){return e.sendMessage(i.postback?i.postback:i.title)}}},[e._v(e._s(i.title))]):e._e()])}),0):e._e()])},Wg=[],jg=he(Bg,zg,Wg,!1,null,null,null,null);const Xg=jg.exports,Qg={name:"ElementImage",props:["imageUri","accessibilityText"]};var Gg=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-chatbot-answer-image"},[n("div",{staticClass:"nlc-chatbot-image"},[n("img",{attrs:{src:e.imageUri,alt:e.accessibilityText}})]),e.accessibilityText?n("div",{staticClass:"nlc-chatbot-caption"},[e._v(" "+e._s(e.accessibilityText)+" ")]):e._e()])},Jg=[],Vg=he(Qg,Gg,Jg,!1,null,null,null,null);const Yg=Vg.exports,Kg={name:"ElementQuickReply",props:["title"]};var Zg=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-chatbot-answer-quick-reply"},[e._v(" "+e._s(e.title)+" ")])},em=[],tm=he(Kg,Zg,em,!1,null,null,null,null);const nm=tm.exports,im={name:"ElementText",props:["text"]};var sm=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-chatbot-answer-text",domProps:{innerHTML:e._s(e.text)}})},rm=[],am=he(im,sm,rm,!1,null,null,null,null);const om=am.exports,lm={name:"ElementTextWithButtons",props:["text","buttons"],methods:{openLink(t){!t||(this.isSameHost(t,window.location.href)?window.location.assign(t):window.open(t,"_blank"))},sendMessage(t,e){const n=document.createElement("div");n.className="nlc-btn-loader",t.target.append(n),d.dispatch("sendMessage",e)},isValidHttpUrl(t){let e;try{e=new URL(t)}catch(n){return!1}return e.protocol==="http:"||e.protocol==="https:"},isSameHost(t,e){return new URL(t).host===new URL(e).host}}};var cm=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-chatbot-answer-text-with-buttons"},[n("div",{staticClass:"nlc-chatbot-title nlc-chatbot-answer-text_with_buttons-text-title"},[e._v(" "+e._s(e.text)+" ")]),e.buttons.length>0?n("div",{staticClass:"nlc-chatbot-buttons nlc-chatbot-answer-text-with-buttons-buttons"},e._l(e.buttons,function(i){return n("span",{staticClass:"nlc-chatbot-button-item nlc-chatbot-answer-text-with-buttons-button-item"},[i.url?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-btn-margin",on:{click:function(s){return e.openLink(i.url)}}},[e._v(e._s(i.title))]):e._e(),!i.url||!i.url?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-btn-margin",on:{click:s=>e.sendMessage(s,i.payload)}},[e._v(" "+e._s(i.title)+" ")]):e._e()])}),0):e._e()])},um=[],dm=he(lm,cm,um,!1,null,null,null,null);const hm=dm.exports;var Wi={exports:{}};/*!
 * vue-carousel v0.6.11
 * (c) 2018 todd.beauchamp@ssense.com
 * https://github.com/ssense/vue-carousel#readme
 */(function(t,e){(function(n,i){t.exports=i()})(xt,function(){return function(n){function i(r){if(s[r])return s[r].exports;var a=s[r]={exports:{},id:r,loaded:!1};return n[r].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}var s={};return i.m=n,i.c=s,i.p="",i(0)}([function(n,i,s){function r(E){return E&&E.__esModule?E:{default:E}}Object.defineProperty(i,"__esModule",{value:!0}),i.Slide=i.Carousel=void 0;var a=s(1),o=r(a),c=s(41),f=r(c),g=function(E){E.component("carousel",o.default),E.component("slide",f.default)};i.default={install:g},i.Carousel=o.default,i.Slide=f.default},function(n,i,s){function r(o){s(2)}var a=s(7)(s(8),s(46),r,null,null);n.exports=a.exports},function(n,i,s){var r=s(3);typeof r=="string"&&(r=[[n.id,r,""]]),r.locals&&(n.exports=r.locals),s(5)("80564c20",r,!0,{})},function(n,i,s){i=n.exports=s(4)(),i.push([n.id,".VueCarousel{position:relative}.VueCarousel-wrapper{width:100%;position:relative;overflow:hidden}.VueCarousel-inner{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-webkit-backface-visibility:hidden;backface-visibility:hidden}",""])},function(n,i){n.exports=function(){var s=[];return s.toString=function(){for(var r=[],a=0;a<this.length;a++){var o=this[a];o[2]?r.push("@media "+o[2]+"{"+o[1]+"}"):r.push(o[1])}return r.join("")},s.i=function(r,a){typeof r=="string"&&(r=[[null,r,""]]);for(var o={},c=0;c<this.length;c++){var f=this[c][0];typeof f=="number"&&(o[f]=!0)}for(c=0;c<r.length;c++){var g=r[c];typeof g[0]=="number"&&o[g[0]]||(a&&!g[2]?g[2]=a:a&&(g[2]="("+g[2]+") and ("+a+")"),s.push(g))}},s}},function(n,i,s){function r(y){for(var x=0;x<y.length;x++){var M=y[x],R=A[M.id];if(R){R.refs++;for(var L=0;L<R.parts.length;L++)R.parts[L](M.parts[L]);for(;L<M.parts.length;L++)R.parts.push(o(M.parts[L]));R.parts.length>M.parts.length&&(R.parts.length=M.parts.length)}else{for(var D=[],L=0;L<M.parts.length;L++)D.push(o(M.parts[L]));A[M.id]={id:M.id,refs:1,parts:D}}}}function a(){var y=document.createElement("style");return y.type="text/css",N.appendChild(y),y}function o(y){var x,M,R=document.querySelector("style["+m+'~="'+y.id+'"]');if(R){if(_)return l;R.parentNode.removeChild(R)}if(p){var L=b++;R=$||($=a()),x=c.bind(null,R,L,!1),M=c.bind(null,R,L,!0)}else R=a(),x=f.bind(null,R),M=function(){R.parentNode.removeChild(R)};return x(y),function(D){if(D){if(D.css===y.css&&D.media===y.media&&D.sourceMap===y.sourceMap)return;x(y=D)}else M()}}function c(y,x,M,R){var L=M?"":R.css;if(y.styleSheet)y.styleSheet.cssText=v(x,L);else{var D=document.createTextNode(L),C=y.childNodes;C[x]&&y.removeChild(C[x]),C.length?y.insertBefore(D,C[x]):y.appendChild(D)}}function f(y,x){var M=x.css,R=x.media,L=x.sourceMap;if(R&&y.setAttribute("media",R),u.ssrId&&y.setAttribute(m,x.id),L&&(M+=`
/*# sourceURL=`+L.sources[0]+" */",M+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(L))))+" */"),y.styleSheet)y.styleSheet.cssText=M;else{for(;y.firstChild;)y.removeChild(y.firstChild);y.appendChild(document.createTextNode(M))}}var g=typeof document!="undefined",E=s(6),A={},N=g&&(document.head||document.getElementsByTagName("head")[0]),$=null,b=0,_=!1,l=function(){},u=null,m="data-vue-ssr-id",p=typeof navigator!="undefined"&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());n.exports=function(y,x,M,R){_=M,u=R||{};var L=E(y,x);return r(L),function(D){for(var C=[],w=0;w<L.length;w++){var O=L[w],F=A[O.id];F.refs--,C.push(F)}D?(L=E(y,D),r(L)):L=[];for(var w=0;w<C.length;w++){var F=C[w];if(F.refs===0){for(var q=0;q<F.parts.length;q++)F.parts[q]();delete A[F.id]}}}};var v=function(){var y=[];return function(x,M){return y[x]=M,y.filter(Boolean).join(`
`)}}()},function(n,i){n.exports=function(s,r){for(var a=[],o={},c=0;c<r.length;c++){var f=r[c],g=f[0],E=f[1],A=f[2],N=f[3],$={id:s+":"+c,css:E,media:A,sourceMap:N};o[g]?o[g].parts.push($):a.push(o[g]={id:g,parts:[$]})}return a}},function(n,i){n.exports=function(s,r,a,o,c){var f,g=s=s||{},E=typeof s.default;E!=="object"&&E!=="function"||(f=s,g=s.default);var A=typeof g=="function"?g.options:g;r&&(A.render=r.render,A.staticRenderFns=r.staticRenderFns),o&&(A._scopeId=o);var N;if(c?(N=function(_){_=_||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,_||typeof __VUE_SSR_CONTEXT__=="undefined"||(_=__VUE_SSR_CONTEXT__),a&&a.call(this,_),_&&_._registeredComponents&&_._registeredComponents.add(c)},A._ssrRegister=N):a&&(N=a),N){var $=A.functional,b=$?A.render:A.beforeCreate;$?A.render=function(_,l){return N.call(l),b(_,l)}:A.beforeCreate=b?[].concat(b,N):[N]}return{esModule:f,exports:g,options:A}}},function(n,i,s){function r(u){return u&&u.__esModule?u:{default:u}}Object.defineProperty(i,"__esModule",{value:!0});var a=s(9),o=r(a),c=s(29),f=r(c),g=s(30),E=r(g),A=s(31),N=r(A),$=s(36),b=r($),_=s(41),l=r(_);i.default={name:"carousel",beforeUpdate:function(){this.computeCarouselWidth()},components:{Navigation:N.default,Pagination:b.default,Slide:l.default},data:function(){return{browserWidth:null,carouselWidth:null,currentPage:0,dragging:!1,dragMomentum:0,dragOffset:0,dragStartY:0,dragStartX:0,isTouch:typeof window!="undefined"&&"ontouchstart"in window,offset:0,refreshRate:16,slideCount:0}},mixins:[f.default],props:{easing:{type:String,default:"ease"},minSwipeDistance:{type:Number,default:8},navigationClickTargetSize:{type:Number,default:8},mouseDrag:{type:Boolean,default:!0},navigationEnabled:{type:Boolean,default:!1},navigationNextLabel:{type:String,default:"\u25B6"},navigationPrevLabel:{type:String,default:"\u25C0"},paginationActiveColor:{type:String,default:"#000000"},paginationColor:{type:String,default:"#efefef"},paginationEnabled:{type:Boolean,default:!0},paginationPadding:{type:Number,default:10},paginationSize:{type:Number,default:10},perPage:{type:Number,default:2},perPageCustom:{type:Array},resistanceCoef:{type:Number,default:20},scrollPerPage:{type:Boolean,default:!1},speed:{type:Number,default:500},loop:{type:Boolean,default:!1},navigateTo:{type:Number,default:0},spacePadding:{type:Number,default:0}},watch:{navigateTo:function(u){u!==this.currentPage&&this.goToPage(u)},currentPage:function(u){this.$emit("pageChange",u)}},computed:{breakpointSlidesPerPage:function(){if(!this.perPageCustom)return this.perPage;var u=this.perPageCustom,m=this.browserWidth,p=u.sort(function(x,M){return x[0]>M[0]?-1:1}),v=p.filter(function(x){return m>=x[0]}),y=v[0]&&v[0][1];return y||this.perPage},canAdvanceForward:function(){return this.loop||this.currentPage<this.pageCount-1},canAdvanceBackward:function(){return this.loop||this.currentPage>0},currentPerPage:function(){return!this.perPageCustom||this.$isServer?this.perPage:this.breakpointSlidesPerPage},currentOffset:function(){return(this.offset+this.dragOffset)*-1},isHidden:function(){return this.carouselWidth<=0},maxOffset:function(){return this.slideWidth*this.slideCount-this.carouselWidth},pageCount:function(){return Math.ceil(this.slideCount/this.currentPerPage)},slideWidth:function(){var u=this.carouselWidth-2*this.spacePadding,m=this.currentPerPage;return u/m},transitionStyle:function(){return this.speed/1e3+"s "+this.easing+" transform"},padding:function(){var m=this.spacePadding;return m>0&&m}},methods:{getNextPage:function(){return this.currentPage<this.pageCount-1?this.currentPage+1:this.loop?0:this.currentPage},getPreviousPage:function(){return this.currentPage>0?this.currentPage-1:this.loop?this.pageCount-1:this.currentPage},advancePage:function(u){u&&u==="backward"&&this.canAdvanceBackward?this.goToPage(this.getPreviousPage(),"navigation"):(!u||u&&u!=="backward")&&this.canAdvanceForward&&this.goToPage(this.getNextPage(),"navigation")},attachMutationObserver:function(){var u=this,m=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(m){var p={attributes:!0,data:!0};this.mutationObserver=new m(function(){u.$nextTick(function(){u.computeCarouselWidth()})}),this.$parent.$el&&this.mutationObserver.observe(this.$parent.$el,p)}},handleNavigation:function(u){this.advancePage(u)},detachMutationObserver:function(){this.mutationObserver&&this.mutationObserver.disconnect()},getBrowserWidth:function(){return this.browserWidth=window.innerWidth,this.browserWidth},getCarouselWidth:function(){return this.carouselWidth=this.$el&&this.$el.clientWidth||0,this.carouselWidth},getSlideCount:function(){this.slideCount=this.$slots&&this.$slots.default&&this.$slots.default.filter(function(u){return u.tag&&u.tag.indexOf("slide")>-1}).length||0},goToPage:function(u){u>=0&&u<=this.pageCount&&(this.offset=Math.min(this.slideWidth*this.currentPerPage*u,this.maxOffset),this.currentPage=u)},onStart:function(u){document.addEventListener(this.isTouch?"touchend":"mouseup",this.onEnd,!0),document.addEventListener(this.isTouch?"touchmove":"mousemove",this.onDrag,!0),this.startTime=u.timeStamp,this.dragging=!0,this.dragStartX=this.isTouch?u.touches[0].clientX:u.clientX,this.dragStartY=this.isTouch?u.touches[0].clientY:u.clientY},onEnd:function(u){var m=this.isTouch?u.changedTouches[0].clientX:u.clientX,p=this.dragStartX-m;if(this.dragMomentum=p/(u.timeStamp-this.startTime),this.minSwipeDistance!==0&&Math.abs(p)>=this.minSwipeDistance){var v=this.scrollPerPage?this.slideWidth*this.currentPerPage:this.slideWidth;this.dragOffset=this.dragOffset+(0,o.default)(p)*(v/2)}this.offset+=this.dragOffset,this.dragOffset=0,this.dragging=!1,this.render(),document.removeEventListener(this.isTouch?"touchend":"mouseup",this.onEnd,!0),document.removeEventListener(this.isTouch?"touchmove":"mousemove",this.onDrag,!0)},onDrag:function(u){var m=this.isTouch?u.touches[0].clientX:u.clientX,p=this.isTouch?u.touches[0].clientY:u.clientY,v=this.dragStartX-m,y=this.dragStartY-p;if(!(this.isTouch&&Math.abs(v)<Math.abs(y))){u.preventDefault(),u.stopImmediatePropagation(),this.dragOffset=v;var x=this.offset+this.dragOffset;x<0?this.dragOffset=-Math.sqrt(-this.resistanceCoef*this.dragOffset):x>this.maxOffset&&(this.dragOffset=Math.sqrt(this.resistanceCoef*this.dragOffset))}},onResize:function(){var u=this;this.computeCarouselWidth(),this.dragging=!0,this.render(),setTimeout(function(){u.dragging=!1},this.refreshRate)},render:function(){this.offset+=Math.max(-this.currentPerPage+1,Math.min(Math.round(this.dragMomentum),this.currentPerPage-1))*this.slideWidth;var u=this.scrollPerPage?this.slideWidth*this.currentPerPage:this.slideWidth;this.offset=u*Math.round(this.offset/u),this.offset=Math.max(0,Math.min(this.offset,this.maxOffset)),this.currentPage=Math.round(this.offset/this.slideWidth/this.currentPerPage)},computeCarouselWidth:function(){this.getSlideCount(),this.getBrowserWidth(),this.getCarouselWidth(),this.setCurrentPageInBounds()},setCurrentPageInBounds:function(){if(!this.canAdvanceForward){var u=this.pageCount-1;this.currentPage=u>=0?u:0,this.offset=Math.max(0,Math.min(this.offset,this.maxOffset))}}},mounted:function(){this.$isServer||(window.addEventListener("resize",(0,E.default)(this.onResize,this.refreshRate)),(this.isTouch||this.mouseDrag)&&this.$refs["VueCarousel-wrapper"].addEventListener(this.isTouch?"touchstart":"mousedown",this.onStart)),this.attachMutationObserver(),this.computeCarouselWidth()},beforeDestroy:function(){this.$isServer||(this.detachMutationObserver(),window.removeEventListener("resize",this.getBrowserWidth),this.$refs["VueCarousel-wrapper"].removeEventListener(this.isTouch?"touchstart":"mousedown",this.onStart))}}},function(n,i,s){n.exports={default:s(10),__esModule:!0}},function(n,i,s){s(11),n.exports=s(14).Math.sign},function(n,i,s){var r=s(12);r(r.S,"Math",{sign:s(28)})},function(n,i,s){var r=s(13),a=s(14),o=s(15),c=s(17),f=s(27),g="prototype",E=function(A,N,$){var b,_,l,u=A&E.F,m=A&E.G,p=A&E.S,v=A&E.P,y=A&E.B,x=A&E.W,M=m?a:a[N]||(a[N]={}),R=M[g],L=m?r:p?r[N]:(r[N]||{})[g];m&&($=N);for(b in $)_=!u&&L&&L[b]!==void 0,_&&f(M,b)||(l=_?L[b]:$[b],M[b]=m&&typeof L[b]!="function"?$[b]:y&&_?o(l,r):x&&L[b]==l?function(D){var C=function(w,O,F){if(this instanceof D){switch(arguments.length){case 0:return new D;case 1:return new D(w);case 2:return new D(w,O)}return new D(w,O,F)}return D.apply(this,arguments)};return C[g]=D[g],C}(l):v&&typeof l=="function"?o(Function.call,l):l,v&&((M.virtual||(M.virtual={}))[b]=l,A&E.R&&R&&!R[b]&&c(R,b,l)))};E.F=1,E.G=2,E.S=4,E.P=8,E.B=16,E.W=32,E.U=64,E.R=128,n.exports=E},function(n,i){var s=n.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=s)},function(n,i){var s=n.exports={version:"2.5.4"};typeof __e=="number"&&(__e=s)},function(n,i,s){var r=s(16);n.exports=function(a,o,c){if(r(a),o===void 0)return a;switch(c){case 1:return function(f){return a.call(o,f)};case 2:return function(f,g){return a.call(o,f,g)};case 3:return function(f,g,E){return a.call(o,f,g,E)}}return function(){return a.apply(o,arguments)}}},function(n,i){n.exports=function(s){if(typeof s!="function")throw TypeError(s+" is not a function!");return s}},function(n,i,s){var r=s(18),a=s(26);n.exports=s(22)?function(o,c,f){return r.f(o,c,a(1,f))}:function(o,c,f){return o[c]=f,o}},function(n,i,s){var r=s(19),a=s(21),o=s(25),c=Object.defineProperty;i.f=s(22)?Object.defineProperty:function(f,g,E){if(r(f),g=o(g,!0),r(E),a)try{return c(f,g,E)}catch(A){}if("get"in E||"set"in E)throw TypeError("Accessors not supported!");return"value"in E&&(f[g]=E.value),f}},function(n,i,s){var r=s(20);n.exports=function(a){if(!r(a))throw TypeError(a+" is not an object!");return a}},function(n,i){n.exports=function(s){return typeof s=="object"?s!==null:typeof s=="function"}},function(n,i,s){n.exports=!s(22)&&!s(23)(function(){return Object.defineProperty(s(24)("div"),"a",{get:function(){return 7}}).a!=7})},function(n,i,s){n.exports=!s(23)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(n,i){n.exports=function(s){try{return!!s()}catch(r){return!0}}},function(n,i,s){var r=s(20),a=s(13).document,o=r(a)&&r(a.createElement);n.exports=function(c){return o?a.createElement(c):{}}},function(n,i,s){var r=s(20);n.exports=function(a,o){if(!r(a))return a;var c,f;if(o&&typeof(c=a.toString)=="function"&&!r(f=c.call(a))||typeof(c=a.valueOf)=="function"&&!r(f=c.call(a))||!o&&typeof(c=a.toString)=="function"&&!r(f=c.call(a)))return f;throw TypeError("Can't convert object to primitive value")}},function(n,i){n.exports=function(s,r){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:r}}},function(n,i){var s={}.hasOwnProperty;n.exports=function(r,a){return s.call(r,a)}},function(n,i){n.exports=Math.sign||function(s){return(s=+s)==0||s!=s?s:s<0?-1:1}},function(n,i){Object.defineProperty(i,"__esModule",{value:!0});var s={props:{autoplay:{type:Boolean,default:!1},autoplayTimeout:{type:Number,default:2e3},autoplayHoverPause:{type:Boolean,default:!0}},data:function(){return{autoplayInterval:null}},destroyed:function(){this.$isServer||(this.$el.removeEventListener("mouseenter",this.pauseAutoplay),this.$el.removeEventListener("mouseleave",this.startAutoplay))},methods:{pauseAutoplay:function(){this.autoplayInterval&&(this.autoplayInterval=clearInterval(this.autoplayInterval))},startAutoplay:function(){this.autoplay&&(this.autoplayInterval=setInterval(this.advancePage,this.autoplayTimeout))}},mounted:function(){!this.$isServer&&this.autoplayHoverPause&&(this.$el.addEventListener("mouseenter",this.pauseAutoplay),this.$el.addEventListener("mouseleave",this.startAutoplay)),this.startAutoplay()}};i.default=s},function(n,i){Object.defineProperty(i,"__esModule",{value:!0});var s=function(r,a,o){var c=void 0;return function(){var f=void 0,g=function(){c=null,o||r.apply(f)},E=o&&!c;clearTimeout(c),c=setTimeout(g,a),E&&r.apply(f)}};i.default=s},function(n,i,s){function r(o){s(32)}var a=s(7)(s(34),s(35),r,"data-v-7fed18e9",null);n.exports=a.exports},function(n,i,s){var r=s(33);typeof r=="string"&&(r=[[n.id,r,""]]),r.locals&&(n.exports=r.locals),s(5)("a1957e6c",r,!0,{})},function(n,i,s){i=n.exports=s(4)(),i.push([n.id,".VueCarousel-navigation-button[data-v-7fed18e9]{position:absolute;top:50%;box-sizing:border-box;color:#000;text-decoration:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;background-color:transparent;padding:0;cursor:pointer;outline:none}.VueCarousel-navigation-next[data-v-7fed18e9]{right:0;transform:translateY(-50%) translateX(100%)}.VueCarousel-navigation-prev[data-v-7fed18e9]{left:0;transform:translateY(-50%) translateX(-100%)}.VueCarousel-navigation--disabled[data-v-7fed18e9]{opacity:.5;cursor:default}",""])},function(n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"navigation",data:function(){return{parentContainer:this.$parent}},props:{clickTargetSize:{type:Number,default:8},nextLabel:{type:String,default:"\u25B6"},prevLabel:{type:String,default:"\u25C0"}},computed:{canAdvanceForward:function(){return this.parentContainer.canAdvanceForward||!1},canAdvanceBackward:function(){return this.parentContainer.canAdvanceBackward||!1}},methods:{triggerPageAdvance:function(s){this.$emit("navigationclick",s)}}}},function(n,i){n.exports={render:function(){var s=this,r=s.$createElement,a=s._self._c||r;return a("div",{staticClass:"VueCarousel-navigation"},[a("button",{staticClass:"VueCarousel-navigation-button VueCarousel-navigation-prev",class:{"VueCarousel-navigation--disabled":!s.canAdvanceBackward},style:"padding: "+s.clickTargetSize+"px; margin-right: -"+s.clickTargetSize+"px;",attrs:{type:"button","aria-label":"Previous page",role:"button"},domProps:{innerHTML:s._s(s.prevLabel)},on:{click:function(o){o.preventDefault(),s.triggerPageAdvance("backward")}}}),s._v(" "),a("button",{staticClass:"VueCarousel-navigation-button VueCarousel-navigation-next",class:{"VueCarousel-navigation--disabled":!s.canAdvanceForward},style:"padding: "+s.clickTargetSize+"px; margin-left: -"+s.clickTargetSize+"px;",attrs:{type:"button","aria-label":"Next page",role:"button"},domProps:{innerHTML:s._s(s.nextLabel)},on:{click:function(o){o.preventDefault(),s.triggerPageAdvance()}}})])},staticRenderFns:[]}},function(n,i,s){function r(o){s(37)}var a=s(7)(s(39),s(40),r,"data-v-7e42136f",null);n.exports=a.exports},function(n,i,s){var r=s(38);typeof r=="string"&&(r=[[n.id,r,""]]),r.locals&&(n.exports=r.locals),s(5)("3ea8dd5f",r,!0,{})},function(n,i,s){i=n.exports=s(4)(),i.push([n.id,".VueCarousel-pagination[data-v-7e42136f]{width:100%;text-align:center}.VueCarousel-dot-container[data-v-7e42136f]{display:inline-block;margin:0 auto;padding:0}.VueCarousel-dot[data-v-7e42136f]{display:inline-block;cursor:pointer}.VueCarousel-dot-button[data-v-7e42136f]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;background-color:transparent;padding:0;border-radius:100%;outline:none;cursor:pointer}.VueCarousel-dot-button[data-v-7e42136f]:focus{outline:1px solid #add8e6}",""])},function(n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"pagination",data:function(){return{parentContainer:this.$parent}},methods:{goToPage:function(s){this.$emit("paginationclick",s)},isCurrentDot:function(s){return s===this.parentContainer.currentPage}}}},function(n,i){n.exports={render:function(){var s=this,r=s.$createElement,a=s._self._c||r;return a("div",{directives:[{name:"show",rawName:"v-show",value:s.parentContainer.pageCount>1,expression:"parentContainer.pageCount > 1"}],staticClass:"VueCarousel-pagination"},[a("ul",{staticClass:"VueCarousel-dot-container",attrs:{role:"tablist"}},s._l(s.parentContainer.pageCount,function(o,c){return a("li",{key:c,staticClass:"VueCarousel-dot",class:{"VueCarousel-dot--active":s.isCurrentDot(c)},style:`
        margin-top: `+2*s.parentContainer.paginationPadding+`px;
        padding: `+s.parentContainer.paginationPadding+`px;
      `,attrs:{"aria-hidden":"false",role:"presentation","aria-selected":s.isCurrentDot(c)?"true":"false"},on:{click:function(f){s.goToPage(c)}}},[a("button",{staticClass:"VueCarousel-dot-button",style:`
          width: `+s.parentContainer.paginationSize+`px;
          height: `+s.parentContainer.paginationSize+`px;
          background: `+(s.isCurrentDot(c)?s.parentContainer.paginationActiveColor:s.parentContainer.paginationColor)+`;
        `,attrs:{type:"button",role:"button",tabindex:c}})])}))])},staticRenderFns:[]}},function(n,i,s){function r(o){s(42)}var a=s(7)(s(44),s(45),r,null,null);n.exports=a.exports},function(n,i,s){var r=s(43);typeof r=="string"&&(r=[[n.id,r,""]]),r.locals&&(n.exports=r.locals),s(5)("e8ab14d8",r,!0,{})},function(n,i,s){i=n.exports=s(4)(),i.push([n.id,".VueCarousel-slide{-ms-flex-preferred-size:inherit;flex-basis:inherit;-ms-flex-positive:0;flex-grow:0;-ms-flex-negative:0;flex-shrink:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-touch-callout:none;outline:none}",""])},function(n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"slide",data:function(){return{width:null}},mounted:function(){this.$isServer||this.$el.addEventListener("dragstart",function(s){return s.preventDefault()})}}},function(n,i){n.exports={render:function(){var s=this,r=s.$createElement,a=s._self._c||r;return a("div",{staticClass:"VueCarousel-slide",attrs:{tabindex:"-1"}},[s._t("default")],2)},staticRenderFns:[]}},function(n,i){n.exports={render:function(){var s=this,r=s.$createElement,a=s._self._c||r;return a("section",{staticClass:"VueCarousel"},[a("div",{ref:"VueCarousel-wrapper",staticClass:"VueCarousel-wrapper"},[a("div",{staticClass:"VueCarousel-inner",style:`
        transform: translate3d(`+s.currentOffset+`px, 0, 0);
        transition: `+(s.dragging?"none":s.transitionStyle)+`;
        ms-flex-preferred-size: `+s.slideWidth+`px;
        webkit-flex-basis: `+s.slideWidth+`px;
        flex-basis: `+s.slideWidth+`px;
        visibility: `+(s.slideWidth?"visible":"hidden")+`;
        padding-left: `+s.padding+`px;
        padding-right: `+s.padding+`px;
      `,attrs:{role:"listbox"}},[s._t("default")],2)]),s._v(" "),s.paginationEnabled&&s.pageCount>0?a("pagination",{on:{paginationclick:function(o){s.goToPage(o,"pagination")}}}):s._e(),s._v(" "),s.navigationEnabled?a("navigation",{attrs:{clickTargetSize:s.navigationClickTargetSize,nextLabel:s.navigationNextLabel,prevLabel:s.navigationPrevLabel},on:{navigationclick:s.handleNavigation}}):s._e()],1)},staticRenderFns:[]}}])})})(Wi);const fm={name:"ElementCarousel",components:{Carousel:Wi.exports.Carousel,Slide:Wi.exports.Slide},props:["element","someLocalProperty"],methods:{openLink(t){!t||(this.isSameHost(t,window.location.href)?window.location.assign(t):window.open(t,"_blank"))},sendMessage(t,e){const n=document.createElement("div");n.className="nlc-btn-loader",t.target.append(n),d.dispatch("sendMessage",e)},isValidHttpUrl(t){let e;try{e=new URL(t)}catch(n){return!1}return e.protocol==="http:"||e.protocol==="https:"},isSameHost(t,e){return new URL(t).host===new URL(e).host}}};var pm=function(){var e=this,n=e._self._c;return n("div",{staticClass:"nlc-chatbot-answer-carousel"},[n("carousel",{staticClass:"nlc-chatbot-answer-carousel",attrs:{"per-page":1,"pagination-enabled":!0,"navigation-enabled":!0}},e._l(e.element.carouselElements,function(i){return n("slide",[n("div",{staticClass:"nlc-chatbot-answer-carousel-element"},[n("div",{staticClass:"nlc-chatbot-title nlc-chatbot-answer-carousel-title"},[e._v(" "+e._s(i.title)+" ")]),i.subtitle?n("div",{staticClass:"nlc-chatbot-subtitle nlc-chatbot-answer-carousel-subtitle"},[e._v(" "+e._s(i.subtitle)+" ")]):e._e(),i.imageUri?n("div",{staticClass:"nlc-chatbot-image nlc-chatbot-answer-carousel-image"},[i.defaultAction&&i.defaultAction.type==="web_url"&&i.defaultAction.url?n("a",{attrs:{href:i.defaultAction.url,target:"_blank"}},[n("img",{staticClass:"nlc-chatbot-answer-carousel-image-img",attrs:{src:i.imageUri,alt:i.title}})]):e._e(),!i.defaultAction||i.defaultAction.type!=="web_url"||!i.defaultAction.url?n("img",{staticClass:"nlc-chatbot-answer-carousel-image-img",attrs:{src:i.imageUri,alt:i.title}}):e._e()]):e._e(),i.buttons&&i.buttons.length>0?n("div",{staticClass:"nlc-chatbot-buttons nlc-chatbot-answer-carousel-buttons"},e._l(i.buttons,function(s){return n("span",{staticClass:"nlc-chatbot-button-item nlc-chatbot-answer-carousel-button-item"},[s.url&&s.type==="web_url"?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-btn-margin nlc-ui-btn-block",on:{click:function(r){return e.openLink(s.url)}}},[e._v(" "+e._s(s.title)+" ")]):e._e(),!s.url||s.type!=="web_url"?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-btn-margin nlc-ui-btn-block",on:{click:r=>e.sendMessage(r,s.payload)}},[e._v(" "+e._s(s.title)+" ")]):e._e()])}),0):e._e()])])}),1)],1)},gm=[],mm=he(fm,pm,gm,!1,null,null,null,null);const _m=mm.exports,vm={name:"Message",components:{ElementCard:Xg,ElementImage:Yg,ElementQuickReply:nm,ElementText:om,ElementTextWithButtons:hm,ElementCarousel:_m},props:["elements"],methods:{isText(t){return t===xe.TEXT},isImage(t){return t===xe.IMAGE},isCard(t){return t===xe.CARD},isQuickReply(t){return t===xe.QUICK_REPLY},isTextWithButtons(t){return t===xe.TEXT_WITH_BUTTONS},isCarousel(t){return t===xe.CAROUSEL},groupByType(t){const e=()=>({type:null,elements:[]}),n=[];let i=e(),s=null;const r=o=>{o.type===null||o.elements.length===0||n.push(o)},a=(o,c)=>{c.type===null&&(c.type=o.type),c.elements.push(o),o.type===xe.TEXT?s=null:s=o.type};return t.forEach(o=>{o.type!==s&&(r(i),i=e()),a(o,i)}),r(i),n},getChatbotMessageClass(t,e){return t+"-"+e.type}}};var ym=function(){var e=this,n=e._self._c;return n("div",e._l(e.groupByType(e.elements),function(i){return n("div",{staticClass:"nlc-chatbot-message",class:e.getChatbotMessageClass("nlc-chatbot-message",i),attrs:{"data-type":i.type,"data-children":i.elements.length}},e._l(i.elements,function(s){return n("div",{staticClass:"nlc-chatbot-element",class:e.getChatbotMessageClass("nlc-chatbot-element",i)},[e.isText(s.type)?n("ElementText",{attrs:{text:s.text}}):e._e(),e.isImage(s.type)?n("ElementImage",{attrs:{"image-uri":s.imageUri,"accessibility-text":s.accessibilityText}}):e._e(),e.isCard(s.type)?n("ElementCard",{attrs:{title:s.title,subtitle:s.subtitle,"image-uri":s.imageUri,buttons:s.buttons}}):e._e(),e.isQuickReply(s.type)?n("ElementQuickReply",{attrs:{title:s.title}}):e._e(),e.isTextWithButtons(s.type)?n("ElementTextWithButtons",{attrs:{text:s.text,buttons:s.buttons}}):e._e(),e.isCarousel(s.type)?n("ElementCarousel",{attrs:{element:s}}):e._e(),!e.isText(s.type)&&!e.isImage(s.type)&&!e.isCard(s.type)&&!e.isQuickReply(s.type)&&!e.isTextWithButtons(s.type)&&!e.isCarousel(s.type)?n("pre",{staticStyle:{"font-size":".7em","line-height":"1.1em",color:"darkgrey"}},[e._v(e._s(s))]):e._e()],1)}),0)}),0)},bm=[],Cm=he(vm,ym,bm,!1,null,null,null,null);const wm=Cm.exports,Sm={name:"OneMessage",components:{ChatbotMessage:wm},props:["message","chatbotEl","messageIndex"],methods:{downloadAttachment(t){t&&d.dispatch("downloadAttachment",t)},isReceiptEnable(t){if(t.receipt===!1)return!1;const e=t.chatbotContext===ie.CHATBOT_ONLY;return K.apiSettings.enabled_receipts&&!e},getAvatar(t){return t.rel==="nespresso_chatbot"||t.rel==="welcome"&&t.id==="chatbot_welcome"?this.getImagePath("chatbot-icon.svg"):this.getImagePath("agent-icon.svg")},formatMessage(t){const e=parseInt(K.apiSettings.time_format,10)===12?13:9;return`${t} ${Array(e).join("&nbsp;")}`},formatTime(t){return fe.formatTime(new Date(t),K.apiSettings.time_format)},getImagePath(t){return`${K.frontBaseUrl}/apps/calleo-livechat/img/${t}`}}};var Tm=function(){var e=this,n=e._self._c;return n("li",{class:{new:!e.message.read},attrs:{rel:e.message.rel,"data-message-index":e.messageIndex}},[e.message.operator?n("div",{staticClass:"nlc-author"},[n("figure",[n("img",{attrs:{src:e.getAvatar(e.message),alt:e.message.operator.name}})]),n("span",{staticClass:"nlc-author-name"},[e._v(e._s(e.message.operator.name))])]):e._e(),n("div",{staticClass:"nlc-message",class:{attachment:!!e.message.attachment},attrs:{"aria-role":"log","aria-live":"assertive","aria-atomic":"false","aria-relevant":"additions"},on:{click:function(i){e.message.attachment&&e.downloadAttachment(e.message.attachment)}}},[e.message.attachment?n("img",{staticClass:"nlc-ui-msg-attachment-icon",attrs:{src:e.getImagePath("icon-attachment.svg"),alt:"Attachment"}}):e._e(),e.message.chatbot?e._e():n("span",{staticClass:"sessioncamhidetext",domProps:{innerHTML:e._s(e.formatMessage(e.message.message))}}),e.chatbotEl?n("ChatbotMessage",{attrs:{elements:[e.chatbotEl]}}):e._e(),e.message.image&&(e.message.message||e.message.chatbot)?n("br"):e._e(),e.message.image?n("img",{attrs:{src:e.message.image}}):e._e()],1),n("div",{staticStyle:{"text-align":"right"}},[n("time",{attrs:{datetime:""}},[e._v(e._s(e.formatTime(e.message.time)))]),e.isReceiptEnable(e.message)&&e.message.receipt===!0?n("img",{attrs:{src:e.getImagePath("icon-checkmark-grey.svg"),alt:"Icon",width:"15px",height:"15px"}}):e.isReceiptEnable(e.message)&&typeof e.message.receipt!="undefined"&&e.message.receipt!=null?n("img",{attrs:{src:e.getImagePath("stop-watch.svg"),alt:"Icon",width:"15px",height:"15px"}}):e._e()])])},Em=[],Am=he(Sm,Tm,Em,!1,null,null,null,null);const xm=Am.exports,km={name:"QuickReplyAnswers",store:d,computed:ue({},Te.exports.mapGetters(["quickReplyAnswers","disconnected","apiError"])),methods:{sendMessage(t,e){let n=e.text;if(e.payload){n=e.payload;const i=document.createElement("div");i.className="nlc-btn-loader",(t.target.nodeName==="SPAN"||t.target.nodeName==="BUTTON")&&t.target.append(i)}d.dispatch("sendMessage",n)}}};var Om=function(){var e=this,n=e._self._c;return e.quickReplyAnswers.length>0?n("div",{staticClass:"nlc-quick-reply-answers"},[e._l(e.quickReplyAnswers,function(i,s){return[i.text?n("button",{key:s,staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small",class:{"is-disabled":e.disconnected||e.apiError},on:{click:r=>e.sendMessage(r,i)}},[e._v(" "+e._s(i.text)+" ")]):e._e()]})],2):e._e()},Im=[],Mm=he(km,Om,Im,!1,null,null,null,null);const Rm=Mm.exports,Nm={name:"Messages",components:{Message:xm,ChatbotQuickReplyAnswers:Rm},computed:Re(ue({},Te.exports.mapGetters(["isTyping","messages","message","vueMessage","quickReplyAnswers","close","whoClosed","rating","toConfirmHandover","toRegisterHandover"])),{closedByMessage(){const t=d.state.request.chatbotStatus,e=K.apiSettings.chatbot_enabled_rating_form,n=d.state.xmppSession;return(this.whoClosed==="close"||this.whoClosed==="close_link"||this.whoClosed==="handover")&&t===ie.CHATBOT_HANDOVER&&n.lastOperatorChange===null?this._("livechat.closed_whitout_rating_customer"):(this.whoClosed==="close"||this.whoClosed==="close_link"||this.whoClosed==="handover")&&t===ie.CHATBOT_HANDOVER&&n.lastOperatorChange!==null?e?this._("livechat.closed_by_you"):this._("livechat.closed_whitout_rating_customer"):this.whoClosed==="operator"&&t===ie.CHATBOT_HANDOVER&&n.lastOperatorChange!==null?e?this._("livechat.closed_by_operator"):this._("livechat.closed_whitout_rating_operator"):this.whoClosed==="chatbot"?this._("livechat.closed_by_chatbot"):""}}),props:["config","list"],watch:{isTyping(){this.$emit("newMessage")},messages(){this.$emit("newMessage")},close(){this.$emit("newMessage")}},methods:{getAvatar(){return`${K.frontBaseUrl}/c/apps/calleo-livechat/img/agent-icon.svg`},downloadAttachment(t){t&&d.dispatch("downloadAttachment",t)},goToRating(){d.dispatch("showRating")}}};var Lm=function(){var e=this,n=e._self._c;return n("div",[n("ul",{staticClass:"nlc-livechat"},[e._l(e.messages,function(i){return[i.chatbot?e._e():n("Message",{attrs:{message:i,"message-index":0}}),i.chatbot?[e._l(i.chatbot.elements,function(s,r){return[n("Message",{attrs:{"chatbot-el":s,message:i,"message-index":r}})]})]:e._e()]}),e.isTyping?n("li",{staticClass:"nlc-is-typing",attrs:{rel:"nespresso"}},[n("div",{staticClass:"nlc-message",attrs:{"aria-role":"log","aria-live":"assertive","aria-atomic":"false","aria-relevant":"additions"}},[n("div",{staticClass:"nlc-author"},[n("figure",[n("img",{attrs:{src:e.getAvatar(),alt:e.isTyping.name}})])]),n("ul",{staticClass:"nlc-typing",attrs:{title:e._("livechat.is_typing")}},[n("li"),n("li"),n("li")])])]):e._e(),e.close?n("li",{staticClass:"nlc-is-closed",attrs:{rel:"nespresso"}},[n("div",[e.closedByMessage?n("span",[e._v(e._s(e.closedByMessage))]):e.whoClosed===null?n("span",[e._v(e._s(e._("livechat.closed_by_nobody")))]):e._e()])]):e._e()],2),e.vueMessage?n("ChatbotQuickReplyAnswers"):e._e(),n("div",{staticClass:"nlc-spacer-on-scroll-zone",attrs:{id:"nlc-spacer-on-scroll-zone"}})],1)},Pm=[],$m=he(Nm,Lm,Pm,!1,null,null,null,null);const Fm=$m.exports,Dm={name:"ScreenMirroring",computed:ue(ue({},Te.exports.mapState("ScreenMirroring",["requested","accepted","acceptedRecently","inProgress"])),Te.exports.mapGetters("ScreenMirroring",["shouldShowAskForm","shouldStartMirroring"])),mutations:ue({},Te.exports.mapMutations("ScreenMirroring",["acceptInvitation","denyInvitation","receiveInvitation","receiveCancelInvitation","mirroringInProgress"])),updated(){this.$nextTick(()=>{this.$emit("resize")})},mounted(){this.shouldStartMirroring&&(window.addEventListener("calleo-screen-mirroring-load",()=>{this.acceptInvitation(!1)}),Xe.init())},methods:{acceptInvitation(t=!0){this.$store.commit("ScreenMirroring/acceptInvitation"),t&&(this.$store.commit("ScreenMirroring/set",{acceptedRecently:!0}),setTimeout(()=>{this.$store.commit("ScreenMirroring/set",{acceptedRecently:!1})},5e3),Xe.sendXMPPMessage("screen-mirroring-acceptation",!0)),Xe.load(),Xe.sendXMPPMessage("screen-mirroring-reconnect",!0)},denyInvitation(){this.$store.commit("ScreenMirroring/denyInvitation"),Xe.sendXMPPMessage("screen-mirroring-acceptation",!1)}}};var Hm=function(){var e=this,n=e._self._c;return n("div",[e.shouldShowAskForm?n("div",[n("div",{staticClass:"screen-mirroring-text"},[n("span",{domProps:{innerHTML:e._s(e._("js_screen_mirroring.ask_for_acceptation"))}})]),n("div",{staticClass:"screen-mirroring-button-container"},[n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-small nlc-ui-mb-1",on:{click:e.acceptInvitation}},[n("span",[e._v(e._s(e._("js_screen_mirroring.yes")))])]),n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-inverted nlc-ui-btn-small nlc-ui-mb-1",on:{click:e.denyInvitation}},[n("span",[e._v(e._s(e._("js_screen_mirroring.no")))])])])]):e._e(),e.acceptedRecently?n("div",[n("div",{staticClass:"screen-mirroring-text"},[n("span",{staticClass:"fa fa-check"}),n("span",[e._v(e._s(e._("js_screen_mirroring.acceptation_answer_saved")))])])]):e._e(),e.inProgress?n("div",{staticClass:"mirroring-in-progress screen-mirroring-text"},[n("span",[e._v(e._s(e._("js_screen_mirroring.mirroring_in_progress")))])]):e._e()])},qm=[],Um=he(Dm,Hm,qm,!1,null,null,null,null);const Bm=Um.exports;var wo={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(xt,function(){var n,i=(function(r){var a=function(){function b(_,l){for(var u=0;u<l.length;u++){var m=l[u];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(_,m.key,m)}}return function(_,l,u){return l&&b(_.prototype,l),u&&b(_,u),_}}();function o(b,_){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!_||typeof _!="object"&&typeof _!="function"?b:_}function c(b,_){if(!(b instanceof _))throw new TypeError("Cannot call a class as a function")}var f=function(){function b(){c(this,b)}return a(b,[{key:"on",value:function(_,l){return this._callbacks=this._callbacks||{},this._callbacks[_]||(this._callbacks[_]=[]),this._callbacks[_].push(l),this}},{key:"emit",value:function(_){this._callbacks=this._callbacks||{};var l=this._callbacks[_];if(l){for(var u=arguments.length,m=Array(u>1?u-1:0),p=1;p<u;p++)m[p-1]=arguments[p];for(var v=0,y=y=l;!(v>=y.length);)y[v++].apply(this,m)}return this}},{key:"off",value:function(_,l){if(!this._callbacks||arguments.length===0)return this._callbacks={},this;var u=this._callbacks[_];if(!u)return this;if(arguments.length===1)return delete this._callbacks[_],this;for(var m=0;m<u.length;m++)if(u[m]===l){u.splice(m,1);break}return this}}]),b}(),g=function(b){function _(l,u){c(this,_);var m,p=o(this,(_.__proto__||Object.getPrototypeOf(_)).call(this)),v=void 0;if(p.element=l,p.version=_.version,p.defaultOptions.previewTemplate=p.defaultOptions.previewTemplate.replace(/\n*/g,""),p.clickableElements=[],p.listeners=[],p.files=[],typeof p.element=="string"&&(p.element=document.querySelector(p.element)),!p.element||p.element.nodeType==null)throw new Error("Invalid dropzone element.");if(p.element.dropzone)throw new Error("Dropzone already attached.");_.instances.push(p),p.element.dropzone=p;var y,x=(m=_.optionsForElement(p.element))!=null?m:{};if(p.options=_.extend({},p.defaultOptions,x,u!=null?u:{}),p.options.forceFallback||!_.isBrowserSupported())return y=p.options.fallback.call(p),o(p,y);if(p.options.url==null&&(p.options.url=p.element.getAttribute("action")),!p.options.url)throw new Error("No URL provided.");if(p.options.acceptedFiles&&p.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(p.options.uploadMultiple&&p.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");return p.options.acceptedMimeTypes&&(p.options.acceptedFiles=p.options.acceptedMimeTypes,delete p.options.acceptedMimeTypes),p.options.renameFilename!=null&&(p.options.renameFile=function(M){return p.options.renameFilename.call(p,M.name,M)}),p.options.method=p.options.method.toUpperCase(),(v=p.getExistingFallback())&&v.parentNode&&v.parentNode.removeChild(v),p.options.previewsContainer!==!1&&(p.options.previewsContainer?p.previewsContainer=_.getElement(p.options.previewsContainer,"previewsContainer"):p.previewsContainer=p.element),p.options.clickable&&(p.options.clickable===!0?p.clickableElements=[p.element]:p.clickableElements=_.getElements(p.options.clickable,"clickable")),p.init(),p}return function(l,u){if(typeof u!="function"&&u!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof u);l.prototype=Object.create(u&&u.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(l,u):l.__proto__=u)}(_,f),a(_,null,[{key:"initClass",value:function(){this.prototype.Emitter=f,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,timeout:3e4,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2e6,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictUploadCanceled:"Upload canceled.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init:function(){},params:function(l,u,m){if(m)return{dzuuid:m.file.upload.uuid,dzchunkindex:m.index,dztotalfilesize:m.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:m.file.upload.totalChunkCount,dzchunkbyteoffset:m.index*this.options.chunkSize}},accept:function(l,u){return u()},chunksUploaded:function(l,u){u()},fallback:function(){var l=void 0;this.element.className=this.element.className+" dz-browser-not-supported";for(var u=0,m=m=this.element.getElementsByTagName("div");!(u>=m.length);){var p=m[u++];if(/(^| )dz-message($| )/.test(p.className)){l=p,p.className="dz-message";break}}l||(l=_.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(l));var v=l.getElementsByTagName("span")[0];return v&&(v.textContent!=null?v.textContent=this.options.dictFallbackMessage:v.innerText!=null&&(v.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(l,u,m,p){var v={srcX:0,srcY:0,srcWidth:l.width,srcHeight:l.height},y=l.width/l.height;u==null&&m==null?(u=v.srcWidth,m=v.srcHeight):u==null?u=m*y:m==null&&(m=u/y);var x=(u=Math.min(u,v.srcWidth))/(m=Math.min(m,v.srcHeight));if(v.srcWidth>u||v.srcHeight>m)if(p==="crop")y>x?(v.srcHeight=l.height,v.srcWidth=v.srcHeight*x):(v.srcWidth=l.width,v.srcHeight=v.srcWidth/x);else{if(p!=="contain")throw new Error("Unknown resizeMethod '"+p+"'");y>x?m=u/y:u=m*y}return v.srcX=(l.width-v.srcWidth)/2,v.srcY=(l.height-v.srcHeight)/2,v.trgWidth=u,v.trgHeight=m,v},transformFile:function(l,u){return(this.options.resizeWidth||this.options.resizeHeight)&&l.type.match(/image.*/)?this.resizeImage(l,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,u):u(l)},previewTemplate:`<div class="dz-preview dz-file-preview">
  <div class="dz-image"><img data-dz-thumbnail /></div>
  <div class="dz-details">
    <div class="dz-size"><span data-dz-size></span></div>
    <div class="dz-filename"><span data-dz-name></span></div>
  </div>
  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>
  <div class="dz-error-message"><span data-dz-errormessage></span></div>
  <div class="dz-success-mark">
    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
      <title>Check</title>
      <defs></defs>
      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
      </g>
    </svg>
  </div>
  <div class="dz-error-mark">
    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
      <title>Error</title>
      <defs></defs>
      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">
          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>
        </g>
      </g>
    </svg>
  </div>
</div>`,drop:function(l){return this.element.classList.remove("dz-drag-hover")},dragstart:function(l){},dragend:function(l){return this.element.classList.remove("dz-drag-hover")},dragenter:function(l){return this.element.classList.add("dz-drag-hover")},dragover:function(l){return this.element.classList.add("dz-drag-hover")},dragleave:function(l){return this.element.classList.remove("dz-drag-hover")},paste:function(l){},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(l){var u=this;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){l.previewElement=_.createElement(this.options.previewTemplate.trim()),l.previewTemplate=l.previewElement,this.previewsContainer.appendChild(l.previewElement);for(var m=0,p=p=l.previewElement.querySelectorAll("[data-dz-name]");!(m>=p.length);){var v=p[m++];v.textContent=l.name}for(var y=0,x=x=l.previewElement.querySelectorAll("[data-dz-size]");!(y>=x.length);)(v=x[y++]).innerHTML=this.filesize(l.size);this.options.addRemoveLinks&&(l._removeLink=_.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),l.previewElement.appendChild(l._removeLink));for(var M=function(D){return D.preventDefault(),D.stopPropagation(),l.status===_.UPLOADING?_.confirm(u.options.dictCancelUploadConfirmation,function(){return u.removeFile(l)}):u.options.dictRemoveFileConfirmation?_.confirm(u.options.dictRemoveFileConfirmation,function(){return u.removeFile(l)}):u.removeFile(l)},R=0,L=L=l.previewElement.querySelectorAll("[data-dz-remove]");!(R>=L.length);)L[R++].addEventListener("click",M)}},removedfile:function(l){return l.previewElement!=null&&l.previewElement.parentNode!=null&&l.previewElement.parentNode.removeChild(l.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(l,u){if(l.previewElement){l.previewElement.classList.remove("dz-file-preview");for(var m=0,p=p=l.previewElement.querySelectorAll("[data-dz-thumbnail]");!(m>=p.length);){var v=p[m++];v.alt=l.name,v.src=u}return setTimeout(function(){return l.previewElement.classList.add("dz-image-preview")},1)}},error:function(l,u){if(l.previewElement){l.previewElement.classList.add("dz-error"),typeof u!="String"&&u.error&&(u=u.error);for(var m=0,p=p=l.previewElement.querySelectorAll("[data-dz-errormessage]");!(m>=p.length);)p[m++].textContent=u}},errormultiple:function(){},processing:function(l){if(l.previewElement&&(l.previewElement.classList.add("dz-processing"),l._removeLink))return l._removeLink.innerHTML=this.options.dictCancelUpload},processingmultiple:function(){},uploadprogress:function(l,u,m){if(l.previewElement)for(var p=0,v=v=l.previewElement.querySelectorAll("[data-dz-uploadprogress]");!(p>=v.length);){var y=v[p++];y.nodeName==="PROGRESS"?y.value=u:y.style.width=u+"%"}},totaluploadprogress:function(){},sending:function(){},sendingmultiple:function(){},success:function(l){if(l.previewElement)return l.previewElement.classList.add("dz-success")},successmultiple:function(){},canceled:function(l){return this.emit("error",l,this.options.dictUploadCanceled)},canceledmultiple:function(){},complete:function(l){if(l._removeLink&&(l._removeLink.innerHTML=this.options.dictRemoveFile),l.previewElement)return l.previewElement.classList.add("dz-complete")},completemultiple:function(){},maxfilesexceeded:function(){},maxfilesreached:function(){},queuecomplete:function(){},addedfiles:function(){}},this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}},{key:"extend",value:function(l){for(var u=arguments.length,m=Array(u>1?u-1:0),p=1;p<u;p++)m[p-1]=arguments[p];for(var v=0,y=y=m;!(v>=y.length);){var x=y[v++];for(var M in x){var R=x[M];l[M]=R}}return l}}]),a(_,[{key:"getAcceptedFiles",value:function(){return this.files.filter(function(l){return l.accepted}).map(function(l){return l})}},{key:"getRejectedFiles",value:function(){return this.files.filter(function(l){return!l.accepted}).map(function(l){return l})}},{key:"getFilesWithStatus",value:function(l){return this.files.filter(function(u){return u.status===l}).map(function(u){return u})}},{key:"getQueuedFiles",value:function(){return this.getFilesWithStatus(_.QUEUED)}},{key:"getUploadingFiles",value:function(){return this.getFilesWithStatus(_.UPLOADING)}},{key:"getAddedFiles",value:function(){return this.getFilesWithStatus(_.ADDED)}},{key:"getActiveFiles",value:function(){return this.files.filter(function(l){return l.status===_.UPLOADING||l.status===_.QUEUED}).map(function(l){return l})}},{key:"init",value:function(){var l=this;this.element.tagName==="form"&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(_.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&function y(){return l.hiddenFileInput&&l.hiddenFileInput.parentNode.removeChild(l.hiddenFileInput),l.hiddenFileInput=document.createElement("input"),l.hiddenFileInput.setAttribute("type","file"),(l.options.maxFiles===null||l.options.maxFiles>1)&&l.hiddenFileInput.setAttribute("multiple","multiple"),l.hiddenFileInput.className="dz-hidden-input",l.options.acceptedFiles!==null&&l.hiddenFileInput.setAttribute("accept",l.options.acceptedFiles),l.options.capture!==null&&l.hiddenFileInput.setAttribute("capture",l.options.capture),l.hiddenFileInput.style.visibility="hidden",l.hiddenFileInput.style.position="absolute",l.hiddenFileInput.style.top="0",l.hiddenFileInput.style.left="0",l.hiddenFileInput.style.height="0",l.hiddenFileInput.style.width="0",_.getElement(l.options.hiddenInputContainer,"hiddenInputContainer").appendChild(l.hiddenFileInput),l.hiddenFileInput.addEventListener("change",function(){var x=l.hiddenFileInput.files;if(x.length)for(var M=0,R=R=x;!(M>=R.length);){var L=R[M++];l.addFile(L)}return l.emit("addedfiles",x),y()})}(),this.URL=window.URL!==null?window.URL:window.webkitURL;for(var u=0,m=m=this.events;!(u>=m.length);){var p=m[u++];this.on(p,this.options[p])}this.on("uploadprogress",function(){return l.updateTotalUploadProgress()}),this.on("removedfile",function(){return l.updateTotalUploadProgress()}),this.on("canceled",function(y){return l.emit("complete",y)}),this.on("complete",function(y){if(l.getAddedFiles().length===0&&l.getUploadingFiles().length===0&&l.getQueuedFiles().length===0)return setTimeout(function(){return l.emit("queuecomplete")},0)});var v=function(y){return y.stopPropagation(),y.preventDefault?y.preventDefault():y.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:function(y){return l.emit("dragstart",y)},dragenter:function(y){return v(y),l.emit("dragenter",y)},dragover:function(y){var x=void 0;try{x=y.dataTransfer.effectAllowed}catch(M){}return y.dataTransfer.dropEffect=x==="move"||x==="linkMove"?"move":"copy",v(y),l.emit("dragover",y)},dragleave:function(y){return l.emit("dragleave",y)},drop:function(y){return v(y),l.drop(y)},dragend:function(y){return l.emit("dragend",y)}}}],this.clickableElements.forEach(function(y){return l.listeners.push({element:y,events:{click:function(x){return(y!==l.element||x.target===l.element||_.elementInside(x.target,l.element.querySelector(".dz-message")))&&l.hiddenFileInput.click(),!0}}})}),this.enable(),this.options.init.call(this)}},{key:"destroy",value:function(){return this.disable(),this.removeAllFiles(!0),this.hiddenFileInput!=null&&this.hiddenFileInput.parentNode&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,_.instances.splice(_.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function(){var l=void 0,u=0,m=0;if(this.getActiveFiles().length){for(var p=0,v=v=this.getActiveFiles();!(p>=v.length);){var y=v[p++];u+=y.upload.bytesSent,m+=y.upload.total}l=100*u/m}else l=100;return this.emit("totaluploadprogress",l,m,u)}},{key:"_getParamName",value:function(l){return typeof this.options.paramName=="function"?this.options.paramName(l):this.options.paramName+(this.options.uploadMultiple?"["+l+"]":"")}},{key:"_renameFile",value:function(l){return typeof this.options.renameFile!="function"?l.name:this.options.renameFile(l)}},{key:"getFallbackForm",value:function(){var l,u=void 0;if(l=this.getExistingFallback())return l;var m='<div class="dz-fallback">';this.options.dictFallbackText&&(m+="<p>"+this.options.dictFallbackText+"</p>"),m+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>';var p=_.createElement(m);return this.element.tagName!=="FORM"?(u=_.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>')).appendChild(p):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),u!=null?u:p}},{key:"getExistingFallback",value:function(){for(var l=function(y){for(var x=0,M=M=y;!(x>=M.length);){var R=M[x++];if(/(^| )fallback($| )/.test(R.className))return R}},u=["div","form"],m=0;m<u.length;m++){var p,v=u[m];if(p=l(this.element.getElementsByTagName(v)))return p}}},{key:"setupEventListeners",value:function(){return this.listeners.map(function(l){return function(){var u=[];for(var m in l.events){var p=l.events[m];u.push(l.element.addEventListener(m,p,!1))}return u}()})}},{key:"removeEventListeners",value:function(){return this.listeners.map(function(l){return function(){var u=[];for(var m in l.events){var p=l.events[m];u.push(l.element.removeEventListener(m,p,!1))}return u}()})}},{key:"disable",value:function(){var l=this;return this.clickableElements.forEach(function(u){return u.classList.remove("dz-clickable")}),this.removeEventListeners(),this.disabled=!0,this.files.map(function(u){return l.cancelUpload(u)})}},{key:"enable",value:function(){return delete this.disabled,this.clickableElements.forEach(function(l){return l.classList.add("dz-clickable")}),this.setupEventListeners()}},{key:"filesize",value:function(l){var u=0,m="b";if(l>0){for(var p=["tb","gb","mb","kb","b"],v=0;v<p.length;v++){var y=p[v];if(l>=Math.pow(this.options.filesizeBase,4-v)/10){u=l/Math.pow(this.options.filesizeBase,4-v),m=y;break}}u=Math.round(10*u)/10}return"<strong>"+u+"</strong> "+this.options.dictFileSizeUnits[m]}},{key:"_updateMaxFilesReachedClass",value:function(){return this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}},{key:"drop",value:function(l){if(l.dataTransfer){this.emit("drop",l);for(var u=[],m=0;m<l.dataTransfer.files.length;m++)u[m]=l.dataTransfer.files[m];if(this.emit("addedfiles",u),u.length){var p=l.dataTransfer.items;p&&p.length&&p[0].webkitGetAsEntry!=null?this._addFilesFromItems(p):this.handleFiles(u)}}}},{key:"paste",value:function(l){if(u=l!=null?l.clipboardData:void 0,m=function(v){return v.items},(u!=null?m(u):void 0)!=null){var u,m;this.emit("paste",l);var p=l.clipboardData.items;return p.length?this._addFilesFromItems(p):void 0}}},{key:"handleFiles",value:function(l){for(var u=0,m=m=l;!(u>=m.length);){var p=m[u++];this.addFile(p)}}},{key:"_addFilesFromItems",value:function(l){var u=this;return function(){for(var m=[],p=0,v=v=l;!(p>=v.length);){var y,x=v[p++];x.webkitGetAsEntry!=null&&(y=x.webkitGetAsEntry())?y.isFile?m.push(u.addFile(x.getAsFile())):y.isDirectory?m.push(u._addFilesFromDirectory(y,y.name)):m.push(void 0):x.getAsFile!=null&&(x.kind==null||x.kind==="file")?m.push(u.addFile(x.getAsFile())):m.push(void 0)}return m}()}},{key:"_addFilesFromDirectory",value:function(l,u){var m=this,p=l.createReader(),v=function(y){return x=console,M="log",R=function(L){return L.log(y)},x!=null&&typeof x[M]=="function"?R(x,M):void 0;var x,M,R};return function y(){return p.readEntries(function(x){if(x.length>0){for(var M=0,R=R=x;!(M>=R.length);){var L=R[M++];L.isFile?L.file(function(D){if(!m.options.ignoreHiddenFiles||D.name.substring(0,1)!==".")return D.fullPath=u+"/"+D.name,m.addFile(D)}):L.isDirectory&&m._addFilesFromDirectory(L,u+"/"+L.name)}y()}return null},v)}()}},{key:"accept",value:function(l,u){return this.options.maxFilesize&&l.size>1024*this.options.maxFilesize*1024?u(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(l.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):_.isValidFile(l,this.options.acceptedFiles)?this.options.maxFiles!=null&&this.getAcceptedFiles().length>=this.options.maxFiles?(u(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",l)):this.options.accept.call(this,l,u):u(this.options.dictInvalidFileType)}},{key:"addFile",value:function(l){var u=this;return l.upload={uuid:_.uuidv4(),progress:0,total:l.size,bytesSent:0,filename:this._renameFile(l),chunked:this.options.chunking&&(this.options.forceChunking||l.size>this.options.chunkSize),totalChunkCount:Math.ceil(l.size/this.options.chunkSize)},this.files.push(l),l.status=_.ADDED,this.emit("addedfile",l),this._enqueueThumbnail(l),this.accept(l,function(m){return m?(l.accepted=!1,u._errorProcessing([l],m)):(l.accepted=!0,u.options.autoQueue&&u.enqueueFile(l)),u._updateMaxFilesReachedClass()})}},{key:"enqueueFiles",value:function(l){for(var u=0,m=m=l;!(u>=m.length);){var p=m[u++];this.enqueueFile(p)}return null}},{key:"enqueueFile",value:function(l){var u=this;if(l.status!==_.ADDED||l.accepted!==!0)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(l.status=_.QUEUED,this.options.autoProcessQueue)return setTimeout(function(){return u.processQueue()},0)}},{key:"_enqueueThumbnail",value:function(l){var u=this;if(this.options.createImageThumbnails&&l.type.match(/image.*/)&&l.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(l),setTimeout(function(){return u._processThumbnailQueue()},0)}},{key:"_processThumbnailQueue",value:function(){var l=this;if(!this._processingThumbnail&&this._thumbnailQueue.length!==0){this._processingThumbnail=!0;var u=this._thumbnailQueue.shift();return this.createThumbnail(u,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,function(m){return l.emit("thumbnail",u,m),l._processingThumbnail=!1,l._processThumbnailQueue()})}}},{key:"removeFile",value:function(l){if(l.status===_.UPLOADING&&this.cancelUpload(l),this.files=E(this.files,l),this.emit("removedfile",l),this.files.length===0)return this.emit("reset")}},{key:"removeAllFiles",value:function(l){l==null&&(l=!1);for(var u=0,m=m=this.files.slice();!(u>=m.length);){var p=m[u++];(p.status!==_.UPLOADING||l)&&this.removeFile(p)}return null}},{key:"resizeImage",value:function(l,u,m,p,v){var y=this;return this.createThumbnail(l,u,m,p,!0,function(x,M){if(M==null)return v(l);var R=y.options.resizeMimeType;R==null&&(R=l.type);var L=M.toDataURL(R,y.options.resizeQuality);return R!=="image/jpeg"&&R!=="image/jpg"||(L=$.restore(l.dataURL,L)),v(_.dataURItoBlob(L))})}},{key:"createThumbnail",value:function(l,u,m,p,v,y){var x=this,M=new FileReader;return M.onload=function(){if(l.dataURL=M.result,l.type!=="image/svg+xml")return x.createThumbnailFromUrl(l,u,m,p,v,y);y!=null&&y(M.result)},M.readAsDataURL(l)}},{key:"createThumbnailFromUrl",value:function(l,u,m,p,v,y,x){var M=this,R=document.createElement("img");return x&&(R.crossOrigin=x),R.onload=function(){var L=function(D){return D(1)};return typeof EXIF!="undefined"&&EXIF!==null&&v&&(L=function(D){return EXIF.getData(R,function(){return D(EXIF.getTag(this,"Orientation"))})}),L(function(D){l.width=R.width,l.height=R.height;var C=M.options.resize.call(M,l,u,m,p),w=document.createElement("canvas"),O=w.getContext("2d");switch(w.width=C.trgWidth,w.height=C.trgHeight,D>4&&(w.width=C.trgHeight,w.height=C.trgWidth),D){case 2:O.translate(w.width,0),O.scale(-1,1);break;case 3:O.translate(w.width,w.height),O.rotate(Math.PI);break;case 4:O.translate(0,w.height),O.scale(1,-1);break;case 5:O.rotate(.5*Math.PI),O.scale(1,-1);break;case 6:O.rotate(.5*Math.PI),O.translate(0,-w.width);break;case 7:O.rotate(.5*Math.PI),O.translate(w.height,-w.width),O.scale(-1,1);break;case 8:O.rotate(-.5*Math.PI),O.translate(-w.height,0)}N(O,R,C.srcX!=null?C.srcX:0,C.srcY!=null?C.srcY:0,C.srcWidth,C.srcHeight,C.trgX!=null?C.trgX:0,C.trgY!=null?C.trgY:0,C.trgWidth,C.trgHeight);var F=w.toDataURL("image/png");if(y!=null)return y(F,w)})},y!=null&&(R.onerror=y),R.src=l.dataURL}},{key:"processQueue",value:function(){var l=this.options.parallelUploads,u=this.getUploadingFiles().length,m=u;if(!(u>=l)){var p=this.getQueuedFiles();if(p.length>0){if(this.options.uploadMultiple)return this.processFiles(p.slice(0,l-u));for(;m<l;){if(!p.length)return;this.processFile(p.shift()),m++}}}}},{key:"processFile",value:function(l){return this.processFiles([l])}},{key:"processFiles",value:function(l){for(var u=0,m=m=l;!(u>=m.length);){var p=m[u++];p.processing=!0,p.status=_.UPLOADING,this.emit("processing",p)}return this.options.uploadMultiple&&this.emit("processingmultiple",l),this.uploadFiles(l)}},{key:"_getFilesWithXhr",value:function(l){return this.files.filter(function(u){return u.xhr===l}).map(function(u){return u})}},{key:"cancelUpload",value:function(l){if(l.status===_.UPLOADING){for(var u=this._getFilesWithXhr(l.xhr),m=0,p=p=u;!(m>=p.length);)p[m++].status=_.CANCELED;l.xhr!==void 0&&l.xhr.abort();for(var v=0,y=y=u;!(v>=y.length);){var x=y[v++];this.emit("canceled",x)}this.options.uploadMultiple&&this.emit("canceledmultiple",u)}else l.status!==_.ADDED&&l.status!==_.QUEUED||(l.status=_.CANCELED,this.emit("canceled",l),this.options.uploadMultiple&&this.emit("canceledmultiple",[l]));if(this.options.autoProcessQueue)return this.processQueue()}},{key:"resolveOption",value:function(l){if(typeof l=="function"){for(var u=arguments.length,m=Array(u>1?u-1:0),p=1;p<u;p++)m[p-1]=arguments[p];return l.apply(this,m)}return l}},{key:"uploadFile",value:function(l){return this.uploadFiles([l])}},{key:"uploadFiles",value:function(l){var u=this;this._transformFiles(l,function(m){if(l[0].upload.chunked){var p=l[0],v=m[0];p.upload.chunks=[];var y=function(){for(var L=0;p.upload.chunks[L]!==void 0;)L++;if(!(L>=p.upload.totalChunkCount)){var D=L*u.options.chunkSize,C=Math.min(D+u.options.chunkSize,p.size),w={name:u._getParamName(0),data:v.webkitSlice?v.webkitSlice(D,C):v.slice(D,C),filename:p.upload.filename,chunkIndex:L};p.upload.chunks[L]={file:p,index:L,dataBlock:w,status:_.UPLOADING,progress:0,retries:0},u._uploadData(l,[w])}};if(p.upload.finishedChunkUpload=function(L){var D=!0;L.status=_.SUCCESS,L.dataBlock=null,L.xhr=null;for(var C=0;C<p.upload.totalChunkCount;C++){if(p.upload.chunks[C]===void 0)return y();p.upload.chunks[C].status!==_.SUCCESS&&(D=!1)}D&&u.options.chunksUploaded(p,function(){u._finished(l,"",null)})},u.options.parallelChunkUploads)for(var x=0;x<p.upload.totalChunkCount;x++)y();else y()}else{for(var M=[],R=0;R<l.length;R++)M[R]={name:u._getParamName(R),data:m[R],filename:l[R].upload.filename};u._uploadData(l,M)}})}},{key:"_getChunk",value:function(l,u){for(var m=0;m<l.upload.totalChunkCount;m++)if(l.upload.chunks[m]!==void 0&&l.upload.chunks[m].xhr===u)return l.upload.chunks[m]}},{key:"_uploadData",value:function(l,u){for(var m=this,p=new XMLHttpRequest,v=0,y=y=l;!(v>=y.length);)y[v++].xhr=p;l[0].upload.chunked&&(l[0].upload.chunks[u[0].chunkIndex].xhr=p);var x=this.resolveOption(this.options.method,l),M=this.resolveOption(this.options.url,l);p.open(x,M,!0),p.timeout=this.resolveOption(this.options.timeout,l),p.withCredentials=!!this.options.withCredentials,p.onload=function(T){m._finishedUploading(l,p,T)},p.onerror=function(){m._handleUploadError(l,p)},(p.upload!=null?p.upload:p).onprogress=function(T){return m._updateFilesUploadProgress(l,p,T)};var R={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};for(var L in this.options.headers&&_.extend(R,this.options.headers),R){var D=R[L];D&&p.setRequestHeader(L,D)}var C=new FormData;if(this.options.params){var w=this.options.params;for(var O in typeof w=="function"&&(w=w.call(this,l,p,l[0].upload.chunked?this._getChunk(l[0],p):null)),w){var F=w[O];C.append(O,F)}}for(var q=0,B=B=l;!(q>=B.length);){var z=B[q++];this.emit("sending",z,p,C)}this.options.uploadMultiple&&this.emit("sendingmultiple",l,p,C),this._addFormElementData(C);for(var W=0;W<u.length;W++){var S=u[W];C.append(S.name,S.data,S.filename)}this.submitRequest(p,C,l)}},{key:"_transformFiles",value:function(l,u){for(var m=this,p=[],v=0,y=function(M){m.options.transformFile.call(m,l[M],function(R){p[M]=R,++v===l.length&&u(p)})},x=0;x<l.length;x++)y(x)}},{key:"_addFormElementData",value:function(l){if(this.element.tagName==="FORM")for(var u=0,m=m=this.element.querySelectorAll("input, textarea, select, button");!(u>=m.length);){var p=m[u++],v=p.getAttribute("name"),y=p.getAttribute("type");if(y&&(y=y.toLowerCase()),v!=null)if(p.tagName==="SELECT"&&p.hasAttribute("multiple"))for(var x=0,M=M=p.options;!(x>=M.length);){var R=M[x++];R.selected&&l.append(v,R.value)}else(!y||y!=="checkbox"&&y!=="radio"||p.checked)&&l.append(v,p.value)}}},{key:"_updateFilesUploadProgress",value:function(l,u,m){var p=void 0;if(m!==void 0){if(p=100*m.loaded/m.total,l[0].upload.chunked){var v=l[0],y=this._getChunk(v,u);y.progress=p,y.total=m.total,y.bytesSent=m.loaded,v.upload.progress=0,v.upload.total=0,v.upload.bytesSent=0;for(var x=0;x<v.upload.totalChunkCount;x++)v.upload.chunks[x]!==void 0&&v.upload.chunks[x].progress!==void 0&&(v.upload.progress+=v.upload.chunks[x].progress,v.upload.total+=v.upload.chunks[x].total,v.upload.bytesSent+=v.upload.chunks[x].bytesSent);v.upload.progress=v.upload.progress/v.upload.totalChunkCount}else for(var M=0,R=R=l;!(M>=R.length);){var L=R[M++];L.upload.progress=p,L.upload.total=m.total,L.upload.bytesSent=m.loaded}for(var D=0,C=C=l;!(D>=C.length);){var w=C[D++];this.emit("uploadprogress",w,w.upload.progress,w.upload.bytesSent)}}else{var O=!0;p=100;for(var F=0,q=q=l;!(F>=q.length);){var B=q[F++];B.upload.progress===100&&B.upload.bytesSent===B.upload.total||(O=!1),B.upload.progress=p,B.upload.bytesSent=B.upload.total}if(O)return;for(var z=0,W=W=l;!(z>=W.length);){var S=W[z++];this.emit("uploadprogress",S,p,S.upload.bytesSent)}}}},{key:"_finishedUploading",value:function(l,u,m){var p=void 0;if(l[0].status!==_.CANCELED&&u.readyState===4){if(u.responseType!=="arraybuffer"&&u.responseType!=="blob"&&(p=u.responseText,u.getResponseHeader("content-type")&&~u.getResponseHeader("content-type").indexOf("application/json")))try{p=JSON.parse(p)}catch(v){m=v,p="Invalid JSON response from server."}this._updateFilesUploadProgress(l),200<=u.status&&u.status<300?l[0].upload.chunked?l[0].upload.finishedChunkUpload(this._getChunk(l[0],u)):this._finished(l,p,m):this._handleUploadError(l,u,p)}}},{key:"_handleUploadError",value:function(l,u,m){if(l[0].status!==_.CANCELED){if(l[0].upload.chunked&&this.options.retryChunks){var p=this._getChunk(l[0],u);if(p.retries++<this.options.retryChunksLimit)return void this._uploadData(l,[p.dataBlock]);console.warn("Retried this chunk too often. Giving up.")}for(var v=0,y=y=l;!(v>=y.length);)y[v++],this._errorProcessing(l,m||this.options.dictResponseError.replace("{{statusCode}}",u.status),u)}}},{key:"submitRequest",value:function(l,u,m){l.send(u)}},{key:"_finished",value:function(l,u,m){for(var p=0,v=v=l;!(p>=v.length);){var y=v[p++];y.status=_.SUCCESS,this.emit("success",y,u,m),this.emit("complete",y)}if(this.options.uploadMultiple&&(this.emit("successmultiple",l,u,m),this.emit("completemultiple",l)),this.options.autoProcessQueue)return this.processQueue()}},{key:"_errorProcessing",value:function(l,u,m){for(var p=0,v=v=l;!(p>=v.length);){var y=v[p++];y.status=_.ERROR,this.emit("error",y,u,m),this.emit("complete",y)}if(this.options.uploadMultiple&&(this.emit("errormultiple",l,u,m),this.emit("completemultiple",l)),this.options.autoProcessQueue)return this.processQueue()}}],[{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var u=16*Math.random()|0;return(l==="x"?u:3&u|8).toString(16)})}}]),_}();g.initClass(),g.version="5.5.1",g.options={},g.optionsForElement=function(b){return b.getAttribute("id")?g.options[A(b.getAttribute("id"))]:void 0},g.instances=[],g.forElement=function(b){if(typeof b=="string"&&(b=document.querySelector(b)),(b!=null?b.dropzone:void 0)==null)throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return b.dropzone},g.autoDiscover=!0,g.discover=function(){var b=void 0;if(document.querySelectorAll)b=document.querySelectorAll(".dropzone");else{b=[];var _=function(l){return function(){for(var u=[],m=0,p=p=l;!(m>=p.length);){var v=p[m++];/(^| )dropzone($| )/.test(v.className)?u.push(b.push(v)):u.push(void 0)}return u}()};_(document.getElementsByTagName("div")),_(document.getElementsByTagName("form"))}return function(){for(var l=[],u=0,m=m=b;!(u>=m.length);){var p=m[u++];g.optionsForElement(p)!==!1?l.push(new g(p)):l.push(void 0)}return l}()},g.blacklistedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i],g.isBrowserSupported=function(){var b=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(var _=0,l=l=g.blacklistedBrowsers;!(_>=l.length);)l[_++].test(navigator.userAgent)&&(b=!1);else b=!1;else b=!1;return b},g.dataURItoBlob=function(b){for(var _=atob(b.split(",")[1]),l=b.split(",")[0].split(":")[1].split(";")[0],u=new ArrayBuffer(_.length),m=new Uint8Array(u),p=0,v=_.length,y=0<=v;y?p<=v:p>=v;y?p++:p--)m[p]=_.charCodeAt(p);return new Blob([u],{type:l})};var E=function(b,_){return b.filter(function(l){return l!==_}).map(function(l){return l})},A=function(b){return b.replace(/[\-_](\w)/g,function(_){return _.charAt(1).toUpperCase()})};g.createElement=function(b){var _=document.createElement("div");return _.innerHTML=b,_.childNodes[0]},g.elementInside=function(b,_){if(b===_)return!0;for(;b=b.parentNode;)if(b===_)return!0;return!1},g.getElement=function(b,_){var l=void 0;if(typeof b=="string"?l=document.querySelector(b):b.nodeType!=null&&(l=b),l==null)throw new Error("Invalid `"+_+"` option provided. Please provide a CSS selector or a plain HTML element.");return l},g.getElements=function(b,_){var l=void 0,u=void 0;if(b instanceof Array){u=[];try{for(var m=0,p=p=b;!(m>=p.length);)l=p[m++],u.push(this.getElement(l,_))}catch(x){u=null}}else if(typeof b=="string"){u=[];for(var v=0,y=y=document.querySelectorAll(b);!(v>=y.length);)l=y[v++],u.push(l)}else b.nodeType!=null&&(u=[b]);if(u==null||!u.length)throw new Error("Invalid `"+_+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return u},g.confirm=function(b,_,l){return window.confirm(b)?_():l!=null?l():void 0},g.isValidFile=function(b,_){if(!_)return!0;_=_.split(",");for(var l=b.type,u=l.replace(/\/.*$/,""),m=0,p=p=_;!(m>=p.length);){var v=p[m++];if((v=v.trim()).charAt(0)==="."){if(b.name.toLowerCase().indexOf(v.toLowerCase(),b.name.length-v.length)!==-1)return!0}else if(/\/\*$/.test(v)){if(u===v.replace(/\/.*$/,""))return!0}else if(l===v)return!0}return!1},typeof jQuery!="undefined"&&jQuery!==null&&(jQuery.fn.dropzone=function(b){return this.each(function(){return new g(this,b)})}),r!==null?r.exports=g:window.Dropzone=g,g.ADDED="added",g.QUEUED="queued",g.ACCEPTED=g.QUEUED,g.UPLOADING="uploading",g.PROCESSING=g.UPLOADING,g.CANCELED="canceled",g.ERROR="error",g.SUCCESS="success";var N=function(b,_,l,u,m,p,v,y,x,M){var R=function(L){L.naturalWidth;var D=L.naturalHeight,C=document.createElement("canvas");C.width=1,C.height=D;var w=C.getContext("2d");w.drawImage(L,0,0);for(var O=w.getImageData(1,0,1,D).data,F=0,q=D,B=D;B>F;)O[4*(B-1)+3]===0?q=B:F=B,B=q+F>>1;var z=B/D;return z===0?1:z}(_);return b.drawImage(_,l,u,m,p,v,y,x,M/R)},$=function(){function b(){c(this,b)}return a(b,null,[{key:"initClass",value:function(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function(_){for(var l="",u=void 0,m=void 0,p="",v=void 0,y=void 0,x=void 0,M="",R=0;v=(u=_[R++])>>2,y=(3&u)<<4|(m=_[R++])>>4,x=(15&m)<<2|(p=_[R++])>>6,M=63&p,isNaN(m)?x=M=64:isNaN(p)&&(M=64),l=l+this.KEY_STR.charAt(v)+this.KEY_STR.charAt(y)+this.KEY_STR.charAt(x)+this.KEY_STR.charAt(M),u=m=p="",v=y=x=M="",R<_.length;);return l}},{key:"restore",value:function(_,l){if(!_.match("data:image/jpeg;base64,"))return l;var u=this.decode64(_.replace("data:image/jpeg;base64,","")),m=this.slice2Segments(u),p=this.exifManipulation(l,m);return"data:image/jpeg;base64,"+this.encode64(p)}},{key:"exifManipulation",value:function(_,l){var u=this.getExifArray(l),m=this.insertExif(_,u);return new Uint8Array(m)}},{key:"getExifArray",value:function(_){for(var l=void 0,u=0;u<_.length;){if((l=_[u])[0]===255&l[1]===225)return l;u++}return[]}},{key:"insertExif",value:function(_,l){var u=_.replace("data:image/jpeg;base64,",""),m=this.decode64(u),p=m.indexOf(255,3),v=m.slice(0,p),y=m.slice(p),x=v;return x=(x=x.concat(l)).concat(y)}},{key:"slice2Segments",value:function(_){for(var l=0,u=[];!(_[l]===255&_[l+1]===218);){if(_[l]===255&_[l+1]===216)l+=2;else{var m=l+(256*_[l+2]+_[l+3])+2,p=_.slice(l,m);u.push(p),l=m}if(l>_.length)break}return u}},{key:"decode64",value:function(_){var l=void 0,u=void 0,m="",p=void 0,v=void 0,y="",x=0,M=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(_)&&console.warn(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`),_=_.replace(/[^A-Za-z0-9\+\/\=]/g,"");l=this.KEY_STR.indexOf(_.charAt(x++))<<2|(p=this.KEY_STR.indexOf(_.charAt(x++)))>>4,u=(15&p)<<4|(v=this.KEY_STR.indexOf(_.charAt(x++)))>>2,m=(3&v)<<6|(y=this.KEY_STR.indexOf(_.charAt(x++))),M.push(l),v!==64&&M.push(u),y!==64&&M.push(m),l=u=m="",p=v=y="",x<_.length;);return M}}]),b}();$.initClass(),g._autoDiscoverFunction=function(){if(g.autoDiscover)return g.discover()},function(b,_){var l=!1,u=!0,m=b.document,p=m.documentElement,v=m.addEventListener?"addEventListener":"attachEvent",y=m.addEventListener?"removeEventListener":"detachEvent",x=m.addEventListener?"":"on",M=function R(L){if(L.type!=="readystatechange"||m.readyState==="complete")return(L.type==="load"?b:m)[y](x+L.type,R,!1),!l&&(l=!0)?_.call(b,L.type||L):void 0};if(m.readyState!=="complete"){if(m.createEventObject&&p.doScroll){try{u=!b.frameElement}catch(R){}u&&function R(){try{p.doScroll("left")}catch(L){return void setTimeout(R,50)}return M("poll")}()}m[v](x+"DOMContentLoaded",M,!1),m[v](x+"readystatechange",M,!1),b[v](x+"load",M,!1)}}(window,g._autoDiscoverFunction)}(n={exports:{}},n.exports),n.exports),s={getSignedURL(r,a){let o={filePath:r.name,contentType:r.type};return new Promise((c,f)=>{var g=new FormData;let E=new XMLHttpRequest,A=typeof a.signingURL=="function"?a.signingURL(r):a.signingURL;E.open("POST",A),E.onload=function(){E.status==200?c(JSON.parse(E.response)):f(E.statusText)},E.onerror=function(N){console.error("Network Error : Could not send request to AWS (Maybe CORS errors)"),f(N)},a.withCredentials===!0&&(E.withCredentials=!0),Object.entries(a.headers||{}).forEach(([N,$])=>{E.setRequestHeader(N,$)}),o=Object.assign(o,a.params||{}),Object.entries(o).forEach(([N,$])=>{g.append(N,$)}),E.send(g)})},sendFile(r,a,o){var c=o?this.setResponseHandler:this.sendS3Handler;return this.getSignedURL(r,a).then(f=>c(f,r)).catch(f=>f)},setResponseHandler(r,a){a.s3Signature=r.signature,a.s3Url=r.postEndpoint},sendS3Handler(r,a){let o=new FormData,c=r.signature;return Object.keys(c).forEach(function(f){o.append(f,c[f])}),o.append("file",a),new Promise((f,g)=>{let E=new XMLHttpRequest;E.open("POST",r.postEndpoint),E.onload=function(){if(E.status==201){var A=new window.DOMParser().parseFromString(E.response,"text/xml").firstChild.children[0].innerHTML;f({success:!0,message:A})}else{var N=new window.DOMParser().parseFromString(E.response,"text/xml").firstChild.children[0].innerHTML;g({success:!1,message:N+". Request is marked as resolved when returns as status 201"})}},E.onerror=function(A){var N=new window.DOMParser().parseFromString(E.response,"text/xml").firstChild.children[1].innerHTML;g({success:!1,message:N})},E.send(o)})}};return i.autoDiscover=!1,function(r,a,o,c,f,g,E,A,N,$){typeof E!="boolean"&&(N=A,A=E,E=!1);var b,_=typeof o=="function"?o.options:o;if(r&&r.render&&(_.render=r.render,_.staticRenderFns=r.staticRenderFns,_._compiled=!0,f&&(_.functional=!0)),c&&(_._scopeId=c),g?(b=function(m){(m=m||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||typeof __VUE_SSR_CONTEXT__=="undefined"||(m=__VUE_SSR_CONTEXT__),a&&a.call(this,N(m)),m&&m._registeredComponents&&m._registeredComponents.add(g)},_._ssrRegister=b):a&&(b=E?function(){a.call(this,$(this.$root.$options.shadowRoot))}:function(m){a.call(this,A(m))}),b)if(_.functional){var l=_.render;_.render=function(m,p){return b.call(p),l(m,p)}}else{var u=_.beforeCreate;_.beforeCreate=u?[].concat(u,b):[b]}return o}({render:function(){var r=this.$createElement,a=this._self._c||r;return a("div",{ref:"dropzoneElement",class:{"vue-dropzone dropzone":this.includeStyling},attrs:{id:this.id}},[this.useCustomSlot?a("div",{staticClass:"dz-message"},[this._t("default",[this._v("Drop files here to upload")])],2):this._e()])},staticRenderFns:[]},void 0,{props:{id:{type:String,required:!0,default:"dropzone"},options:{type:Object,required:!0},includeStyling:{type:Boolean,default:!0,required:!1},awss3:{type:Object,required:!1,default:null},destroyDropzone:{type:Boolean,default:!0,required:!1},duplicateCheck:{type:Boolean,default:!1,required:!1},useCustomSlot:{type:Boolean,default:!1,required:!1}},data:()=>({isS3:!1,isS3OverridesServerPropagation:!1,wasQueueAutoProcess:!0}),computed:{dropzoneSettings(){let r={thumbnailWidth:200,thumbnailHeight:200};return Object.keys(this.options).forEach(function(a){r[a]=this.options[a]},this),this.awss3!==null&&(r.autoProcessQueue=!1,this.isS3=!0,this.isS3OverridesServerPropagation=this.awss3.sendFileToServer===!1,this.options.autoProcessQueue!==void 0&&(this.wasQueueAutoProcess=this.options.autoProcessQueue),this.isS3OverridesServerPropagation&&(r.url=a=>a[0].s3Url)),r}},mounted(){if(this.$isServer&&this.hasBeenMounted)return;this.hasBeenMounted=!0,this.dropzone=new i(this.$refs.dropzoneElement,this.dropzoneSettings);let r=this;this.dropzone.on("thumbnail",function(a,o){r.$emit("vdropzone-thumbnail",a,o)}),this.dropzone.on("addedfile",function(a){var o,c;if(r.duplicateCheck&&this.files.length)for(o=0,c=this.files.length;o<c-1;o++)this.files[o].name===a.name&&this.files[o].size===a.size&&this.files[o].lastModifiedDate.toString()===a.lastModifiedDate.toString()&&(this.removeFile(a),r.$emit("vdropzone-duplicate-file",a));r.$emit("vdropzone-file-added",a),r.isS3&&r.wasQueueAutoProcess&&!a.manuallyAdded&&r.getSignedAndUploadToS3(a)}),this.dropzone.on("addedfiles",function(a){r.$emit("vdropzone-files-added",a)}),this.dropzone.on("removedfile",function(a){r.$emit("vdropzone-removed-file",a),a.manuallyAdded&&r.dropzone.options.maxFiles!==null&&r.dropzone.options.maxFiles++}),this.dropzone.on("success",function(a,o){if(r.$emit("vdropzone-success",a,o),r.isS3){if(r.isS3OverridesServerPropagation){var c=new window.DOMParser().parseFromString(o,"text/xml").firstChild.children[0].innerHTML;r.$emit("vdropzone-s3-upload-success",c)}r.wasQueueAutoProcess&&r.setOption("autoProcessQueue",!1)}}),this.dropzone.on("successmultiple",function(a,o){r.$emit("vdropzone-success-multiple",a,o)}),this.dropzone.on("error",function(a,o,c){r.$emit("vdropzone-error",a,o,c),this.isS3&&r.$emit("vdropzone-s3-upload-error")}),this.dropzone.on("errormultiple",function(a,o,c){r.$emit("vdropzone-error-multiple",a,o,c)}),this.dropzone.on("sending",function(a,o,c){if(r.isS3)if(r.isS3OverridesServerPropagation){let f=a.s3Signature;Object.keys(f).forEach(function(g){c.append(g,f[g])})}else c.append("s3ObjectLocation",a.s3ObjectLocation);r.$emit("vdropzone-sending",a,o,c)}),this.dropzone.on("sendingmultiple",function(a,o,c){r.$emit("vdropzone-sending-multiple",a,o,c)}),this.dropzone.on("complete",function(a){r.$emit("vdropzone-complete",a)}),this.dropzone.on("completemultiple",function(a){r.$emit("vdropzone-complete-multiple",a)}),this.dropzone.on("canceled",function(a){r.$emit("vdropzone-canceled",a)}),this.dropzone.on("canceledmultiple",function(a){r.$emit("vdropzone-canceled-multiple",a)}),this.dropzone.on("maxfilesreached",function(a){r.$emit("vdropzone-max-files-reached",a)}),this.dropzone.on("maxfilesexceeded",function(a){r.$emit("vdropzone-max-files-exceeded",a)}),this.dropzone.on("processing",function(a){r.$emit("vdropzone-processing",a)}),this.dropzone.on("processingmultiple",function(a){r.$emit("vdropzone-processing-multiple",a)}),this.dropzone.on("uploadprogress",function(a,o,c){r.$emit("vdropzone-upload-progress",a,o,c)}),this.dropzone.on("totaluploadprogress",function(a,o,c){r.$emit("vdropzone-total-upload-progress",a,o,c)}),this.dropzone.on("reset",function(){r.$emit("vdropzone-reset")}),this.dropzone.on("queuecomplete",function(){r.$emit("vdropzone-queue-complete")}),this.dropzone.on("drop",function(a){r.$emit("vdropzone-drop",a)}),this.dropzone.on("dragstart",function(a){r.$emit("vdropzone-drag-start",a)}),this.dropzone.on("dragend",function(a){r.$emit("vdropzone-drag-end",a)}),this.dropzone.on("dragenter",function(a){r.$emit("vdropzone-drag-enter",a)}),this.dropzone.on("dragover",function(a){r.$emit("vdropzone-drag-over",a)}),this.dropzone.on("dragleave",function(a){r.$emit("vdropzone-drag-leave",a)}),r.$emit("vdropzone-mounted")},beforeDestroy(){this.destroyDropzone&&this.dropzone.destroy()},methods:{manuallyAddFile:function(r,a){r.manuallyAdded=!0,this.dropzone.emit("addedfile",r);let o=!1;if((a.indexOf(".svg")>-1||a.indexOf(".png")>-1||a.indexOf(".jpg")>-1||a.indexOf(".jpeg")>-1||a.indexOf(".gif")>-1||a.indexOf(".webp")>-1)&&(o=!0),this.dropzone.options.createImageThumbnails&&o&&r.size<=1024*this.dropzone.options.maxThumbnailFilesize*1024){a&&this.dropzone.emit("thumbnail",r,a);for(var c=r.previewElement.querySelectorAll("[data-dz-thumbnail]"),f=0;f<c.length;f++)c[f].style.width=this.dropzoneSettings.thumbnailWidth+"px",c[f].style.height=this.dropzoneSettings.thumbnailHeight+"px",c[f].style["object-fit"]="contain"}this.dropzone.emit("complete",r),this.dropzone.options.maxFiles&&this.dropzone.options.maxFiles--,this.dropzone.files.push(r),this.$emit("vdropzone-file-added-manually",r)},setOption:function(r,a){this.dropzone.options[r]=a},removeAllFiles:function(r){this.dropzone.removeAllFiles(r)},processQueue:function(){let r=this.dropzone;this.isS3&&!this.wasQueueAutoProcess?this.getQueuedFiles().forEach(a=>{this.getSignedAndUploadToS3(a)}):this.dropzone.processQueue(),this.dropzone.on("success",function(){r.options.autoProcessQueue=!0}),this.dropzone.on("queuecomplete",function(){r.options.autoProcessQueue=!1})},init:function(){return this.dropzone.init()},destroy:function(){return this.dropzone.destroy()},updateTotalUploadProgress:function(){return this.dropzone.updateTotalUploadProgress()},getFallbackForm:function(){return this.dropzone.getFallbackForm()},getExistingFallback:function(){return this.dropzone.getExistingFallback()},setupEventListeners:function(){return this.dropzone.setupEventListeners()},removeEventListeners:function(){return this.dropzone.removeEventListeners()},disable:function(){return this.dropzone.disable()},enable:function(){return this.dropzone.enable()},filesize:function(r){return this.dropzone.filesize(r)},accept:function(r,a){return this.dropzone.accept(r,a)},addFile:function(r){return this.dropzone.addFile(r)},removeFile:function(r){this.dropzone.removeFile(r)},getAcceptedFiles:function(){return this.dropzone.getAcceptedFiles()},getRejectedFiles:function(){return this.dropzone.getRejectedFiles()},getFilesWithStatus:function(){return this.dropzone.getFilesWithStatus()},getQueuedFiles:function(){return this.dropzone.getQueuedFiles()},getUploadingFiles:function(){return this.dropzone.getUploadingFiles()},getAddedFiles:function(){return this.dropzone.getAddedFiles()},getActiveFiles:function(){return this.dropzone.getActiveFiles()},getSignedAndUploadToS3(r){var a=s.sendFile(r,this.awss3,this.isS3OverridesServerPropagation);this.isS3OverridesServerPropagation?a.then(()=>{setTimeout(()=>this.dropzone.processFile(r))}):a.then(o=>{o.success?(r.s3ObjectLocation=o.message,setTimeout(()=>this.dropzone.processFile(r)),this.$emit("vdropzone-s3-upload-success",o.message)):o.message!==void 0?this.$emit("vdropzone-s3-upload-error",o.message):this.$emit("vdropzone-s3-upload-error","Network Error : Could not send request to AWS. (Maybe CORS error)")}),a.catch(o=>{alert(o)})},setAWSSigningURL(r){this.isS3&&(this.awss3.signingURL=r)}}},void 0,!1,void 0,void 0,void 0)})})(wo);const zm=wo.exports,So={data:()=>({nlcMouseDown:!1,nlcMouseMoved:!1,containerStyle:{bottom:"40px",right:"40px","touch-action":"none"}}),methods:{changeDisplayIfPossible(t=null){this.nlcMouseMoved?this.nlcMouseMoved=!1:this.changeDisplay(t)},onMouseDown(){this.nlcMouseDown=!0},onMouseUp(){this.nlcMouseDown=!1},onTouchEnd(){this.nlcMouseDown=!1,this.nlcMouseMoved=!1},newBottomAndRight(t){const{height:e,width:n}=this.$el.getBoundingClientRect(),i=window.innerWidth-n,s=window.innerHeight-e;let r=window.innerHeight-t.top-e/2,a=window.innerWidth-t.left-n/2;return a<0?a=0:a>i&&(a=i),r<0?r=0:r>s&&(r=s),{bottom:r,right:a}},positionLivechat(){if(!(this.$el instanceof Element)||!this.isCollapsed)return;const{height:t,width:e}=this.$el.getBoundingClientRect(),n=parseInt(this.containerStyle.right,10),i=parseInt(this.containerStyle.bottom,10),s=n+e-window.innerWidth,r=i+t-window.innerHeight;s>0&&(this.containerStyle.right=window.innerWidth-e+"px"),r>0&&(this.containerStyle.bottom=window.innerHeight-t+"px")},onMouseMove(t){if(this.nlcMouseDown===!0&&this.isCollapsed){this.nlcMouseMoved=!0;const{bottom:e,right:n}=this.newBottomAndRight({top:t.clientY,left:t.clientX});this.containerStyle.right=n+"px",this.containerStyle.bottom=e+"px"}},onTouchMove(t){if(this.nlcMouseDown===!0&&this.isCollapsed){this.nlcMouseMoved=!0;const{bottom:e,right:n}=this.newBottomAndRight({top:t.targetTouches[0].clientY,left:t.targetTouches[0].clientX});this.containerStyle.right=n+"px",this.containerStyle.bottom=e+"px"}}},mounted(){document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("touchend",this.onTouchEnd),document.addEventListener("touchcancel",this.onMouseUp),window.addEventListener("resize",this.positionLivechat)}},To={data:()=>({containerStyle:{}})};ee.use(Ag);const Wm={name:"Chat",components:{FormRating:$g,FormProfile:Ug,Messages:Fm,Dropzone:zm,ScreenMirroring:Bm},mixins:[To,So],data:()=>({currentIcon:null,currentTitle:null,switchIcon:null,canUploadFiles:null,processingUploadFiles:!1,displayAnimation:!1,displayBlockMessage:!1,prevDisplayMode:null,animationSupported:j.hasCssAnimationSupport()&&fe.getInternetExplorerVersion(100)>11,useSpacerOnScrollZone:fe.getInternetExplorerVersion(100)<=11,messageMaxLength:1e3}),created(){st.on("idle",()=>d.dispatch("sendPageState","inactive")),st.on("blur",()=>d.dispatch("sendPageState","inactive")),st.on("focus",()=>d.dispatch("sendPageState","active")),st.on("wakeup",()=>d.dispatch("sendPageState","active"))},store:d,computed:Re(ue(ue({},Te.exports.mapState("ScreenMirroring",{screenMirroringOverlay:"requested"})),Te.exports.mapGetters(["config","settings","workflow","message","display","vueMessage","vueWait","vueProfile","vueRating","vueSendTranscript","vueUpload","vueRegister","stateContactReasonOnly","stateContactReasonWithRegister","stateContactReasonSubmitted","vueAsyncContinue","profile","list","isAsyncAllowed","isEditingProfile","asyncWelcomeBackMsg","transcriptSent","feedbackSent","messagesUnread","hide","close","disconnected","waitingQueueSize","displayWaitContactFormButton","apiError","toConfirmHandover","confirmedHandover","toRegisterHandover","registeredHandover","askFillProfile","isCurrentChatAsync","canUpdateProfile"])),{isCollapsed(){return this.display===Ve},isExpandedFull(){return this.display===Gt},dropzoneOptions(){return{url:`${K.url.api}/api/livechat/attach-file`,addRemoveLinks:!0,withCredentials:!0,dictCancelUpload:"",dictUploadCanceled:"",acceptedFiles:this.config.acceptedFiles,maxFilesize:this.config.maxFilesize,maxFiles:1,dictDefaultMessage:"",dictFallbackMessage:"",dictFallbackText:"",headers:{"Cache-Control":null},fallback(){const t=j.create("<div/>").firstChild;j.addClass(this.element,"dz-browser-not-supported"),j.addClass(t,"dz-message"),j.html(this.element,t)},params(){return{requestId:d.state.request.id,market:window._calleoChat.market,language:window._calleoChat.language,channel:window._calleoChat.channel,secretToken:d.state.secretToken}}}},chatDir(){return this.config.isRTL?"rtl":null},isProfileResetDisabled(){return!this.isEditingProfile||this.workflow===yt},isProfileSaveDisabled(){const t=d.state.profileTmp;let e=!this.isEditingProfile&&this.workflow!==Ee&&this.workflow!==$e&&this.workflow!==_e||this.workflow===yt||!t.legalTerms||d.state.toRegisterHandover===!0&&!t.email||d.state.toRegisterHandover===!1&&(!t.title&&d.state.config.profileFormSettings.title===1||!String.prototype.trim.call(t.firstName)||!String.prototype.trim.call(t.lastName));return(d.state.stateContactReasonOnly||d.state.stateContactReasonWithRegister)&&!d.state.stateContactReasonSubmitted&&(d.state.contactReason===null?e=!0:d.state.stateContactReasonOnly&&(e=!1)),d.state.settings.chatbot_ask_summarize_on_handover&&!d.state.summarizeOnHandover&&d.state.toRegisterHandover&&(e=!0),e}}),watch:{display(){this.updateTitleBar(),this.scrollLiveChat()},vueProfile(){this.updateTitleBar()},vueRegister(){this.scrollLiveChat()},vueUpload(){this.scrollLiveChat()},vueWait(){this.updateTitleBar()},vueMessage(){this.scrollLiveChat(),this.updateTitleBar()},vueRating(){this.scrollLiveChat()},vueSendTranscript(){this.scrollLiveChat()},askFillProfile(t){t&&this.scrollLiveChat()}},beforeMount(){d.state.profileTmp||d.commit(jn)},mounted(){this.scrollLiveChat(),this.updateTitleBar(),this.setBodyClass()},unmounted(){this.onWindowResizeClb&&(window.removeEventListener("resize",this.onWindowResizeClb),this.onWindowResizeClb=null)},methods:{manageScreenMirroringOverlay(){ee.nextTick(()=>{this.onResizeTextArea(),this.scrollLiveChat()})},displayClass(){let t="nlc-container nlc-container-livechat";return t+=" "+(this.displayAnimation?" display-animation":""),t+=" "+(this.displayAnimation&&this.animationSupported?"is-animation":"is-no-animation"),t+=" "+(this.isCollapsed?"nlc-collapse":`nlc-expand ${this.isExpandedFull?"nlc-expand-full":""}`),t},getImagePath(t){return`${K.frontBaseUrl}/apps/calleo-livechat/img/${t}`},updateProfile(t){this.workflow!==Le&&(t.type==="keydown"&&!["Enter","Space"].includes(t.key)||!this.formIsValid()||(d.dispatch("updateProfile"),d.dispatch("announce",{message:"Form submitted"})))},registerHandover(t){t.type==="keydown"&&!["Enter","Space"].includes(t.key)||!this.formIsValid()||(d.dispatch("registerHandover"),d.dispatch("announce",{message:"Form submitted"}))},revertProfileTmp(t){t.type==="keydown"&&!["Enter","Space"].includes(t.key)||d.commit(jn)},markMessageHasRead(){d.commit(gs)},onResizeTextArea(){const t=this.$refs.mainScrollable;if(!t)return;let e="0px";const n=(this.$refs.textArea?this.$refs.textArea.offsetHeight:0)+this.$refs.screenMirroringContainer.offsetHeight-37;if(n>0){const i=t.scrollHeight-t.scrollTop-20<=t.offsetHeight;e=`${n}px`,i&&(t.scrollTop=t.scrollHeight+5)}this.useSpacerOnScrollZone?this.$refs.mainScrollable.querySelector("#nlc-spacer-on-scroll-zone").style.height=e:t.style.paddingBottom=e},updateMessage(t=""){d.commit(qi,t),d.state.message.trim()===""?d.dispatch("sendChatState","active"):d.dispatch("sendChatState","composing")},updateMessageDelay(t){const e=t?t.target.value:"";this.delayUpdateMessage&&(window.clearTimeout(this.delayUpdateMessage),this.delayUpdateMessage=null),d.state.message!==e&&(d.state.message===""||Math.abs(d.state.message.length-e.length)>10?this.updateMessage(e):this.delayUpdateMessage=window.setTimeout(()=>{this.updateMessage(e)},500))},addReturn(t){t.stopPropagation(),t.preventDefault(),t.target.value+=`
`},sendMessage(t){if(t.keyCode===13&&t.shiftKey)return this.addReturn(t);const e=this.$refs.textArea.value||d.state.message;if(e.trim()==="")return;if(this.displayBlockMessage=!1,fe.checkWordsInString(e,K.apiSettings.bannedWords)){this.displayBlockMessage=!0;return}this.updateMessage(),this.delayUpdateMessage&&(window.clearTimeout(this.delayUpdateMessage),this.delayUpdateMessage=null),d.dispatch("start"),d.dispatch("sendMessage",e),d.commit(qi,"");const n=this.$refs.textArea;n&&n.focus&&ee.nextTick(()=>{n.focus()}),this.workflow===Ee&&(d.commit(we,Le),d.state.chatbotContext!==ie.CHATBOT_ONLY&&this.switchVue("wait"))},scrollLiveChat(){ee.nextTick(()=>{const t=this.$refs.mainScrollable;if(!!t)if(d.state.toRegisterHandover===!0){const e=t.querySelector(".nlc-main-scrollable");t.scrollTop=e?e.offsetTop:t.scrollHeight}else if(this.vueSendTranscript===!0){const e=d.state.messages.length,n=t.querySelector(`ul.nlc-livechat > li[data-message-index="0"]:nth-child(${e})`);t.scrollTop=n?n.offsetTop:t.scrollHeight}else if(this.vueRegister===!0&&d.state.confirmedHandover===!0)t.scrollTop=t.scrollHeight;else{if(this.isCollapsed)return;const e=t.querySelectorAll('ul.nlc-livechat > li[data-message-index="0"]');let n=d.state.messages.findIndex(s=>s.read===!1);n<0?n=d.state.messages.length-1:d.state.messages.length>e.length&&(n=Math.max(0,n-(d.state.messages.length-e.length)));const i=e[n];t.scrollTop=i?i.offsetTop:t.scrollHeight,this.markMessageHasRead()}})},showCloseBt(){if(this.isCollapsed)return!1;switch(this.workflow){case _e:return!d.getters.isCurrentChatAsync;case $e:case yt:case on:return!0;case Ee:return!!d.state.settings.only_on_response;default:return!1}},closeChat(){d.dispatch("ScreenMirroring/stop"),this.workflow===_e?this.rateChat():this.resetChat()},getCloseBtTitle(){return this.workflow===_e?"livechat.finish_chat":"livechat.close_chat_window"},cancelRequestAndRedirectOnContactForm(){this.cancelRequest();const t=this.settings.contact_form_url;window.open(t,"_self")},cancelRequest(){d.state.confirmedHandover?d.dispatch("closeChat",{source:"handover"}):(this.collapse(),d.dispatch("cancelRequest",{source:"cancel"}))},rateChat(){d.dispatch("closeChat",{source:"close"})},switchVue(t=null){t||(this.vueWait===!0||this.vueMessage===!0||this.vueSendTranscript===!0?t="profile":t="message");let e=!1,n=!1,i=!1,s=!1,r=!1,a=!1;const o=!1;let c=!1;switch(t){case"wait":e=!0;break;case"message":n=!0;break;case"profile":i=!0;break;case"rating":s=!0;break;case"sendTranscript":r=!0;break;case"upload":n=!0,a=!0;break;case"asyncContinue":c=!0;break;default:n=!0}this.workflow===on&&n&&(n=!1,r=!0),this.workflow===$e&&n&&(n=!1,r=!0),d.commit(Ye,{vueWait:e,vueMessage:n,vueProfile:i,vueRating:s,vueSendTranscript:r,vueUpload:a,vueRegister:o,vueAsyncContinue:c}),this.updateTitleBar(),this.setBodyClass()},updateTitleBar(){const t=`${K.frontBaseUrl}/apps/calleo-livechat/img/`;this.workflow===We?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=null):this.vueMessage?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=`${t}icon-user-small.svg`):this.vueSendTranscript?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=`${t}icon-user-small.svg`):this.vueProfile?(this.currentIcon=`${t}icon-user.svg`,this.currentTitle=this._("js_livechat.profile.title"),this.switchIcon=`${t}icon-chat-small.svg`):this.vueRating?(this.currentIcon=`${t}icon-star.svg`,this.currentTitle=this._("livechat.rating.title"),this.switchIcon=null):this.vueWait?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=null):this.vueRegister?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=null):this.vueAsyncContinue?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=null):this.stateContactReasonOnly?(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=null):this.stateContactReasonWithRegister&&(this.currentIcon=`${t}icon-chat.svg`,this.currentTitle=this._("livechat.website_title"),this.switchIcon=null),this.processAllowActions()},processAllowActions(){this.canUploadFiles=!this.isChatbot()&&d.getters.canUpdateProfile&&this.workflow===_e&&K.apiSettings.enabled_upload},isChatbot(){return d.state.request.chatbotStatus===ie.CHATBOT_ONLY},isEnabledFormRating(){const t=d.state.request.chatbotStatus,e=K.apiSettings.chatbot_enabled_rating_form;if(t===ie.CHATBOT_ONLY)return!1;if(t===ie.CHATBOT_HANDOVER&&d.state.xmppSession.lastOperatorChange!==null&&e||t===ie.NO_CHATBOT)return!0},getMaxLength(){return this.isChatbot()?255:this.messageMaxLength},expand(){if(this.prevDisplayMode===Gt){if(this.display===Gt)return;d.dispatch("expandChatFullWindow")}else{if(this.display===Fe)return;d.dispatch("expandChat")}this.setBodyClass(),ee.nextTick(()=>{const t=this.$refs.textArea;t&&t.focus&&t.focus()})},collapse(){this.isCollapsed||(this.prevDisplayMode=this.display,d.dispatch("collapseChat"),this.setBodyClass())},setBodyClass(){this.display===Ve?(j.addClass(document.body,"livechat-collapsed"),j.removeClass(document.body,"livechat-expanded")):(j.addClass(document.body,"livechat-expanded"),j.removeClass(document.body,"livechat-collapsed"))},isExpanded(){return this.display===Fe},changeDisplay(t=null){this.displayAnimation=!0,t&&this.switchVue("message"),t||this.isCollapsed?(this.expand(),this.triggerResizeEvent()):this.collapse()},toggleDisplayFull(){this.prevDisplayMode=this.display===Fe?Gt:Fe,this.expand(),this.triggerResizeEvent()},triggerResizeEvent(t=500){window.setTimeout(()=>{try{window.dispatchEvent(new Event("resize"))}catch(e){}},t)},onAnimationdEnd(){this.displayAnimation=!1},resetChat(){d.dispatch("cancelRequest",{source:"reset"})},formIsValid(){const e=Array.prototype.slice.call(this.$el.querySelectorAll("input, select, textarea, radio, checkbox")).find(n=>!n.validity||n.validity.valid===!1);return e&&e.reportValidity?e.reportValidity():!0},isFeedbackValid(){return d.state.rating.delay&&d.state.rating.quality&&d.state.rating.satisfaction},isInSendTranscript(){return this.workflow===$e},sendFeedback(t){t.type==="keydown"&&!["Enter","Space"].includes(t.key)||!this.formIsValid()||!this.isFeedbackValid()||(d.commit(we,$e),this.switchVue("sendTranscript"),d.dispatch("sendRating"),d.dispatch("announce",{message:"Form submitted"}))},sendTranscript(){d.dispatch("sendTranscript"),this.updateTitleBar()},clientStopTyping(){d.state.message.trim()===""?d.dispatch("sendChatState","inactive"):d.dispatch("sendChatState","paused")},getCanNotOpenMessage(){switch(d.state.disabledReason){case bt.OPEN_IN_OTHER_TAB:return this._("livechat.chat_started_in_another_tab");case bt.IS_FINISHED:return this._("livechat.chat_is_finished");case bt.BAD_TOKEN:return this._("livechat.invalid_token");default:return this._("livechat.not_open")}},getWaitingMessage(){if(this.waitingQueueSize===null)return d.state.isAsyncAllowed||d.state.request.asyncEnabled?this._("livechat.waiting_welcome.loading"):this._("livechat.waiting_welcome");const t=this._("livechat.waiting_welcome_information_time"),e=Object.keys(d.state.xmppSession.operatorsInQueue||{}).length,n=(this.waitingQueueSize+1)*Number(this.settings.avg_waiting_time||0);let i="";n<60?i=n+" "+this._("livechat.seconds"):n<120?i="1:"+String(n%60).padStart(2,"0")+" "+this._("livechat.minute"):i=Math.floor(n/60)+":"+String(n%60).padStart(2,"0")+" "+this._("livechat.minutes");const s=this._("livechat.waiting_welcome")+" "+t.replace("{$$customer$$}",this.waitingQueueSize).replace("{$$time$$}",i).replace("{$$operator$$}",e);return n>this.settings.contact_form_display_after_waiting_time&&this.settings.contact_form_url!==""&&d.commit(ao,!0),s},displayMain(){return this.workflow!==We},focus(){this.displayAnimation||this.markMessageHasRead(),d.state.message.trim()===""?d.dispatch("sendChatState","active"):d.dispatch("sendChatState","composing")},setProcessingUploadFiles(t){t?j.addClass(this.$refs.dropzone.$el,"is-disabled"):j.removeClass(this.$refs.dropzone.$el,"is-disabled"),this.processingUploadFiles=t},dropzoneMounted(){this.$refs.dropzone.setOption("dictDefaultMessage",this._("livechat.upload")),this.$refs.dropzone.setOption("dictFallbackMessage",this._("livechat.upload_browser_support")),this.$refs.dropzone.setOption("dictFileTooBig",this._("livechat.upload_file_too_big")),this.$refs.dropzone.setOption("dictInvalidFileType",this._("livechat.upload_invalid_file_type")),this.$refs.dropzone.setOption("dictResponseError",this._("livechat.upload_response_error")),this.$refs.dropzone.setOption("dictRemoveFile",this._("livechat.upload_remove_file")),this.$refs.dropzone.setOption("dictMaxFilesExceeded",this._("livechat.upload_max_files_exceeded"));const[t]=this.$refs.dropzone.$el.getElementsByTagName("div");j.hasClass(this.$refs.dropzone.$el,"dz-browser-not-supported")?j.text(t,this._("livechat.upload_browser_support")):j.text(t,this._("livechat.upload"))},dropzoneMaxFilesExceeded(t){this.$refs.dropzone.removeAllFiles(),this.$refs.dropzone.dropzone.addFile(t)},dropzoneSending(){this.setProcessingUploadFiles(!0)},dropzoneSuccess(t,e){t.status==="success"&&e.success&&e.attachments&&e.attachments.forEach(n=>{d.dispatch("sendAttachment",{name:n.name,location:n.location})})},dropzoneComplete(t){t.status==="success"&&this.switchVue("message"),this.setProcessingUploadFiles(!1)},triggerHandoverOnAgent(){d.dispatch("triggerHandoverOnAgent")},confirmHandover(){!d.state.profile.email&&d.state.toRegisterHandover?d.dispatch("showHandoverRegister"):d.state.registeredHandover?this.rateChat():this.triggerHandoverOnAgent()},askFillProfileClick(){d.dispatch("showProfile")},asyncChatContinueClick(){d.dispatch("goInQueue")},displayAsyncWelcomeBackMsg(){return this.asyncWelcomeBackMsg&&setTimeout(()=>{d.commit(co,!1)},3500),this.asyncWelcomeBackMsg}}};var jm=function(){var e=this,n=e._self._c;return e.hide?e._e():n("section",{class:e.displayClass(),style:e.containerStyle,attrs:{id:"nespresso-livechat",dir:e.chatDir},on:{animationend:e.onAnimationdEnd,animationcancel:e.onAnimationdEnd,mousedown:e.onMouseDown,touchstart:e.onMouseDown}},[n("transition",{attrs:{name:"slide-right"}},[e.displayAsyncWelcomeBackMsg()?n("div",{staticClass:"async-welcome-back-msg"},[n("p",[e._v(e._s(e._("livechat.async_chat.welcome_back_msg")))])]):e._e()]),n("header",{staticClass:"nlc-header prevent-select",on:{click:function(i){return e.changeDisplayIfPossible()}}},[n("transition",{attrs:{name:"slide"}},[n("div",{staticClass:"nlc-wrapper"},[n("div",{staticClass:"nlc-icon"},[n("transition",{attrs:{name:"bounce"}},[e.messagesUnread?n("div",{staticClass:"nlc-unread",class:{"nlc-unread-profile":e.vueProfile},on:{click:function(i){return i.stopPropagation(),e.changeDisplay(!0)}}},[e._v(" "+e._s(e.messagesUnread)+" ")]):e._e()]),n("img",{staticClass:"white-svg",attrs:{src:e.currentIcon,alt:"Icon",width:"100%",height:"100%",draggable:"false"}})],1),n("div",{staticClass:"nlc-title"},[n("h6",{domProps:{innerHTML:e._s(e.currentTitle)}})]),n("div",{staticClass:"nlc-actions"},[e.canUpdateProfile?n("a",{staticClass:"nlc-action nlc-action-account",attrs:{href:"javascript:void(0)"},on:{click:function(i){return i.stopPropagation(),e.switchVue()}}},[n("img",{staticClass:"white-svg",attrs:{src:e.vueProfile?e.switchIcon:e.getImagePath("icon-user-small.svg"),alt:"Icon",width:"20px",height:"25px"}})]):e._e(),n("a",{staticClass:"nlc-action nlc-action-collapse",attrs:{href:"javascript:void(0)"},on:{click:function(i){return i.stopPropagation(),e.changeDisplay()}}}),e.showCloseBt()?n("a",{staticClass:"nlc-action nlc-action-close",attrs:{href:"javascript:void(0)"},on:{click:function(i){return i.stopPropagation(),e.closeChat()}}},[n("img",{staticClass:"white-svg",attrs:{src:e.getImagePath("icon-close.svg"),title:e._(e.getCloseBtTitle()),alt:"Icon",width:"24px",height:"24px"}})]):e._e(),n("a",{staticClass:"nlc-action nlc-action-expandfull",attrs:{href:"javascript:void(0)"},on:{click:function(i){return i.stopPropagation(),e.toggleDisplayFull()}}},[n("img",{staticClass:"white-svg",attrs:{src:e.isExpandedFull?e.getImagePath("icon-unexpanded.png"):e.getImagePath("icon-expand.png"),title:e._("livechat.expand_full"),alt:"Icon",height:"18px",width:"18px"}})])])])])],1),n("div",{staticClass:"nlc-wrapper"},[e.displayMain()?n("div",{staticClass:"nlc-main"},[n("transition",{attrs:{name:"slide"}},[e.vueWait?n("div",{attrs:{id:"wait","aria-live":"assertive"}},[n("div",{staticClass:"nlc-wait-info"},[n("div",{staticClass:"nlc-wait-loader"},[n("ul",{staticClass:"nlc-typing"},[n("li"),e._v(" "),n("li"),e._v(" "),n("li")])]),n("p",{staticClass:"nlc-wait-message",attrs:{"aria-live":"polite"},domProps:{innerHTML:e._s(e.getWaitingMessage())}}),e.displayWaitContactFormButton?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filler",on:{click:function(i){return i.preventDefault(),e.cancelRequestAndRedirectOnContactForm.apply(null,arguments)}}},[e._v(" "+e._s(e._("livechat.go_on_contact_form"))+" ")]):e._e()])]):e._e()]),e.disconnected&&(e.vueMessage||e.vueUpload)?n("div",{staticClass:"nlc-livechat-disconnected"},[n("div",{staticClass:"nlc-wait-info",attrs:{"aria-live":"polite"}},[n("p",{staticClass:"nlc-wait-message",domProps:{innerHTML:e._s(e._("livechat.disconnected_try_in_progress"))}})])]):e._e(),e.apiError?n("div",{staticClass:"nlc-livechat-error",attrs:{"aria-live":"polite"}},[n("p",{domProps:{innerHTML:e._s(e._("livechat.error_api"))}})]):e._e(),e.vueMessage||e.vueSendTranscript||e.vueUpload||e.vueRegister||e.vueRating||e.vueProfile||e.vueAsyncContinue?n("div",{ref:"mainScrollable",staticClass:"nlc-main-scrollable",class:{"nlc-main-scrollable-attachment":!(e.apiError||e.disconnected)&&e.vueUpload},attrs:{id:"nlc-main-scrollable"}},[n("transition",{attrs:{name:"slide"}},[(e.vueProfile||e.vueRegister)&&!e.confirmedHandover&&!e.toRegisterHandover?n("FormProfile",{attrs:{config:e.config,list:e.list}}):e._e()],1),n("transition",{attrs:{name:"slide"}},[e.vueMessage||e.vueSendTranscript||e.vueRegister||e.vueUpload?n("Messages",{on:{newMessage:function(i){return e.scrollLiveChat()}}}):e._e()],1),n("transition",{attrs:{name:"slide"}},[(e.vueProfile||e.vueRegister)&&(e.confirmedHandover||e.toRegisterHandover)?n("FormProfile",{attrs:{config:e.config,list:e.list}}):e._e()],1),n("transition",{attrs:{name:"slide"}},[e.vueSendTranscript?n("div",{staticClass:"nlc-actions nlc-transcript-actions",staticStyle:{"text-align":"center"},attrs:{"aria-live":"polite"}},[!e.transcriptSent&&!e.profile.email?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled nlc-ui-btn-margin nlc-ui-btn-small",attrs:{id:"submit_button"},on:{click:function(i){return e.switchVue("profile")}}},[n("span",{staticClass:"nlc-multi-line"},[e._v(e._s(e._("livechat.complete_profile")))])]):e._e(),!e.transcriptSent&&e.profile.email?n("span",[e._v(e._s(e._("livechat.send_transcript_to"))+":")]):e._e(),!e.transcriptSent&&e.profile.email?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-small nlc-ui-btn-filled nlc-ui-mt-1 nlc-ui-mb-1",attrs:{id:"submit_button"},on:{click:e.sendTranscript}},[n("span",{staticClass:"nlc-small sessioncamhidetext"},[e._v(e._s(e.profile.email))])]):e._e(),e.transcriptSent?n("div",{staticClass:"nlc-transcript nlc-msg-success",attrs:{id:"transcript_sent"}},[n("div",{staticClass:"nlc-wrapper"},[n("div",{staticClass:"nlc-icon"},[n("span",[n("img",{attrs:{src:e.getImagePath("icon-success.svg"),alt:"Icon"}})])]),n("div",{staticClass:"nlc-msg"},[n("span",[e._v(e._s(e._("livechat.transcript_sent_to").trim())+": ")]),n("span",{staticClass:"sessioncamhidetext"},[e._v(e._s(e.profile.email))])])])]):e._e()]):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueSendTranscript&&!e.feedbackSent&&!e.registeredHandover&&e.isEnabledFormRating()?n("FormRating",{attrs:{config:e.config}}):e._e()],1),n("transition",{attrs:{name:"slide"}},[e.vueAsyncContinue?n("div",{staticClass:"nlc-livechat-async-continue"},[n("p",{staticClass:"nlc-livechat-async-continue-message",domProps:{innerHTML:e._s(e._("livechat.chat_started_in_another_tab"))}}),n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",on:{click:e.asyncChatContinueClick}},[n("span",[e._v(e._s(e._("livechat.async_chat.resume_chat")))])])]):e._e()]),e.askFillProfile&&!e.profile.id&&!e.vueProfile?n("div",{staticClass:"nlc-livechat-async-chat-fill-profile"},[n("p",{staticClass:"nlc-livechat-async-chat-fill-profile-message",domProps:{innerHTML:e._s(e._("livechat.async_chat.fill_profile.message"))}}),n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",on:{click:e.askFillProfileClick}},[n("span",[e._v(e._s(e._("livechat.async_chat.fill_profile.button")))])])]):e._e()],1):e._e()],1):n("div",{staticClass:"nlc-main",attrs:{"aria-live":"polite"}},[n("div",{staticClass:"nlc-wait-info"},[n("p",{staticClass:"nlc-wait-message",domProps:{innerHTML:e._s(e.getCanNotOpenMessage())}})])])]),e.displayMain()?n("footer",{staticClass:"nlc-footer",class:{"nlc-can-upload":e.canUploadFiles,"nlc-screen-mirroring":e.screenMirroringOverlay}},[n("transition",{attrs:{name:"slide"}},[n("div",{ref:"screenMirroringContainer",staticClass:"screen-mirroring"},[n("ScreenMirroring",{on:{resize:e.manageScreenMirroringOverlay}})],1)]),n("transition",{attrs:{name:"slide"}},[e.vueWait&&!e.isCurrentChatAsync?n("div",{staticClass:"nlc-action nlc-ui-actions"},[n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-inverted nlc-ui-w-100",on:{click:function(i){return i.preventDefault(),e.cancelRequest.apply(null,arguments)}}},[n("span",[e._v(e._s(e._("livechat.stop_request")))])])]):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueMessage||e.vueUpload?n("div",[n("transition",{attrs:{name:"slide"}},[!(e.apiError||e.disconnected)&&e.vueUpload?n("div",{staticClass:"nlc-action nlc-action-attachment"},[n("Dropzone",{ref:"dropzone",attrs:{id:"dropzone",options:e.dropzoneOptions},on:{"vdropzone-mounted":e.dropzoneMounted,"vdropzone-max-files-exceeded":e.dropzoneMaxFilesExceeded,"vdropzone-sending":e.dropzoneSending,"vdropzone-success":e.dropzoneSuccess,"vdropzone-complete":e.dropzoneComplete}})],1):e._e()]),e.displayBlockMessage&&(e.vueMessage||e.vueUpload)?n("div",[n("transition",{attrs:{name:"slide"}},[n("div",{staticClass:"nlc-error"},[n("span",[e._v(e._s(e._("livechat.banned-keywords.error-word-detected")))])])])],1):e._e(),e.toConfirmHandover?e._e():n("div",{staticClass:"nlc-footer-message-wrapper"},[n("div",{staticClass:"nlc-message"},[n("textarea",{directives:[{name:"autosize",rawName:"v-autosize"}],ref:"textArea",staticClass:"nlc-input",class:{"is-disabled":e.disconnected||e.apiError},staticStyle:{"min-height":"2em"},attrs:{placeholder:e._("livechat.message_indice"),maxlength:e.getMaxLength()},domProps:{value:e.message},on:{"autosize:resized":e.onResizeTextArea,input:e.updateMessageDelay,focus:e.focus,blur:e.clientStopTyping,keydown:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:(i.stopPropagation(),i.preventDefault(),e.sendMessage.apply(null,arguments))}}})]),n("div",{staticClass:"nlc-footer-buttons-wrapper"},[e.canUploadFiles?n("button",{staticClass:"nlc-ui-btn-icon",class:{"is-disabled":e.disconnected||e.apiError||e.processingUploadFiles},on:{click:function(i){return i.preventDefault(),e.switchVue(e.vueUpload?"message":"upload")}}},[n("img",{attrs:{src:e.getImagePath("icon-attachment.svg"),alt:"Attachment"}})]):e._e(),n("button",{staticClass:"nlc-ui-btn-icon nlc-ui-btn-send",class:{"is-disabled":e.disconnected||e.apiError},on:{click:function(i){return i.preventDefault(),e.sendMessage.apply(null,arguments)}}},[n("img",{attrs:{src:e.getImagePath("send.svg"),alt:"Send"}})])])])],1):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueMessage&&e.toConfirmHandover?n("div",{staticClass:"nlc-action nlc-ui-actions"},[n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",attrs:{id:"handover_button"},on:{click:e.confirmHandover}},[n("span",[e._v(e._s(e._("chatbot.handover_confirm.button")))])])]):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueSendTranscript?n("div",{staticClass:"nlc-action"},[!e.feedbackSent&&!e.registeredHandover&&e.isEnabledFormRating()?n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",class:{"is-disabled":!e.isFeedbackValid()},on:{click:function(i){return i.preventDefault(),e.sendFeedback.apply(null,arguments)},keydown:function(i){return i.preventDefault(),e.sendFeedback.apply(null,arguments)}}},[n("span",[e._v(e._s(e._("livechat.send_feedback")))])]):e._e(),e.feedbackSent&&!e.registeredHandover?n("div",{staticClass:"nlc-feedback nlc-msg-success",attrs:{id:"feedback_sent"}},[n("div",{staticClass:"nlc-wrapper"},[n("div",{staticClass:"nlc-icon"},[n("span",[n("img",{attrs:{src:e.getImagePath("icon-success.svg"),alt:"Icon"}})])]),n("div",{staticClass:"nlc-msg"},[n("span",[e._v(e._s(e._("livechat.feedback_sent"))+" ")])])])]):e._e()]):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueProfile&&!e.isInSendTranscript()?n("div",{staticClass:"nlc-actions nlc-ui-actions"},[n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-inverted",class:{"is-disabled":e.isProfileResetDisabled},attrs:{disabled:e.isProfileResetDisabled,title:e._("livechat.reset")},on:{click:e.revertProfileTmp,keydown:e.revertProfileTmp}},[n("span",[e._v(e._s(e._("livechat.reset")))])]),n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",class:{"is-disabled":e.isProfileSaveDisabled},attrs:{disabled:e.isProfileSaveDisabled,title:e._("livechat.save")},on:{click:e.updateProfile,keydown:e.updateProfile}},[n("span",[e._v(e._s(e._("livechat.save")))])])]):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueProfile&&e.isInSendTranscript()?n("div",{staticClass:"nlc-action"},[n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",class:{"is-disabled":e.isProfileSaveDisabled},attrs:{disabled:e.isProfileSaveDisabled,title:e._("livechat.request_chat")},on:{click:e.updateProfile,keydown:e.updateProfile}},[e._v(" > "),n("span",[e._v(e._s(e._("livechat.send_transcript")))])])]):e._e()]),n("transition",{attrs:{name:"slide"}},[e.vueRegister?n("div",{staticClass:"nlc-action nlc-ui-actions"},[n("button",{staticClass:"nlc-ui-btn nlc-ui-btn-filled",class:{"is-disabled":e.isProfileSaveDisabled},attrs:{disabled:e.isProfileSaveDisabled,title:e._(e.toRegisterHandover?"livechat.send":"livechat.request_chat")},on:{click:i=>e.toRegisterHandover?e.registerHandover(i):e.updateProfile(i),keyDown:i=>e.toRegisterHandover?e.registerHandover(i):e.updateProfile(i)}},[n("span",[e._v(e._s(e._(e.toRegisterHandover?"livechat.send":"livechat.request_chat")))])])]):e._e()])],1):e._e()],1)},Xm=[],Qm=he(Wm,jm,Xm,!1,null,null,null,null);const Gm=Qm.exports,Jm="ambassador",Vm="expert",Ym="connoisseur",Km="authenticated",Zm="anonymous",kr={AMBASSADOR:Jm,EXPERT:Vm,CONNOISSEUR:Ym,AUTHENTICATED:Km,ANONYMOUS:Zm},e_="never",t_="chat_open",n_="always",_i={NEVER:e_,CHAT_OPEN:t_,ALWAYS:n_},i_=t=>t.liveChatSettings,s_=t=>t.settings,r_=t=>t.config,a_=t=>t.hide,o_=t=>t.display,l_=t=>t.panelIsOpen,c_=t=>t.panelContent,u_=Object.freeze(Object.defineProperty({__proto__:null,liveChatSettings:i_,settings:s_,config:r_,hide:a_,display:o_,panelIsOpen:l_,panelContent:c_},Symbol.toStringTag,{value:"Module"})),Gn="DISPLAY_COLLAPSE",Cs="DISPLAY_EXPAND",Eo="UPDATE_CONFIG",Ao="UPDATE_SETTINGS",xo="UPDATE_LIVE_CHAT_SETTINGS",ko="SHOW",Oo="HIDE",ws="UPDATE_DISPLAY",Ss="UPDATE_PANEL_STATE",Io="UPDATE_PANEL_CONTENT",d_=({dispatch:t})=>{t("show")},h_=({commit:t},e)=>{t(Eo,e)},f_=({commit:t},e)=>{t(Ao,e)},p_=({commit:t},e)=>{t(xo,e)},g_=({commit:t})=>{t(ko)},m_=({commit:t})=>{t(Oo)},__=({commit:t})=>{t(ws,Cs)},v_=({commit:t})=>{t(ws,Gn)},y_=({dispatch:t})=>{t("hide"),window.calleoChat("startChat",{source:"chat_embed"})},b_=({commit:t})=>{t(Ss,!0)},C_=({commit:t})=>{t(Ss,!1)},w_=({commit:t},e)=>{t(Io,e.content)},S_=Object.freeze(Object.defineProperty({__proto__:null,start:d_,updateConfig:h_,updateSettings:f_,updateLiveChatSettings:p_,show:g_,hide:m_,expandWindow:__,collapseWindow:v_,switchToLivechatWindow:y_,openPanel:b_,closePanel:C_,updatePanelContent:w_},Symbol.toStringTag,{value:"Module"})),T_={[Eo](t,e){t.config=e},[Ao](t,e){t.settings=e},[xo](t,e){t.liveChatSettings=e},[Oo](t){t.hide=!0},[ko](t){t.hide=!1},[ws](t,e){t.display=e,G.dispatcher.emit("display-status",e===Cs)},[Ss](t,e){t.panelIsOpen=e},[Io](t,e){t.panelContent=e}},E_={get(){return ue({},{settings:{},liveChatSettings:{},config:{},hide:!1,display:Gn,panelIsOpen:!1,panelContent:null})}};ee.use(Vn);const be=new Vn.Store({state:E_.get(),getters:u_,actions:S_,mutations:T_,strict:!0,plugins:[]}),A_="simple_link",x_="advanced_link",k_="livechat",O_="phone",ji={SIMPLE_LINK:A_,ADVANCED_LINK:x_,LIVE_CHAT:k_,PHONE:O_},si={getBlockItemClass:t=>"cw-block-item cw-block-item-"+t,getIconClass:t=>"icon-cw icon-cw-"+t,getBlockItemButtonClass(t){const e="cw-block-item-info cw-block-item-info-button";return this.getBlockAvailability(t)?e:e+" cw-block-item-info-button-disabled"},getBlockAvailability(t){return t.isAvailable?t.blockType===ji.LIVE_CHAT?K.apiSettings.enabled&&(K.apiSettings.is_chat_open&&K.apiSettings.enabled_reactive||K.apiSettings.chatbot_enabled||Se.isAsyncChatEnabledForCustomer()):!0:!1},getBlockAvailabilityLabel(t){return this.getBlockAvailability(t)?this._("livechat.conversational_window.block.is_available"):this._("livechat.conversational_window.block.is_not_available")},getBlockAvailabilityClass(t){const e="cw-block-item-info cw-block-item-info-availability";return this.getBlockAvailability(t)?e+" cw-block-item-info-availability-available":e+" cw-block-item-info-availability-not-available"},openPanel(){be.dispatch("openPanel")},closePanel(){be.dispatch("closePanel")},updatePanel(t){be.dispatch("updatePanelContent",{content:t})},getLinkHrefAttribute(t){if(new RegExp("^[-!#$%&'*+\\./0-9=?A-Z^_`a-z{|}~]+@[-!#$%&'*+\\/0-9=?A-Z^_`a-z{|}~]+.[-!#$%&'*+\\./0-9=?A-Z^_`a-z{|}~]+$").test(t))return"mailto:"+t;const n=document.createElement("input");if(n.type="url",n.value=t,n.checkValidity())return t;const i=t.charAt(0);return(i==="+"||!isNaN(i))&&parseInt(t.substring(1,void 0))>0?"tel:"+t:t}},I_={name:"SimpleLinkBlock",props:{settings:Object,extraBottomMargin:{type:Boolean,default:!1}},computed:{buttonUrl(){return this.settings.qrCodeEnabled?"#":this.settings.link},buttonTarget(){return this.settings.qrCodeEnabled?"":this.settings.targetBlank?"_blank":""}},methods:Re(ue({},si),{clickOnButton(t){this.settings.qrCodeEnabled&&(t.preventDefault(),this.updatePanel(this.settings),this.openPanel())}})};var M_=function(){var e=this,n=e._self._c;return n("div",{staticClass:"cw-block-item-container cw-block-item-simple-link-container",style:{marginBottom:e.extraBottomMargin?"15px":0}},[n("a",{attrs:{href:e.buttonUrl,role:"button",target:e.buttonTarget},on:{click:e.clickOnButton}},[n("i",{class:e.getIconClass(e.settings.linkIcon)}),n("span",{staticClass:"cw-block-item-info-button-label"},[e._v(e._s(e.settings.linkTitle))])])])},R_=[],N_=he(I_,M_,R_,!1,null,null,null,null);const L_=N_.exports,P_={name:"AdvancedLinkBlock",props:{settings:Object},computed:{buttonUrl(){return this.settings.qrCodeEnabled?"#":this.getLinkHrefAttribute(this.settings.link)},buttonTarget(){return this.settings.qrCodeEnabled?"":this.settings.targetBlank?"_blank":""}},methods:Re(ue({},si),{clickOnBlock(t){const e=t.target.closest(".cw-block-item-container").querySelector("a");e&&e.click()},clickOnButton(t){this.settings.qrCodeEnabled&&(t.preventDefault(),this.updatePanel(this.settings),this.openPanel())}})};var $_=function(){var e=this,n=e._self._c;return n("div",{staticClass:"cw-block-item-container cw-block-item-advanced-link-container cw-block-item-clickable",on:{click:e.clickOnBlock}},[e.settings.image||e.settings.icon?n("div",{staticClass:"image-container"},[e.settings.image&&!e.settings.forceUseIcon?n("img",{attrs:{src:e.settings.image,alt:e.settings.title}}):e._e(),e.settings.icon&&e.settings.forceUseIcon?n("i",{class:`icon-cw icon-cw-${e.settings.icon}`}):e._e()]):e._e(),n("div",{staticClass:"data-container"},[n("a",{staticClass:"title",attrs:{href:e.buttonUrl,role:"button",target:e.buttonTarget},on:{click:e.clickOnButton}},[e._v(e._s(e.settings.title))]),e.settings.description&&e.settings.description!==""?n("p",{staticClass:"description",domProps:{innerHTML:e._s(e.settings.description)}}):e._e(),n("div",{class:e.getBlockAvailabilityClass(e.settings)},[n("span",{staticClass:"cw-block-item-info-availability-point"},[e._v("\u2022")]),n("span",{staticClass:"cw-block-item-info-availability-label",domProps:{innerHTML:e._s(e.getBlockAvailabilityLabel(e.settings))}})])])])},F_=[],D_=he(P_,$_,F_,!1,null,null,null,null);const H_=D_.exports,q_={name:"LivechatBlock",props:{settings:Object},methods:Re(ue({},si),{isLiveChatBlockTypeDisplayed(t){return!K.excludedFromLiveChat&&!K.excludedFromChatbot&&!K.excludedFromEmbed&&this.getBlockAvailability(t)},switchToLivechatWindow(t){!this.getBlockAvailability(t)||be.dispatch("switchToLivechatWindow")}})};var U_=function(){var e=this,n=e._self._c;return e.isLiveChatBlockTypeDisplayed(e.settings)?n("div",{staticClass:"cw-block-item-container cw-block-item-advanced-link-container cw-block-item-clickable",on:{click:function(i){return e.switchToLivechatWindow(e.settings)}}},[e.settings.image||e.settings.icon?n("div",{staticClass:"image-container"},[e.settings.image&&!e.settings.forceUseIcon?n("img",{attrs:{src:e.settings.image,alt:e.settings.title}}):e._e(),e.settings.icon&&e.settings.forceUseIcon?n("i",{class:`icon-cw icon-cw-${e.settings.icon}`}):e._e()]):e._e(),n("div",{staticClass:"data-container"},[n("span",{staticClass:"title"},[e._v(e._s(e.settings.title))]),n("p",{staticClass:"description",domProps:{innerHTML:e._s(e.settings.description)}}),n("div",{class:e.getBlockAvailabilityClass(e.settings)},[n("span",{staticClass:"cw-block-item-info-availability-point"},[e._v("\u2022")]),n("span",{staticClass:"cw-block-item-info-availability-label",domProps:{innerHTML:e._s(e.getBlockAvailabilityLabel(e.settings))}})])])]):e._e()},B_=[],z_=he(q_,U_,B_,!1,null,null,null,null);const W_=z_.exports,j_={name:"Blocks",components:{AdvancedLinkBlock:H_,SimpleLinkBlock:L_,LivechatBlock:W_},created(){this.blockTypes=ji},computed:ue({},Te.exports.mapGetters(["liveChatSettings","settings"])),props:[],data(){return{blockTypes:ji}},methods:{getBlockItemClass(t){return"cw-block-item cw-block-item-"+t.blockType},checkAdvancedLinkBlockType(t,e){return e.indexOf(t.blockType)>-1},getBlocksForSection(t){if(t==="contact_us")return this.contactUsBlocks||(this.contactUsBlocks=this.filterAndStoreBlocks(t)),this.contactUsBlocks;if(t==="self_serve")return this.selfServeBlocks||(this.selfServeBlocks=this.filterAndStoreBlocks(t)),this.selfServeBlocks},filterAndStoreBlocks(t){return Object.keys(this.settings.blocksData).map(n=>this.settings.blocksData[n]).filter(n=>n.section===t&&n.isAvailable)}},watch:{}};var X_=function(){var e=this,n=e._self._c;return n("div",{staticClass:"cw-blocks"},[e.getBlocksForSection("self_serve").length?n("div",{staticClass:"cw-self-serve-blocks"},[e.settings.sections.self_serve!==""?n("h5",{staticClass:"cw-section-title"},[e._v(" "+e._s(e.settings.sections.self_serve)+" ")]):e._e(),n("ul",{staticClass:"cw-blocks-list"},e._l(e.getBlocksForSection("self_serve"),function(i){return n("li",{class:e.getBlockItemClass(i)},[i.blockType===e.blockTypes.SIMPLE_LINK?n("SimpleLinkBlock",{attrs:{settings:i}}):e._e(),e.checkAdvancedLinkBlockType(i,[e.blockTypes.PHONE,e.blockTypes.ADVANCED_LINK])?n("AdvancedLinkBlock",{attrs:{settings:i}}):e._e(),e.checkAdvancedLinkBlockType(i,[e.blockTypes.LIVE_CHAT])?n("LivechatBlock",{attrs:{settings:i}}):e._e()],1)}),0)]):e._e(),e.getBlocksForSection("contact_us").length?n("div",{staticClass:"cw-contact-us-blocks"},[e.settings.sections.contact_us!==""?n("h5",{staticClass:"cw-section-title"},[e._v(" "+e._s(e.settings.sections.contact_us)+" ")]):e._e(),n("ul",{staticClass:"cw-blocks-list"},e._l(e.getBlocksForSection("contact_us"),function(i){return n("li",{class:e.getBlockItemClass(i)},[i.blockType===e.blockTypes.SIMPLE_LINK?n("SimpleLinkBlock",{attrs:{"extra-bottom-margin":e.getBlocksForSection("contact_us")[e.getBlocksForSection("contact_us").length-1].blockType==="simple_link",settings:i}}):e._e(),e.checkAdvancedLinkBlockType(i,[e.blockTypes.PHONE,e.blockTypes.ADVANCED_LINK])?n("AdvancedLinkBlock",{attrs:{settings:i}}):e._e(),e.checkAdvancedLinkBlockType(i,[e.blockTypes.LIVE_CHAT])?n("LivechatBlock",{attrs:{settings:i}}):e._e()],1)}),0)]):e._e()])},Q_=[],G_=he(j_,X_,Q_,!1,null,null,null,null);const J_=G_.exports,V_={name:"Panel",computed:ue({},Te.exports.mapGetters(["panelContent"])),methods:Re(ue({},si),{close(){be.dispatch("closePanel")}})};var Y_=function(){var e=this,n=e._self._c;return n("div",{staticClass:"qc-panel"},[n("div",{staticClass:"qc-header"},[n("a",{staticClass:"qc-back-btn",attrs:{role:"button"},on:{click:function(i){return e.close()}}},[n("i",{staticClass:"icon-arrow_right"}),n("span",[e._v(e._s(e._("qr_code_panel.button.back")))])])]),e.panelContent?n("div",{staticClass:"qc-body"},[n("div",{staticClass:"cw-blocks"},[n("div",{staticClass:"cw-blocks-list"},[n("div",{staticClass:"cw-block-item"},[n("div",{staticClass:"cw-block-item-container cw-block-item-link-container"},[n("a",{staticClass:"cw-block-item-info cw-block-item-info-button",attrs:{href:e.getLinkHrefAttribute(e.panelContent.link),role:"button",target:e.panelContent.targetBlank?"_blank":""}},[n("i",{class:e.getIconClass(e.panelContent.linkIcon)}),n("span",{staticClass:"cw-block-item-info-button-label"},[e._v(e._s(e.panelContent.linkTitle))])])])])])]),n("div",{staticClass:"qc-code"},[n("img",{staticClass:"qr-code",attrs:{src:e.panelContent.qrCodeUrl}})]),n("div",{staticClass:"qc-instructions",domProps:{innerHTML:e._s(e.panelContent.qrCodeInstructions)}})]):e._e()])},K_=[],Z_=he(V_,Y_,K_,!1,null,null,null,null);const ev=Z_.exports,tv={name:"ConversationalWindow",components:{Blocks:J_,Panel:ev},mixins:[To,So],store:be,data:()=>({currentIcon:null,currentTitle:null,displayAnimation:!1,mounted:!1,animationSupported:j.hasCssAnimationSupport()&&fe.getInternetExplorerVersion(100)>11}),computed:Re(ue({},Te.exports.mapGetters(["config","hide","display","panelIsOpen"])),{displayClass(){let t="nlc-container nlc-container-conversational-window";return t+=" "+(this.displayAnimation?" display-animation":""),t+=" "+(this.displayAnimation&&this.animationSupported?"is-animation":"is-no-animation"),t+=" "+(this.isCollapsed?"nlc-collapse":"nlc-expand"),t+=" "+(this.mounted||!this.animationSupported?"is-mounted":"is-not-mounted"),t},isCollapsed(){return this.display===Gn},chatDir(){return this.config.isRTL?"rtl":null}}),mounted(){setTimeout(()=>{this.mounted=!0},1e3)},methods:{changeDisplay(){this.displayAnimation=!0,this.isCollapsed?be.dispatch("expandWindow"):be.dispatch("collapseWindow"),this.setBodyClass()},onAnimationdEnd(){this.displayAnimation=!1},setBodyClass(){this.display===Cs?(j.addClass(document.body,"livechat-expanded"),j.removeClass(document.body,"livechat-collapsed")):(j.addClass(document.body,"livechat-collapsed"),j.removeClass(document.body,"livechat-expanded"))},getImagePath(t){return`${K.frontBaseUrl}/apps/calleo-livechat/img/${t}`},showCloseBt(){return this.display!==Gn},displayFeedbackBlock(){return K.conversationalWindowSettings.feedbackBlockEnabled},getFeedbackUrl(){return K.conversationalWindowSettings.feedbackBlockUrl}}};var nv=function(){var e=this,n=e._self._c;return e.hide?e._e():n("section",{class:e.displayClass,style:e.containerStyle,attrs:{id:"nespresso-conversational-window",dir:e.chatDir},on:{animationend:e.onAnimationdEnd,animationcancel:e.onAnimationdEnd,mousedown:e.onMouseDown,touchstart:e.onMouseDown}},[n("header",{staticClass:"nlc-header prevent-select",on:{click:function(i){return e.changeDisplayIfPossible()}}},[n("div",{staticClass:"nlc-wrapper"},[e._m(0),n("div",{staticClass:"nlc-title"},[n("h6",{domProps:{innerHTML:e._s(e._("livechat.conversational_window.title"))}})]),n("div",{staticClass:"nlc-actions"},[n("a",{staticClass:"nlc-action nlc-action-collapse",attrs:{href:"javascript:void(0)",role:"button"},on:{click:function(i){return i.stopPropagation(),e.changeDisplay()}}})])])]),n("div",{staticClass:"nlc-wrapper"},[n("div",{staticClass:"nlc-main",attrs:{"aria-live":"polite"}},[n("transition",{attrs:{name:"slide-left"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.panelIsOpen,expression:"!panelIsOpen"}],ref:"mainScrollable",staticClass:"nlc-main-scrollable"},[n("transition",{attrs:{name:"slide"}},[n("Blocks")],1),e.displayFeedbackBlock()?n("div",{staticClass:"cw-block-feedback-container"},[n("div",{staticClass:"nlc-feedback-title"},[e._v(" "+e._s(e._("livechat.conversational_window.feedback_title"))+" ")]),n("a",{staticClass:"nlc-feedback-link",attrs:{href:e.getFeedbackUrl(),role:"button"}},[e._v(" "+e._s(e._("livechat.conversational_window.feedback_link_title"))+" ")])]):e._e()],1)]),n("transition",{attrs:{name:"slide-right"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.panelIsOpen,expression:"panelIsOpen"}],ref:"mainScrollable",staticClass:"nlc-main-scrollable"},[n("Panel")],1)])],1)])])},iv=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"nlc-icon",attrs:{draggable:"false"}},[e("i",{staticClass:"icon icon-cw-services_help nlc-title-icon"})])}],sv=he(tv,nv,iv,!1,null,null,null,null);const rv=sv.exports;class av{init(e,n){this.data=n,this.isConversationalWindowInit=!1,this.isLiveChatInit=!1,this.isEnableNewChat=!0,this.chatbotContext=!1,ee.config.debug=!1,ee.use(le),!(!this.hasLiveChatMessages(e)&&this.initConversationalWindow())&&this.initLiveChat(e)}initConversationalWindow(){if(this.isConversationalWindowEnabled()){if(be.dispatch("updateConfig",this.data.config),be.dispatch("updateSettings",this.data.conversationalWindowSettings),be.dispatch("updateLiveChatSettings",this.data.settings),this.isConversationalWindowInit===!1){const e=document.createElement("div");e.id="hidden-root-nespresso-conversational-window",e.style.cssText="display: none;",e.className="nlc-hidden-root";const n=document.createElement("div");n.style.cssText="style: display: none;",n.id="root-nespresso-conversational-window",e.innerHTML=n.outerHTML,this.insertHtmlElementInPage(e),new ee({el:"#"+n.id,storeConversationalWindow:be,render:i=>i(rv)}),this.isConversationalWindowInit=!0}return d.dispatch("hide"),be.dispatch("start"),!0}return!1}switchConversationalWindowToLivechatWindow(){be.dispatch("switchToLivechatWindow")}isConversationalWindowEnabled(){return this.data.conversationalWindowSettings&&this.data.conversationalWindowSettings.enabled&&this.data.conversationalWindowSettings.enabled===!0}initLiveChat(e){if(this.hasLiveChatMessages(e)?(e.workflow===We&&(e.workflow=Ee,e.display=Ve),d.replaceState(e),this.updateData(),d.dispatch("restoreChat")):(this.updateData(),d.dispatch("updateProfileFromDatalayer")),this.isLiveChatInit===!1){const n=document.createElement("div");n.id="hidden-root-nespresso-livechat",n.style.cssText="display: none;",n.className="nlc-hidden-root";const i=document.createElement("div");i.id="root-nespresso-livechat",n.innerHTML=i.outerHTML,this.insertHtmlElementInPage(n),new ee({el:"#"+i.id,store:d,render:s=>s(Gm)}),this.isLiveChatInit=!0}be.dispatch("hide"),this.data.settings.chatbot_enabled?this.setChatbotContext(ie.CHATBOT_ONLY):this.setChatbotContext(ie.NO_CHATBOT)}hasLiveChatMessages(e){return e&&e.messages&&e.messages.length>0}insertHtmlElementInPage(e){document.body.insertBefore(e,document.body.childNodes[0])}startQueue(e){e&&d.dispatch("updateRequestData",e),d.dispatch("openChat")}hide(){d.dispatch("hide")}show(){d.dispatch("show")}disable(){d.dispatch("disable")}restoreDefaultState(e=null,n={},i=!1){d.replaceState(yo.get(),n),this.updateData(),d.dispatch("updateProfileFromDatalayer"),e===!0||e===null&&!this.data.settings.enabled_reactive?this.hide():e===!1&&this.show(),i||this.initConversationalWindow()}getIsEnableNewChat(){return this.isEnableNewChat}setIsEnableNewChat(e){this.isEnableNewChat=e}getIsEnableConversationalWindow(){return this.isEnableConversationalWindow}setIsEnableConversationalWindow(e){this.isEnableConversationalWindow=e}getChatbotContext(){return this.chatbotContext}setChatbotContext(e){this.chatbotContext=e,d.dispatch("updateChatbotContext",e)}updateData(){d.dispatch("updateList",this.data.list),d.dispatch("updateOrderedList",this.data.orderedList),d.dispatch("updateConfig",this.data.config),d.dispatch("updateSettings",this.data.settings)}isChatNotStarted(){switch(d.state.workflow){case We:case Ee:case Hi:return!0;default:return!1}}isChatDisabled(){return d.state.workflow===We}canProcessGuiDisplayChange(){return!this.isChatInProgress()&&d.state.workflow!==La}isChatInProgress(){switch(d.state.workflow){case _e:case on:case $e:case yt:return!0;default:return!1}}isChatInQueue(){return d.state.workflow===Le}verifyResumeAsyncChat(e){if(!this.data.settings.async_chat_enabled){e(!1,!1);return}const n={asyncChatContinueUrlToken:null,asyncChatContinueCookieToken:null,profile:null,isLoggedIn:te.isLoggedIn},i=this.data.settings.async_chat_continue,s=d.state.asyncTokenAllreadyTested,r=new URLSearchParams(window.location.search);if(n.asyncChatContinueUrlToken=r.get("livechat_resume"),n.asyncChatContinueUrlToken!==null){r.delete("livechat_resume");let a=r.toString();a!==""&&(a="?"+a);const o=window.location.origin+window.location.pathname+a;window.history.replaceState(null,null,o)}typeof s.url[n.asyncChatContinueUrlToken]!="undefined"&&(n.asyncChatContinueUrlToken=null),i[Qn.COOKIE]&&!d.state.asyncChatSessionClosed&&(n.asyncChatContinueCookieToken=Be.get("vchat_async_continue"),typeof s.cookie[n.asyncChatContinueCookieToken]!="undefined"&&(n.asyncChatContinueCookieToken=null)),i[Qn.LOGIN]&&!d.state.asyncChatSessionClosed&&(te.isLoggedIn?(n.profile={email:te.email,firstName:te.firstName,lastName:te.lastName,nessClubId:te.nessClubId,nessClubLevel:te.nessClubLevel},typeof s.profile[JSON.stringify(n.profile)]!="undefined"&&(n.profile=null)):!te.isLoggedIn&&Object.entries(s.profile).length>0&&(s.profile={},d.commit(Bi,s))),n.profile||n.asyncChatContinueUrlToken||n.asyncChatContinueCookieToken?G.verifyResumeAsyncChat(n,a=>{a.asyncValidatedStartToken?d.commit(Xn,a.asyncValidatedStartToken):(d.commit(Xn,null),n.asyncChatContinueUrlToken&&(s.url[n.asyncChatContinueUrlToken]=!0),n.profile&&(s.profile[JSON.stringify(n.profile)]=!0),n.asyncChatContinueCookieToken&&(s.cookie[n.asyncChatContinueCookieToken]=!0,Be.remove(Lt)),d.commit(Bi,s)),e(Boolean(a.asyncValidatedStartToken),Boolean(n.asyncChatContinueUrlToken))},()=>{e(!1,Boolean(n.asyncChatContinueUrlToken))}):e(!1,!1)}checkAsyncChatEnabledForCustomer(){const e=this.isAsyncChatEnabledForCustomer();return d.commit(ho,e),e}isAsyncChatEnabledForCustomer(){if(!this.data.settings.async_chat_enabled||d.state.chatbotContext===ie.CHATBOT_ONLY)return!1;let e;return te.isLoggedIn===!0?te.nessClubLevel&&this.data.settings.async_chat_start[te.nessClubLevel]?e=this.data.settings.async_chat_start[te.nessClubLevel]:e=this.data.settings.async_chat_start[kr.AUTHENTICATED]:e=this.data.settings.async_chat_start[kr.ANONYMOUS],e===_i.ALWAYS||e===_i.CHAT_OPEN&&this.data.settings.is_chat_open?!0:(e===_i.NEVER,!1)}removeURLParameter(e,n){const i=e.split("?");if(i.length>=2){const s=encodeURIComponent(n)+"=",r=i[1].split(/[&;]/g);for(let a=r.length;a-- >0;)r[a].lastIndexOf(s,0)!==-1&&r.splice(a,1);return i[0]+(r.length>0?"?"+r.join("&"):"")}return e}displayDisabledMessage(e){d.dispatch("displayDisabledMessage",e)}}const Or="ask-chat-started",Ir="ask-started-chat-to-take-focus",Mr="chat-is-started";class ov{constructor(e=window){this._win=e,this.tabComChannel=null,this.isChatStartedOtherTab=!1;try{this.tabComChannel=new e.BroadcastChannel("livechat_tab_exchange"),this.tabComChannel.onmessage=n=>{this.onMessage(n)}}catch(n){}}onMessage(e){const n=e.data;n.action===Or?this.isChatInProgress()&&this.sendMessage(Mr):n.action===Mr?this.isChatStartedOtherTab=!0:n.action===Ir&&this.isChatInProgress()&&d.dispatch("")}sendMessage(e,n={}){this.tabComChannel&&(n.action=e,this.tabComChannel.postMessage(n))}checkChatInProgressOtherTab(e){this.isChatStartedOtherTab=!1,this.sendMessage(Or),this._win.setTimeout(()=>{e(this.isChatStartedOtherTab)},50)}askSwitchFocusOnActiveChat(){this.sendMessage(Ir)}isChatInProgress(){return d.state.workflow===Le||d.state.workflow===_e}}class lv{constructor(e,n,i){this.config=e,this.window=n,this.document=i}init(){if(typeof CalleoScreenMirroring=="undefined"){const e=`${this.config.frontBaseUrl}/apps.php?t=${this.config.config.appRev}&a=screen-mirroring`;j.loadJs(e,this.document.head,{type:"module"}),j.loadJs(`${e}-nomodule`,this.document.head,{nomodule:"",defer:!0})}d.commit("ScreenMirroring/receiveInvitation")}load(){this.client=new CalleoScreenMirroring(this.config.frontBaseUrl,d.state.secretToken,{sendMessage:(e,n)=>{n&&(n=this.window.btoa(unescape(encodeURIComponent(JSON.stringify(n))))),this.sendXMPPMessage(e,n)},setMessageCallback:e=>{this.messageCallback=function(n){e(n)}}},{sensibleDataHideSelectors:[...this.config.apiSettings.sensible_data_hide_selector]})}start(){this.client.start({dcOpen:()=>{d.commit("ScreenMirroring/mirroringInProgress")},dcClose:()=>{d.commit("ScreenMirroring/mirroringStopped")}})}stop(){typeof this.client!="undefined"&&this.client.stop()}signalingMessage(e){e.payload&&(e.payload=JSON.parse(decodeURIComponent(escape(this.window.atob(e.payload))))),this.messageCallback(e)}sendXMPPMessage(e,n){Z.sendMessage(JSON.stringify({type:e,payload:n}))}}const Z=new vg,le=new wg,te=new yg(le,window),cn=new bg(te),G=new Sg,Se=new av,Ft=new Cg(K,le,window),Rr=new ov(window),Xe=new lv(K,window,document);class cv{constructor(e,n,i,s=window){this._config=e,this._chatManager=Se,this._webLoadder=null,this._storage=n,this._dispatcher=i,this._window=s,this._launched=!1,this._started=!1,this._pageUnloaded=!1,this._timeoutSaveStorage=null,this._rulesLoaded=!1,this._isOpen=!0,this._queueActionAfterLoad=[],this._config.url.bosh||this._dispatcher.emit("config.no-url"),this._processApiLoader()}start(e,n){if(this._started)return n();this._started=!0,this._loadRules(e,n)}saveStorage(){!this._storage||this._storage.sleep()}saveStorageDelayed(){this._timeoutSaveStorage&&(this._window.clearTimeout(this._timeoutSaveStorage),this._timeoutSaveStorage=null),this._pageUnloaded?this.saveStorage():this._timeoutSaveStorage=this._window.setTimeout(()=>this.saveStorage(),100)}_unload(){this._started=!1,this._pageUnloaded=!0,Z.beforePageUnload(),this.saveStorage()}hasLivechatStorage(){return this._window.sessionStorage.getItem(`${this._config.storagePrefix}_gui`)}_processApiLoader(){if(this._window._calleoChat){const e=this._window._calleoChat;e.app=this,e.market=String(e.market).toLowerCase(),e.language=String(e.language).toLowerCase(),e.channel=String(e.channel).toLowerCase(),e.country=String(e.country).toLowerCase(),e.queue.unshift([`${this._config.defaultStorage}.market`,e.market]),e.queue.unshift([`${this._config.defaultStorage}.language`,e.language]),e.queue.unshift([`${this._config.defaultStorage}.channel`,e.channel]),e.queue.unshift([`${this._config.defaultStorage}.country`,e.country]),G.setContextParams(e.market,e.language,e.channel,e.country),te.init(e.market,e.language,e.channel),this._webLoadder=e,this.launchChat()}else this._window.setTimeout(()=>this._processApiLoader(),200)}_loadRules(e,n){Z.initializeDependencies(this._config,this._dispatcher),this._dispatcher.on("livechat.bann-user",()=>{Be.set("vchat_bid","43686146957",{expires:365}),this._chatManager.setIsEnableNewChat(!1),this._chatManager.hide(),this._isOpen=!1,this._isConversationalWindowEnabled=!1}),G.retrieveRules(i=>{this._config.apiSettings=i.settings,this._config.apiConversationalWindowSettings=i.conversationalWindowSettings,i.conversationalWindowSettings&&(i.conversationalWindowSettings.excludedUrls&&this.isExcludedUrl(window.location.href,i.conversationalWindowSettings.excludedUrls)&&(i.conversationalWindowSettings.enabled=!1),this._config.conversationalWindowSettings=i.conversationalWindowSettings),this._config.config=i.config,this._storage.wakeUp(),this._processApiBinding(),this._window.addEventListener("beforeunload",()=>this._unload()),this._window.addEventListener("unload",()=>this._unload()),this._dispatcher.on("store.message-received",()=>this.saveStorageDelayed()),this._dispatcher.on("store.message-sent",()=>this.saveStorageDelayed()),cn.setRules(i.priorityWeight),le.pushTranslations(i.translations),le.pushList(i.list),te.load();const s=100-Math.round(Math.random()*100),r=this._storage.getStorage("chatRequest").getValue("customerPercent")||s;this._storage.getStorage("chatRequest").callValue("customerPercent",r);const a=100-Math.round(Math.random()*100),o=this._storage.getStorage("chatRequest").getValue("chatbotPercent")||a;this._storage.getStorage("chatRequest").callValue("chatbotPercent",o),this._config.apiSettings.chatbot_enabled===!0&&o>this._config.apiSettings.chatbot_percent_language?(this._dispatcher.emit("settings.chatbot-customer-percent",o,this._config.apiSettings.chatbot_percent_language),this._config.excludedFromChatbot=!0):this._config.apiSettings.chatbot_enabled===!1&&r>this._config.apiSettings.customer_percent&&(this._dispatcher.emit("settings.customer-percent",r,this._config.apiSettings.customer_percent),this._config.excludedFromLiveChat=!0),this._config.apiSettings.exclude_url&&this.isExcludedUrl(window.location.href,this._config.apiSettings.exclude_url)&&(this._config.excludedFromEmbed=!0),this._chatManager.init(this._storage.getStorage("gui").getData(),i),this._config.apiSettings.enabled?this._setupGuiStatusBySettings():(this._dispatcher.emit("settings.not-activated"),this._chatManager.disable(),this._chatManager.hide(),this._isOpen=!1,this._chatManager.setIsEnableNewChat(this._isOpen)),this._rulesLoaded=!0,this._registerPostMessageHandler(),this._processQueueActionAfterLoad(),e()},i=>n(i))}_setupGuiStatusBySettings(){let e=!0;const n=this._chatManager.checkAsyncChatEnabledForCustomer();let i=!0;n&&this._dispatcher.emit("settings.async-enabled-for-customer"),this._config.apiSettings.chatbot_enabled&&this._dispatcher.emit("settings.chatbot-enabled"),!n&&!this._config.apiSettings.is_chat_open&&!this._config.apiSettings.chatbot_enabled&&(this._dispatcher.emit("settings.not-enabled"),e=!1),this._config.app_version[0]!=="_"&&this._config.app_version!==this._config.apiSettings.app_version&&(this._dispatcher.emit("livechat.version.error",this._config.app_version,this._config.apiSettings.app_version),this._chatManager.isChatInQueue()||(e=!1),this._isOpen=!1),Be.get("vchat_bid")&&(this._dispatcher.emit("livechat.banned-user"),e=!1),!this._config.apiSettings.moderator_in_room&&!this._config.apiSettings.chatbot_enabled&&!n&&(this._dispatcher.emit("settings.absent-moderator-in-room"),this._chatManager.isChatInQueue()||(e=!1),this._isOpen=!1),this._isOpen=this._isOpen&&(e||n),!e&&!n&&!this._chatManager.isChatInProgress()?(this._chatManager.disable(),i=!1):this._config.apiSettings.enabled_reactive||(this._dispatcher.emit("settings.reactive-not-enabled"),i=!1),this._chatManager.setIsEnableNewChat(this._isOpen),this._config.apiConversationalWindowSettings.enabled===!0&&(this._isConversationalWindowEnabled=!0),this._chatManager.setIsEnableConversationalWindow(this._isConversationalWindowEnabled),(this._config.excludedFromChatbot||this._config.excludedFromLiveChat||this._config.excludedFromEmbed)&&(i=!1),this._chatManager.canProcessGuiDisplayChange()?this._chatManager.verifyResumeAsyncChat((s,r)=>{Rr.checkChatInProgressOtherTab(a=>{i&&!a?this._chatManager.show():this._chatManager.hide(),s?a?r?this._chatManager.displayDisabledMessage(bt.OPEN_IN_OTHER_TAB):this._chatManager.hide():(this._chatManager.startQueue(),Se.isConversationalWindowInit&&Se.switchConversationalWindowToLivechatWindow()):r&&(this._chatManager.displayDisabledMessage(bt.BAD_TOKEN),Se.isConversationalWindowInit&&Se.switchConversationalWindowToLivechatWindow())})}):this._chatManager.isChatInProgress()&&new URLSearchParams(window.location.search).get("livechat_resume")&&window.alert("Could not resume chat, another chat is already in progress.")}_processApiBinding(){this._webLoadder&&(this._webLoadder.callMethod=(...e)=>this.apiCallMethod(...e),this._webLoadder.queue.forEach(e=>this.apiCallMethod(...e)),this._webLoadder.queue=[])}_registerPostMessageHandler(){this._window.addEventListener("message",e=>{if(!fe.matchOneHostPatern(e.origin,this._config.apiSettings.allowedHostPatterns))return;const n=String(e.data);if(n.substr(0,13)==="calleoChat:::"){const i=n.split(":::");let s={};switch(i[1]){case"startChat":case"startChatWithAck":if(i.length>2&&(s=fe.parseQuery(i[2])),this.startChat(s),i[1]==="startChatWithAck"){const r=this._isOpen&&!this._chatManager.isChatDisabled();e.source.postMessage({"calleoChat:::chatStarted":r},e.origin)}break;case"isChatOpen":e.source.postMessage({"calleoChat:::isChatOpen":this._isOpen},e.origin);break;case"isChatNotStarted":case"isChatDisabled":case"isChatInProgress":case"isChatInQueue":{const r={};r[`calleoChat:::${i[1]}`]=this._chatManager[i[1]](),e.source.postMessage(r,e.origin);break}}}},!1)}apiCallMethod(e,...n){e=String(e),e&&(typeof this[e]=="function"?this[e](...n):this._storage&&this._storage.hasStorage()&&this._storage.callValue(e,...n))}addChatListener(e,n){this._dispatcher.on(e,n)}launchChat(){this._launched!==!0&&(this._launched=!0,new Promise((e,n)=>{this.start(e,n)}).then(()=>{this._dispatcher.emit("livechat.loading-finished"),typeof this._config.apiSettings.debug_quota_information!="undefined"&&this._config.apiSettings.debug_quota_information.enabled&&(this._dispatcher.emit("livechat.quota.enabled"),this._dispatcher.emit("livechat.quota.slots",this._config.apiSettings.debug_quota_information.number_of_slots),this._dispatcher.emit("livechat.quota.setting",this._config.apiSettings.debug_quota_information.setting),this._dispatcher.emit("livechat.quota.load",this._config.apiSettings.debug_quota_information.load_percent),this._dispatcher.emit("livechat.quota.reached",this._config.apiSettings.debug_quota_information.is_reached))}).catch(e=>{this._dispatcher.emit(e)}))}startChat(e){if(this._rulesLoaded){if(!this._config.apiSettings.enabled)return}else{this._queueActionAfterLoad.push(["startChat",e]);return}Se.initLiveChat(),Rr.checkChatInProgressOtherTab(n=>{n?this._chatManager.displayDisabledMessage(bt.OPEN_IN_OTHER_TAB):(e=e&&typeof e=="object"?e:{},e.source=e.source||(e.liveTriggerId?"chat_lt":"chat"),this._chatManager.startQueue(e))})}isChatOpen(e){if(this._rulesLoaded){const n=new Date().getDay();let i=null;n in this._config.apiSettings.opening_hours&&(i=this._config.apiSettings.opening_hours[n]),e(this._isOpen,i,this._config.apiSettings.opening_hours)}else this._queueActionAfterLoad.push(["isChatOpen",e])}_processQueueActionAfterLoad(){this._queueActionAfterLoad.forEach(e=>this.apiCallMethod(...e)),this._queueActionAfterLoad=[]}resetChat(){this._storage.cleanUpStorage(),this._storage.stopStorage(),Be.remove("vchat_bid"),this._window.location.reload()}finishChatTestMode(){this._chatManager.disable()}isExcludedUrl(e,n){const i=rt.parseURIBase(e);return n.some(s=>{const r=rt.parseURIBase(s),a=(r.host===""||i.host===r.host)&&(r.path===""||i.path===r.path)&&(r.query===""||i.query!==""&&i.query.indexOf(r.query)!==-1)&&(r.fragment===""||i.fragment===r.fragment);return a&&this._dispatcher.emit("settings.exclude-url",s,n),a})}}var Ts={exports:{}},$t=typeof Reflect=="object"?Reflect:null,Nr=$t&&typeof $t.apply=="function"?$t.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},Rn;$t&&typeof $t.ownKeys=="function"?Rn=$t.ownKeys:Object.getOwnPropertySymbols?Rn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Rn=function(e){return Object.getOwnPropertyNames(e)};function uv(t){console&&console.warn&&console.warn(t)}var Mo=Number.isNaN||function(e){return e!==e};function ne(){ne.init.call(this)}Ts.exports=ne;Ts.exports.once=pv;ne.EventEmitter=ne;ne.prototype._events=void 0;ne.prototype._eventsCount=0;ne.prototype._maxListeners=void 0;var Lr=10;function ri(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ne,"defaultMaxListeners",{enumerable:!0,get:function(){return Lr},set:function(t){if(typeof t!="number"||t<0||Mo(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Lr=t}});ne.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ne.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Mo(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Ro(t){return t._maxListeners===void 0?ne.defaultMaxListeners:t._maxListeners}ne.prototype.getMaxListeners=function(){return Ro(this)};ne.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var s=e==="error",r=this._events;if(r!==void 0)s=s&&r.error===void 0;else if(!s)return!1;if(s){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=r[e];if(c===void 0)return!1;if(typeof c=="function")Nr(c,this,n);else for(var f=c.length,g=Fo(c,f),i=0;i<f;++i)Nr(g[i],this,n);return!0};function No(t,e,n,i){var s,r,a;if(ri(n),r=t._events,r===void 0?(r=t._events=Object.create(null),t._eventsCount=0):(r.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),a=r[e]),a===void 0)a=r[e]=n,++t._eventsCount;else if(typeof a=="function"?a=r[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),s=Ro(t),s>0&&a.length>s&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,uv(o)}return t}ne.prototype.addListener=function(e,n){return No(this,e,n,!1)};ne.prototype.on=ne.prototype.addListener;ne.prototype.prependListener=function(e,n){return No(this,e,n,!0)};function dv(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lo(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=dv.bind(i);return s.listener=n,i.wrapFn=s,s}ne.prototype.once=function(e,n){return ri(n),this.on(e,Lo(this,e,n)),this};ne.prototype.prependOnceListener=function(e,n){return ri(n),this.prependListener(e,Lo(this,e,n)),this};ne.prototype.removeListener=function(e,n){var i,s,r,a,o;if(ri(n),s=this._events,s===void 0)return this;if(i=s[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(r=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){o=i[a].listener,r=a;break}if(r<0)return this;r===0?i.shift():hv(i,r),i.length===1&&(s[e]=i[0]),s.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};ne.prototype.off=ne.prototype.removeListener;ne.prototype.removeAllListeners=function(e){var n,i,s;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var r=Object.keys(i),a;for(s=0;s<r.length;++s)a=r[s],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function Po(t,e,n){var i=t._events;if(i===void 0)return[];var s=i[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?fv(s):Fo(s,s.length)}ne.prototype.listeners=function(e){return Po(this,e,!0)};ne.prototype.rawListeners=function(e){return Po(this,e,!1)};ne.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):$o.call(t,e)};ne.prototype.listenerCount=$o;function $o(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}ne.prototype.eventNames=function(){return this._eventsCount>0?Rn(this._events):[]};function Fo(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function hv(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function fv(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function pv(t,e){return new Promise(function(n,i){function s(a){t.removeListener(e,r),i(a)}function r(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}Do(t,e,r,{once:!0}),e!=="error"&&gv(t,s,{once:!0})})}function gv(t,e,n){typeof t.on=="function"&&Do(t,"error",e,n)}function Do(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(r){i.once&&t.removeEventListener(e,s),n(r)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class mv{isOpen(e,n=new Date,i=0){let s=n.getMinutes();s<10&&(s=`0${s}`);const r=n.getTimezoneOffset()/60,a=i+r;n.setHours(n.getHours()+a);let o=n.getDay();o===0&&(o=7);const c=parseInt(`${n.getHours()}${s}`,10);if(o in e){let f=e[o],g;Array.isArray(f)||(f=[f]);for(let E=0;E<f.length;E++){g=f[E];const A=parseInt(g.from.replace(":",""),10),N=parseInt(g.to.replace(":",""),10);if(c>=A&&c<=N)return!0}}return!1}getNextOpenHour(e,n,i=new Date,s=0){const r=i.getTimezoneOffset()/60,a=s+r;i.setHours(i.getHours()+a);let o=i.getDay();return o===0&&(o=7),this.getNextDayOpenHour(e,n,i,o,o)}getNextDay(e){let n=e+1;return n>7&&(n=1),n}getNextDayOpenHour(e,n,i,s,r){const a=this.getNextDay(s);if(i.setHours(i.getHours()+24),a===r)return!1;if(a in e){let o=e[a],c;Array.isArray(o)||(o=[o]);for(let f=0;f<o.length;f++){c=o[f];let g="";return a in n&&(g+=n[a]),g+=" "+c.from,g}}else return this.getNextDayOpenHour(e,s,r)}}class _v{constructor(e,n){this.managers=null,this.config=e,this.openingHours=n,this.defaultManager=e.defaultStorage,this.storagePrefix=e.storagePrefix,this.settings={},this._stopStorage=!1}setStorage(e){this.managers=e}getStorage(e){return typeof this.managers[e]!="undefined"?this.managers[e]:null}hasStorage(){return this.managers!==null}callValue(e,...n){e=String(e);let i=e;e.indexOf(".")!==-1&&([i,e]=e.split(".",2)),typeof this.managers[i]=="undefined"&&(i=this.defaultManager),this.managers[i].callValue(e,...n)}sleep(){if(this._stopStorage)return;const e=this._getStorage();let n=null;if(this.storagePrefix&&e)for(const i in this.managers)Object.prototype.hasOwnProperty.call(this.managers,i)&&(n=this.managers[i].sleep(),n=e.setItem(`${this.storagePrefix}_${i}`,JSON.stringify(n)))}wakeUp(){const e=this._getStorage();let n=null;for(const i in this.managers)if(Object.prototype.hasOwnProperty.call(this.managers,i)){if(n=e.getItem(`${this.storagePrefix}_${i}`),n)try{n=JSON.parse(n)}catch(s){console.error(`Error on process data storage ${i} from json ${n}`)}else n={};this.managers[i].wakeUp(n)}}cleanUpStorage(e=null){const n=this._getStorage();e&&(this.storagePrefix=e),e=this.storagePrefix,Object.keys(n).forEach(i=>{String(i).startsWith(e)&&n.removeItem(i)})}stopStorage(){this._stopStorage=!0}_getStorage(){return window.sessionStorage}canStore(){if(this.config){const e=this.config.apiSettings.opening_hours,n=this.config.apiSettings.timezone;return this.openingHours.isOpen(e,new Date,n)}return!0}}class vv{constructor(e=window,n,i,s){this._id="livechat-test-mode",this._key="livechat_test_mode",this._storageManager=n,this._isEnabled=this._retrieveTestModeState(e),this._dispatcher=i,this._datalayer=s,this._win=e,this.isEnabled&&(this._buildInfoBlock(e),this._initListeners())}_initListeners(){const e=this._dispatcher;e.on("livechat.loading",()=>{this._api("Loading livechat...")}),e.on("livechat.loading-finished",()=>{this._log("Loading finished with success")}),e.on("config.no-url",()=>{this._error("Config file isn't correct, check your local.json and local.json.dist")}),e.on("livechat.already-in-use",()=>{this._warn("Livechat is already started")}),e.on("livechat.loading.error",n=>{this._error(`API Error: ${this._formatXhrError(n)}`)}),e.on("livechat.version.error",(n,i)=>{this._error(`Obsolete browser cache ${n}/${i}. Please clear browser cache.`)}),e.on("livechat.send-action",(n,i)=>{this._api(`Sending '${i}/${n}' to server`)}),e.on("livechat.send-action.error",n=>{this._error(`API Error: ${this._formatXhrError(n)}`)}),e.on("settings.not-activated",()=>{this._warn("The current market/language isn't activated")}),e.on("settings.not-enabled",()=>{this._warn("The current market's Livechat isn't enabled")}),e.on("settings.chatbot-enabled",()=>{this._warn("Chatbot is enabled")}),e.on("settings.async-enabled-for-customer",()=>{this._log("Asynchronous is enabled for current customer")}),e.on("livechat.banned-user",()=>{this._warn("The current customer id banned")}),e.on("settings.absent-moderator-in-room",()=>{this._warn("No operator in the room chat room, disable the chat")}),e.on("settings.reactive-not-enabled",()=>{this._warn("The current market's Livechat Reactive isn't enabled")}),e.on("settings.language-not-enabled",()=>{this._warn("The current market's Livechat language isn't enabled")}),e.on("settings.not-enabled-livechat-started",()=>{this._warn("The current market's Livechat Reactive isn't enabled, but a livechat is already started")}),e.on("settings.customer-percent",(n,i)=>{this._warn(`Customer excluded for embedded chat: Target customers threshold ${i}% - Calculated value for customer ${n}%`)}),e.on("settings.chatbot-customer-percent",(n,i)=>{this._warn(`Customer excluded for chatbot chat: Target customers threshold ${i}% - Calculated value for customer ${n}%`)}),e.on("settings.exclude-url",(n,i)=>{this._warn(`The customer is on exclude page, url: ${n}`),this._warn(" urls set:"),i.forEach(s=>this._warn(`${s}`))}),e.on("opening-hours.is-closed",()=>{this._warn("The current market's Livechat is closed.")}),e.on("reset.storage",()=>{this._warn("The storage has been cleared!")}),e.on("xmpp.fail-connection",()=>{this._error("XMPP BOSH connection fail")}),e.on("xmpp.disconnected",()=>{this._log("XMPP BOSH is now disconnected")}),e.on("xmpp.connected",(n,i)=>{this._log(`XMPP BOSH connected with new connection (jid:${i})`)}),e.on("xmpp.attached",(n,i)=>{this._log(`XMPP BOSH connection attached to (jid:${i})`),this._log("XMPP BOSH connected")}),e.on("xmpp.error",()=>{this._error("XMPP BOSH Error")}),e.on("livechat.bann-user",()=>{this._warn("User banned by operator")}),e.on("xmpp.authfail",()=>{this._error("XMPP Auth Fail Error")}),e.on("chatbot.ready",()=>{this._log("Chatbot ready")}),e.on("chatbot.connected",(n,i,s)=>{this._log(`Chatbot ${i} connected (rid:${s})`)}),e.on("chatbot.response-action",n=>{this._api(`Chatbot responding '${n}' action`)}),e.on(`xmpp.message.${ge.UNDEFINED}`,(n,i,s,r,a,o,c)=>{const f=function(g){switch(typeof g){case"object":return JSON.stringify(g);case"string":return`"${g}"`;default:return g}};this._error(`Undefined 'xmpp.message' event:<br>from=${f(i)}<br>to=${f(s)}<br>msg=${f(r)}<br>type=${f(a)}<br>payload=${f(o)}<br>subjectText=${f(c)}`)}),e.on("livechat.quota.enabled",()=>{this._api("Livechat quota is ENABLED")}),e.on("livechat.quota.slots",n=>{this._api(`Livechat quota total slots '${n}'`)}),e.on("livechat.quota.setting",n=>{this._api(`Livechat quota setting '${n}%'`)}),e.on("livechat.quota.load",n=>{this._api(`Livechat quota load '${n}%'`)}),e.on("livechat.quota.reached",n=>{this._api(`Livechat quota reached '${n?"YES":"NO"}'`)})}get isEnabled(){return this._isEnabled}_retrieveTestModeState(e){const n=e.sessionStorage;if(!n)return!1;const i=String(e.location.search);return i.indexOf(`${this._key}=`)!==-1&&(i.indexOf(`${this._key}=no`)!==-1?(n.setItem(this._key,"0"),n.setItem(`${this._key}_mini`,"0")):i.indexOf(`${this._key}=yes`)!==-1&&n.setItem(this._key,"1")),n.getItem(this._key)==="1"}_buildInfoBlock(e){let n;typeof e.calleoTrigger=="function"&&(n=' style="bottom: 165px;"');const i=`<div id="${this._id}" class="${this._id}"${n}>
                            <div class="${this._id}-minimal" title="Expand" id="${this._id}-minimal">LiveChat Test Mode &gt;</div>
                            <div class="${this._id}-head">
                                <div class="${this._id}-title">
                                    LIVECHAT IN TEST MODE <spans id="${this._id}-queue-size"></spans>
                                </div>
                                <div class="${this._id}-actions">
                                    <button id="${this._id}-reduce" class="${this._id}-action-btn" title="Reduce"> &lt; </button> &nbsp;
                                    <button id="${this._id}-start-chat" class="${this._id}-action-btn">Start Chat</button> &nbsp;
                                    <button id="${this._id}-finish-chat" class="${this._id}-action-btn">Finish Chat</button> &nbsp;
                                    <button id="${this._id}-reset" class="${this._id}-action-btn">Reset LiveChat</button> &nbsp;
                                    <button id="${this._id}-datalayer" class="${this._id}-action-btn">Show Datalayer</button> &nbsp;
                                    <button id="${this._id}-resume-cookie" class="${this._id}-action-btn">Continue Cookie</button> &nbsp;
                                    <div id="${this._id}-deactivate" class="${this._id}-action ${this._id}-action-close" title="Leave test mode"> X </div>
                                </div>
                            </div>
                            <div class="${this._id}-body">
                                <div id="${this._id}-log" class="log">
                                </div>
                            </div>
                        </div>`,s=j.create(i);e.document.body.appendChild(s),e.document.getElementById(`${this._id}-deactivate`).addEventListener("click",()=>{e.sessionStorage.setItem(this._key,"0"),e.location.replace(e.location.pathname)},!1),e.document.getElementById(`${this._id}-reset`).addEventListener("click",()=>{e.calleoChat("resetChat"),this._dispatcher.emit("reset.storage"),Be.remove(Lt)},!1),e.document.getElementById(`${this._id}-start-chat`).addEventListener("click",()=>{e.calleoChat("startChat")},!1),e.document.getElementById(`${this._id}-finish-chat`).addEventListener("click",()=>{e.calleoChat("finishChatTestMode")},!1),e.document.getElementById(`${this._id}-resume-cookie`).addEventListener("click",()=>{const r=window.prompt("Set Resume Cookie (vchat_async_continue), then reload page to apply",Be.get(Lt));r!==null&&(r?Be.set(Lt,r,{expires:vo}):Be.remove(Lt))},!1),e.document.getElementById(`${this._id}-datalayer`).addEventListener("click",()=>{this._log(this._datalayer.prettyRenderHtml())},!1),e.document.getElementById(`${this._id}-reduce`).addEventListener("click",()=>{this._minimized(!0)},!1),e.document.getElementById(`${this._id}-minimal`).addEventListener("click",()=>{this._minimized(!1)},!1),this._minimized(parseInt(e.sessionStorage.getItem(`${this._key}_mini`),10))}_minimized(e=!1){const n=this._win.document.getElementById(`${this._id}`),i=this._win.sessionStorage;e?j.addClass(n,"minized"):j.removeClass(n,"minized"),i&&i.setItem(`${this._key}_mini`,e?"1":"0")}_log(e,n="info"){const i=document.getElementById(`${this._id}-log`),s=document.createElement("div");s.className=`item ${n}`,s.innerHTML=e,i.appendChild(s),i.scrollTop=i.scrollHeight}_success(e){this._log(e,"success")}_error(e){this._log(e,"error")}_warn(e){this._log(e,"warn")}_api(e){this._log(e,"api")}_formatXhrError(e){let n=`${e.status} ${e.statusText}`;try{const i=JSON.parse(e.response);n+=`: ${i.error_description}`}catch(i){}return n}}class Ho{constructor(){this.data={}}sleep(){return this.data}wakeUp(e){this.data=e}callValue(e,...n){this.data[e]=n[0]}getValue(e){return typeof this.data[e]!="undefined"?this.data[e]:null}getData(){return this.data}setData(e){this.data=e}}class yv extends Ho{constructor(e){super(),this.config=e}callValue(e,...n){return n=this._transformValues(e,n),super.callValue(e,...n)}wakeUp(e){this.data=Object.assign(this.data,e)}_transformValues(e,n){return e==="Title"&&(n[0]=String(n[0]).replace(".","").toLowerCase()),n}}class bv extends Ho{constructor(e){super(),this.config=e}sleep(){return this.data=d.state,super.sleep()}}const Es=new Ts.exports;G.init(K,Es);G.loadCss();const Cv=new mv,As=new _v(K,Cv),wv=new yv(K),Sv=new bv;As.setStorage({chatRequest:wv,gui:Sv});const Tv=new vv(window,As,Es,te);G.setTestMode(Tv.isEnabled);new cv(K,As,Es,window);
//# 
})();